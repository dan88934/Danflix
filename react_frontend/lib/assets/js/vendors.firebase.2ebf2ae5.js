(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return T})),n.d(t,"c",(function(){return _})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return k})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return P})),n.d(t,"h",(function(){return N})),n.d(t,"i",(function(){return c})),n.d(t,"j",(function(){return R})),n.d(t,"k",(function(){return M})),n.d(t,"l",(function(){return l})),n.d(t,"m",(function(){return p})),n.d(t,"n",(function(){return m})),n.d(t,"o",(function(){return y})),n.d(t,"p",(function(){return A})),n.d(t,"q",(function(){return v})),n.d(t,"r",(function(){return I})),n.d(t,"s",(function(){return d})),n.d(t,"t",(function(){return f})),n.d(t,"u",(function(){return g})),n.d(t,"v",(function(){return b})),n.d(t,"w",(function(){return w})),n.d(t,"x",(function(){return C})),n.d(t,"y",(function(){return D}));var r=n(23),i=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var s=e[i],o=i+1<e.length,a=o?e[i+1]:0,c=i+2<e.length,u=c?e[i+2]:0,h=s>>2,l=(3&s)<<4|a>>4,d=(15&a)<<2|u>>6,f=63&u;c||(f=64,o||(d=64)),r.push(n[h],n[l],n[d],n[f])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(i(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){var o=((7&i)<<18|(63&(s=e[n++]))<<12|(63&(a=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{s=e[n++];var a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var s=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,a=++i<e.length?n[e.charAt(i)]:64,c=++i<e.length?n[e.charAt(i)]:64;if(++i,null==s||null==o||null==a||null==c)throw Error();var u=s<<2|o>>4;if(r.push(u),64!==a){var h=o<<4&240|a>>2;if(r.push(h),64!==c){var l=a<<6&192|c;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},o=function(e){return function(e){var t=i(e);return s.encodeByteArray(t,!0)}(e).replace(/\./g,"")},a=function(e){try{return s.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function c(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=c(e[n],t[n]));return e}var u=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"===typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}},e}();function h(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object(r.a)({iss:"https://securetoken.google.com/"+n,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[o(JSON.stringify({alg:"none",type:"JWT"})),o(JSON.stringify(a)),""].join(".")}function l(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function d(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(l())}function f(){try{return"[object process]"===Object.prototype.toString.call(e.process)}catch(t){return!1}}function p(){return"object"===typeof self&&self.self===self}function m(){var e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function g(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function y(){return l().indexOf("Electron/")>=0}function v(){var e=l();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function w(){return l().indexOf("MSAppHost/")>=0}function b(){return!f()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function I(){return"indexedDB"in self&&null!=indexedDB}var _=function(e){function t(n,r,i){var s=e.call(this,r)||this;return s.code=n,s.customData=i,s.name="FirebaseError",Object.setPrototypeOf(s,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,T.prototype.create),s}return Object(r.b)(t,e),t}(Error),T=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t[0]||{},i=this.service+"/"+e,s=this.errors[e],o=s?E(s,r):"Error",a=this.serviceName+": "+o+" ("+i+").",c=new _(i,a,r);return c},e}();function E(e,t){return e.replace(S,(function(e,n){var r=t[n];return null!=r?String(r):"<"+n+"?>"}))}var S=/\{\$([^}]+)}/g;function k(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function A(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function N(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,s=n;i<s.length;i++){var o=s[i];if(!r.includes(o))return!1;var a=e[o],c=t[o];if(O(a)&&O(c)){if(!N(a,c))return!1}else if(a!==c)return!1}for(var u=0,h=r;u<h.length;u++){o=h[u];if(!n.includes(o))return!1}return!0}function O(e){return null!==e&&"object"===typeof e}function C(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach((function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))})):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,i=Object.entries(e);r<i.length;r++){var s=i[r];n(s[0],s[1])}return t.length?"&"+t.join("&"):""}function D(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=e.split("="),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}})),t}function R(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}!function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"===typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var s,o,a=this.chain_[0],c=this.chain_[1],u=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(s=h^c&(u^h),o=1518500249):(s=c^u^h,o=1859775393):r<60?(s=c&u|h&(c|u),o=2400959708):(s=c^u^h,o=3395469782);i=(a<<5|a>>>27)+s+l+o+n[r]&4294967295;l=h,h=u,u=4294967295&(c<<30|c>>>2),c=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,s=this.inbuf_;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++r,++s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++r,++s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e}}();function P(e,t){var n=new L(e,t);return n.subscribe.bind(n)}var L=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(n)})).catch((function(e){n.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!==typeof e||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"===typeof e[i])return!0}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=x),void 0===r.error&&(r.error=x),void 0===r.complete&&(r.complete=x);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),s},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function x(){}function M(e){return e&&e._delegate?e._delegate:e}}).call(this,n(20))},10:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return ur})),n.d(t,"b",(function(){return lr})),n.d(t,"c",(function(){return hr})),n.d(t,"d",(function(){return fr})),n.d(t,"e",(function(){return dr})),n.d(t,"f",(function(){return pr})),n.d(t,"g",(function(){return mr})),n.d(t,"h",(function(){return ar})),n.d(t,"i",(function(){return cr}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var s,o="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof e?e:"undefined"!==typeof self?self:{},a=a||{},c=o||self;function u(){}function h(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function l(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var d="closure_uid_"+(1e9*Math.random()>>>0),f=0;function p(e,t,n){return e.call.apply(e.bind,arguments)}function m(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function g(e,t,n){return(g=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?p:m).apply(null,arguments)}function y(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function v(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function w(){this.s=this.s,this.o=this.o}var b={};w.prototype.s=!1,w.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,d)&&e[d]||(e[d]=++f)}(this);delete b[e]}},w.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var I=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},_=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"===typeof e?e.split(""):e,s=0;s<r;s++)s in i&&t.call(n,i[s],s,e)};function T(e){return Array.prototype.concat.apply([],arguments)}function E(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function S(e){return/^[\s\xa0]*$/.test(e)}var k,A=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function N(e,t){return-1!=e.indexOf(t)}function O(e,t){return e<t?-1:e>t?1:0}e:{var C=c.navigator;if(C){var D=C.userAgent;if(D){k=D;break e}}k=""}function R(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function P(e){var t={};for(var n in e)t[n]=e[n];return t}var L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var s=0;s<L.length;s++)n=L[s],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function M(e){return M[" "](e),e}M[" "]=u;var F,U,j=N(k,"Opera"),V=N(k,"Trident")||N(k,"MSIE"),q=N(k,"Edge"),B=q||V,z=N(k,"Gecko")&&!(N(k.toLowerCase(),"webkit")&&!N(k,"Edge"))&&!(N(k,"Trident")||N(k,"MSIE"))&&!N(k,"Edge"),K=N(k.toLowerCase(),"webkit")&&!N(k,"Edge");function G(){var e=c.document;return e?e.documentMode:void 0}e:{var H="",W=(U=k,z?/rv:([^\);]+)(\)|;)/.exec(U):q?/Edge\/([\d\.]+)/.exec(U):V?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(U):K?/WebKit\/(\S+)/.exec(U):j?/(?:Version)[ \/]?(\S+)/.exec(U):void 0);if(W&&(H=W?W[1]:""),V){var $=G();if(null!=$&&$>parseFloat(H)){F=String($);break e}}F=H}var Q,J={};function Y(){return function(e){var t=J;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}((function(){for(var e=0,t=A(String(F)).split("."),n=A("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var s=t[i]||"",o=n[i]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==s[0].length&&0==o[0].length)break;e=O(0==s[1].length?0:parseInt(s[1],10),0==o[1].length?0:parseInt(o[1],10))||O(0==s[2].length,0==o[2].length)||O(s[2],o[2]),s=s[3],o=o[3]}while(0==e)}return 0<=e}))}if(c.document&&V){var X=G();Q=X||(parseInt(F,10)||void 0)}else Q=void 0;var Z=Q,ee=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{c.addEventListener("test",u,t),c.removeEventListener("test",u,t)}catch(n){}return e}();function te(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function ne(e,t){if(te.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(z){e:{try{M(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:re[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&ne.Z.h.call(this)}}te.prototype.h=function(){this.defaultPrevented=!0},v(ne,te);var re={2:"touch",3:"pen",4:"mouse"};ne.prototype.h=function(){ne.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var ie="closure_listenable_"+(1e6*Math.random()|0),se=0;function oe(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++se,this.ca=this.fa=!1}function ae(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function ce(e){this.src=e,this.g={},this.h=0}function ue(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=I(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(ae(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function he(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.ca&&s.listener==t&&s.capture==!!n&&s.ia==r)return i}return-1}ce.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=he(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new oe(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var le="closure_lm_"+(1e6*Math.random()|0),de={};function fe(e,t,n,r,i){if(r&&r.once)return function e(t,n,r,i,s){if(Array.isArray(n)){for(var o=0;o<n.length;o++)e(t,n[o],r,i,s);return null}return r=be(r),t&&t[ie]?t.O(n,r,l(i)?!!i.capture:!!i,s):pe(t,n,r,!0,i,s)}(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)fe(e,t[s],n,r,i);return null}return n=be(n),e&&e[ie]?e.N(t,n,l(r)?!!r.capture:!!r,i):pe(e,t,n,!1,r,i)}function pe(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=l(i)?!!i.capture:!!i,a=ve(e);if(a||(e[le]=a=new ce(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){var e=ye;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)ee||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(ge(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function me(e){if("number"!==typeof e&&e&&!e.ca){var t=e.src;if(t&&t[ie])ue(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(ge(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=ve(t))?(ue(n,e),0==n.h&&(n.src=null,t[le]=null)):ae(e)}}}function ge(e){return e in de?de[e]:de[e]="on"+e}function ye(e,t){if(e.ca)e=!0;else{t=new ne(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&me(e),e=n.call(r,t)}return e}function ve(e){return(e=e[le])instanceof ce?e:null}var we="__closure_events_fn_"+(1e9*Math.random()>>>0);function be(e){return"function"===typeof e?e:(e[we]||(e[we]=function(t){return e.handleEvent(t)}),e[we])}function Ie(){w.call(this),this.i=new ce(this),this.P=this,this.I=null}function _e(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"===typeof t)t=new te(t,e);else if(t instanceof te)t.target=t.target||e;else{var i=t;x(t=new te(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=Te(o,r,!0,t)&&i}if(i=Te(o=t.g=e,r,!0,t)&&i,i=Te(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=Te(o=t.g=n[s],r,!1,t)&&i}function Te(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&ue(e.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}v(Ie,w),Ie.prototype[ie]=!0,Ie.prototype.removeEventListener=function(e,t,n,r){!function e(t,n,r,i,s){if(Array.isArray(n))for(var o=0;o<n.length;o++)e(t,n[o],r,i,s);else i=l(i)?!!i.capture:!!i,r=be(r),t&&t[ie]?(t=t.i,(n=String(n).toString())in t.g&&(-1<(r=he(o=t.g[n],r,i,s))&&(ae(o[r]),Array.prototype.splice.call(o,r,1),0==o.length&&(delete t.g[n],t.h--)))):t&&(t=ve(t))&&(n=t.g[n.toString()],t=-1,n&&(t=he(n,r,i,s)),(r=-1<t?n[t]:null)&&me(r))}(this,e,t,n,r)},Ie.prototype.M=function(){if(Ie.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)ae(n[r]);delete t.g[e],t.h--}}this.I=null},Ie.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Ie.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Ee=c.JSON.stringify;function Se(){var e=Pe,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var ke,Ae=function(){function e(){this.h=this.g=null}return e.prototype.add=function(e,t){var n=Ne.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n},e}(),Ne=new(function(){function e(e,t){this.i=e,this.j=t,this.h=0,this.g=null}return e.prototype.get=function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e},e}())((function(){return new Oe}),(function(e){return e.reset()})),Oe=function(){function e(){this.next=this.g=this.h=null}return e.prototype.set=function(e,t){this.h=e,this.g=t,this.next=null},e.prototype.reset=function(){this.next=this.g=this.h=null},e}();function Ce(e){c.setTimeout((function(){throw e}),0)}function De(e,t){ke||function(){var e=c.Promise.resolve(void 0);ke=function(){e.then(Le)}}(),Re||(ke(),Re=!0),Pe.add(e,t)}var Re=!1,Pe=new Ae;function Le(){for(var e;e=Se();){try{e.h.call(e.g)}catch(n){Ce(n)}var t=Ne;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Re=!1}function xe(e,t){Ie.call(this),this.h=e||1,this.g=t||c,this.j=g(this.kb,this),this.l=Date.now()}function Me(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function Fe(e,t,n){if("function"===typeof e)n&&(e=g(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=g(e.handleEvent,e)}return 2147483647<Number(t)?-1:c.setTimeout(e,t||0)}function Ue(e){e.g=Fe((function(){e.g=null,e.i&&(e.i=!1,Ue(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}v(xe,Ie),(s=xe.prototype).da=!1,s.S=null,s.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),_e(this,"tick"),this.da&&(Me(this),this.start()))}},s.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},s.M=function(){xe.Z.M.call(this),Me(this),delete this.g};var je=function(e){function t(t,n){var r=e.call(this)||this;return r.m=t,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.l=function(e){this.h=arguments,this.g?this.i=!0:Ue(this)},t.prototype.M=function(){e.prototype.M.call(this),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},t}(w);function Ve(e){w.call(this),this.h=e,this.g={}}v(Ve,w);var qe=[];function Be(e,t,n,r){Array.isArray(n)||(n&&(qe[0]=n.toString()),n=qe);for(var i=0;i<n.length;i++){var s=fe(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function ze(e){R(e.g,(function(e,t){this.g.hasOwnProperty(t)&&me(e)}),e),e.g={}}function Ke(){this.g=!0}function Ge(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return Ee(n)}catch(a){return t}}(e,n)+(r?" "+r:"")}))}Ve.prototype.M=function(){Ve.Z.M.call(this),ze(this)},Ve.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ke.prototype.Aa=function(){this.g=!1},Ke.prototype.info=function(){};var He={},We=null;function $e(){return We=We||new Ie}function Qe(e){te.call(this,He.Ma,e)}function Je(e){var t=$e();_e(t,new Qe(t,e))}function Ye(e,t){te.call(this,He.STAT_EVENT,e),this.stat=t}function Xe(e){var t=$e();_e(t,new Ye(t,e))}function Ze(e,t){te.call(this,He.Na,e),this.size=t}function et(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return c.setTimeout((function(){e()}),t)}He.Ma="serverreachability",v(Qe,te),He.STAT_EVENT="statevent",v(Ye,te),He.Na="timingevent",v(Ze,te);var tt={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},nt={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function rt(){}function it(e){return e.h||(e.h=e.i())}function st(){}rt.prototype.h=null;var ot,at={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ct(){te.call(this,"d")}function ut(){te.call(this,"c")}function ht(){}function lt(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new Ve(this),this.P=ft,e=B?125:void 0,this.W=new xe(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new dt}function dt(){this.i=null,this.g="",this.h=!1}v(ct,te),v(ut,te),v(ht,rt),ht.prototype.g=function(){return new XMLHttpRequest},ht.prototype.i=function(){return{}},ot=new ht;var ft=45e3,pt={},mt={};function gt(e,t,n){e.K=1,e.v=jt(Pt(t)),e.s=n,e.U=!0,yt(e,null)}function yt(e,t){e.F=Date.now(),It(e),e.A=Pt(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),Xt(n.h,"t",r),e.C=0,n=e.l.H,e.h=new dt,e.g=er(e.l,n?t:null,!e.s),0<e.O&&(e.L=new je(g(e.Ia,e,e.g),e.O)),Be(e.V,e.g,"readystatechange",e.gb),t=e.H?P(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Je(1),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var h=u[0];u=u[1];var l=h.split("_");o=2<=l.length&&"type"==l[1]?o+(h+"=")+u+"&":o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.X,e.s)}function vt(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Ba)}function wt(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=bt(e,n))==mt){4==t&&(e.o=4,Xe(14),i=!1),Ge(e.j,e.m,null,"[Incomplete Response]");break}if(r==pt){e.o=4,Xe(15),Ge(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Ge(e.j,e.m,r,null),kt(e,r)}vt(e)&&r!=mt&&r!=pt&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Xe(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Hn(t),t.L=!0,Xe(11))):(Ge(e.j,e.m,n,"[Invalid Chunked Response]"),St(e),Et(e))}function bt(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?mt:(n=Number(t.substring(n,r)),isNaN(n)?pt:(r+=1)+n>t.length?mt:(t=t.substr(r,n),e.C=r+n,t))}function It(e){e.Y=Date.now()+e.P,_t(e,e.P)}function _t(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=et(g(e.eb,e),t)}function Tt(e){e.B&&(c.clearTimeout(e.B),e.B=null)}function Et(e){0==e.l.G||e.I||Qn(e.l,e)}function St(e){Tt(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,Me(e.W),ze(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function kt(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||on(n.i,e)))if(n.I=e.N,!e.J&&on(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(s){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;$n(n),Fn(n)}Gn(n),Xe(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=et(g(n.ab,n),6e3));if(1>=sn(n.i)&&n.ka){try{n.ka()}catch(s){}n.ka=void 0}}else Yn(n,11)}else if((e.J||n.g==e)&&$n(n),!S(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var s=i[t];if(n.U=s[0],s=s[1],2==n.G)if("c"==s[0]){n.J=s[1],n.la=s[2];var o=s[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var a=s[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var c=s[5];null!=c&&"number"===typeof c&&0<c&&(r=1.5*c,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var u=e.g;if(u){var h=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(N(h,"spdy")||N(h,"quic")||N(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(an(l,l.h),l.h=null))}if(r.D){var d=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;d&&(r.sa=d,Ut(r.F,r.D,d))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var f=e;if((r=n).oa=Zn(r,r.H?r.la:null,r.W),f.J){cn(r.i,f);var p=f,m=r.K;m&&p.setTimeout(m),p.B&&(Tt(p),It(p)),r.g=f}else Kn(r);0<n.l.length&&Vn(n)}else"stop"!=s[0]&&"close"!=s[0]||Yn(n,7);else 3==n.G&&("stop"==s[0]||"close"==s[0]?"stop"==s[0]?Yn(n,7):Mn(n):"noop"!=s[0]&&n.j&&n.j.wa(s),n.A=0)}Je(4)}catch(s){}}function At(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(h(e)||"string"===typeof e)_(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(h(e)||"string"===typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;i=(r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"===typeof e)return e.split("");if(h(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}}function Nt(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof Nt)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function Ot(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];Ct(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)Ct(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function Ct(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(s=lt.prototype).setTimeout=function(e){this.P=e},s.gb=function(e){e=e.target;var t=this.L;t&&3==Dn(e)?t.l():this.Ia(e)},s.Ia=function(e){try{if(e==this.g)e:{var t=Dn(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||B||this.g&&(this.h.h||this.g.ga()||Rn(this.g)))){this.I||4!=t||7==n||Je(8==n||0>=r?3:2),Tt(this);var i=this.g.ba();this.N=i;t:if(vt(this)){var s=Rn(this.g);e="";var o=s.length,a=4==Dn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){St(this),Et(this);var u="";break t}this.h.i=new c.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(s[n],{stream:a&&n==o-1});s.splice(0,o),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var h,l=this.g;if((h=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(h)){var d=h;break t}}d=null}if(!(i=d)){this.i=!1,this.o=3,Xe(12),St(this),Et(this);break e}Ge(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,kt(this,i)}this.U?(wt(this,t,u),B&&this.i&&3==t&&(Be(this.V,this.W,"tick",this.fb),this.W.start())):(Ge(this.j,this.m,u,null),kt(this,u)),4==t&&St(this),this.i&&!this.I&&(4==t?Qn(this.l,this):(this.i=!1,It(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,Xe(12)):(this.o=0,Xe(13)),St(this),Et(this)}}}catch(t){}},s.fb=function(){if(this.g){var e=Dn(this.g),t=this.g.ga();this.C<t.length&&(Tt(this),wt(this,e,t),this.i&&4!=e&&It(this))}},s.cancel=function(){this.I=!0,St(this)},s.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(Je(3),Xe(17)),St(this),this.o=2,Et(this)):_t(this,this.Y-e)},(s=Nt.prototype).R=function(){Ot(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},s.T=function(){return Ot(this),this.g.concat()},s.get=function(e,t){return Ct(this.h,e)?this.h[e]:t},s.set=function(e,t){Ct(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},s.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],s=this.get(i);e.call(t,s,i,this)}};var Dt=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Rt(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof Rt){this.g=void 0!==t?t:e.g,Lt(this,e.j),this.s=e.s,xt(this,e.i),Mt(this,e.m),this.l=e.l,t=e.h;var n=new $t;n.i=t.i,t.g&&(n.g=new Nt(t.g),n.h=t.h),Ft(this,n),this.o=e.o}else e&&(n=String(e).match(Dt))?(this.g=!!t,Lt(this,n[1]||"",!0),this.s=Vt(n[2]||""),xt(this,n[3]||"",!0),Mt(this,n[4]),this.l=Vt(n[5]||"",!0),Ft(this,n[6]||"",!0),this.o=Vt(n[7]||"")):(this.g=!!t,this.h=new $t(null,this.g))}function Pt(e){return new Rt(e)}function Lt(e,t,n){e.j=n?Vt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function xt(e,t,n){e.i=n?Vt(t,!0):t}function Mt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Ft(e,t,n){t instanceof $t?(e.h=t,function(e,t){t&&!e.j&&(Qt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Jt(this,t),Xt(this,n,e))}),e)),e.j=t}(e.h,e.g)):(n||(t=qt(t,Ht)),e.h=new $t(t,e.g))}function Ut(e,t,n){e.h.set(t,n)}function jt(e){return Ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Vt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function qt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,Bt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Bt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Rt.prototype.toString=function(){var e=[],t=this.j;t&&e.push(qt(t,zt,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(qt(t,zt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(qt(n,"/"==n.charAt(0)?Gt:Kt,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",qt(n,Wt)),e.join("")};var zt=/[#\/\?@]/g,Kt=/[#\?:]/g,Gt=/[#\?]/g,Ht=/[#\?@]/g,Wt=/#/g;function $t(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Qt(e){e.g||(e.g=new Nt,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Jt(e,t){Qt(e),t=Zt(e,t),Ct(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,Ct((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&Ot(e)))}function Yt(e,t){return Qt(e),t=Zt(e,t),Ct(e.g.h,t)}function Xt(e,t,n){Jt(e,t),0<n.length&&(e.i=null,e.g.set(Zt(e,t),E(n)),e.h+=n.length)}function Zt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(s=$t.prototype).add=function(e,t){Qt(this),this.i=null,e=Zt(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},s.forEach=function(e,t){Qt(this),this.g.forEach((function(n,r){_(n,(function(n){e.call(t,n,r,this)}),this)}),this)},s.T=function(){Qt(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],s=0;s<i.length;s++)n.push(t[r]);return n},s.R=function(e){Qt(this);var t=[];if("string"===typeof e)Yt(this,e)&&(t=T(t,this.g.get(Zt(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=T(t,e[n])}return t},s.set=function(e,t){return Qt(this),this.i=null,Yt(this,e=Zt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},s.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},s.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),e.push(o)}}return this.i=e.join("&")};var en=function(e,t){this.h=e,this.g=t};function tn(e){this.l=e||nn,c.PerformanceNavigationTiming?e=0<(e=c.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(c.g&&c.g.Ea&&c.g.Ea()&&c.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var nn=10;function rn(e){return!!e.h||!!e.g&&e.g.size>=e.j}function sn(e){return e.h?1:e.g?e.g.size:0}function on(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function an(e,t){e.g?e.g.add(t):e.h=t}function cn(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function un(e){var t,n;if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var r=e.i;try{for(var s=i(e.g.values()),o=s.next();!o.done;o=s.next()){var a=o.value;r=r.concat(a.D)}}catch(c){t={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return r}return E(e.i)}function hn(){}function ln(){this.g=new hn}function dn(e,t,n){var r=n||"";try{At(e,(function(e,n){var i=e;l(e)&&(i=Ee(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function fn(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(s){}}function pn(e){this.l=e.$b||null,this.j=e.ib||!1}function mn(e,t){Ie.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=gn,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}tn.prototype.cancel=function(){var e,t;if(this.i=un(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=i(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(s){e={error:s}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.g.clear()}},hn.prototype.stringify=function(e){return c.JSON.stringify(e,void 0)},hn.prototype.parse=function(e){return c.JSON.parse(e,void 0)},v(pn,rt),pn.prototype.g=function(){return new mn(this.l,this.j)},pn.prototype.i=function(e){return function(){return e}}({}),v(mn,Ie);var gn=0;function yn(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function vn(e){e.readyState=4,e.l=null,e.j=null,e.A=null,wn(e)}function wn(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(s=mn.prototype).open=function(e,t){if(this.readyState!=gn)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,wn(this)},s.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||c).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},s.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,vn(this)),this.readyState=gn},s.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,wn(this)),this.g&&(this.readyState=3,wn(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if("undefined"!==typeof c.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;yn(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},s.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?vn(this):wn(this),3==this.readyState&&yn(this)}},s.Ua=function(e){this.g&&(this.response=this.responseText=e,vn(this))},s.Ta=function(e){this.g&&(this.response=e,vn(this))},s.ha=function(){this.g&&vn(this)},s.setRequestHeader=function(e,t){this.v.append(e,t)},s.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(mn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var bn=c.JSON.parse;function In(e){Ie.call(this),this.headers=new Nt,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=_n,this.K=this.L=!1}v(In,Ie);var _n="",Tn=/^https?$/i,En=["POST","PUT"];function Sn(e){return"content-type"==e.toLowerCase()}function kn(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,An(e),On(e)}function An(e){e.D||(e.D=!0,_e(e,"complete"),_e(e,"error"))}function Nn(e){if(e.h&&"undefined"!=typeof a&&(!e.C[1]||4!=Dn(e)||2!=e.ba()))if(e.v&&4==Dn(e))Fe(e.Fa,0,e);else if(_e(e,"readystatechange"),4==Dn(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var s=String(e.H).match(Dt)[1]||null;if(!s&&c.self&&c.self.location){var o=c.self.location.protocol;s=o.substr(0,o.length-1)}i=!Tn.test(s?s.toLowerCase():"")}t=i}if(t)_e(e,"complete"),_e(e,"success");else{e.m=6;try{var u=2<Dn(e)?e.g.statusText:""}catch(h){u=""}e.j=u+" ["+e.ba()+"]",An(e)}}finally{On(e)}}}function On(e,t){if(e.g){Cn(e);var n=e.g,r=e.C[0]?u:null;e.g=null,e.C=null,t||_e(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function Cn(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(c.clearTimeout(e.A),e.A=null)}function Dn(e){return e.g?e.g.readyState:0}function Rn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case _n:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Pn(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return R(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):Ut(e,t,n))}function Ln(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function xn(e){this.za=0,this.l=[],this.h=new Ke,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Ln("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Ln("baseRetryDelayMs",5e3,e),this.$a=Ln("retryDelaySeedMs",1e4,e),this.Ya=Ln("forwardChannelMaxRetries",2,e),this.ra=Ln("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new tn(e&&e.concurrentRequestLimit),this.Ca=new ln,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function Mn(e){if(Un(e),3==e.G){var t=e.V++,n=Pt(e.F);Ut(n,"SID",e.J),Ut(n,"RID",t),Ut(n,"TYPE","terminate"),Bn(e,n),(t=new lt(e,e.h,t,void 0)).K=2,t.v=jt(Pt(n)),n=!1,c.navigator&&c.navigator.sendBeacon&&(n=c.navigator.sendBeacon(t.v.toString(),"")),!n&&c.Image&&((new Image).src=t.v,n=!0),n||(t.g=er(t.l,null),t.g.ea(t.v)),t.F=Date.now(),It(t)}Xn(e)}function Fn(e){e.g&&(Hn(e),e.g.cancel(),e.g=null)}function Un(e){Fn(e),e.u&&(c.clearTimeout(e.u),e.u=null),$n(e),e.i.cancel(),e.m&&("number"===typeof e.m&&c.clearTimeout(e.m),e.m=null)}function jn(e,t){e.l.push(new en(e.Za++,t)),3==e.G&&Vn(e)}function Vn(e){rn(e.i)||e.m||(e.m=!0,De(e.Ha,e),e.C=0)}function qn(e,t){var n;n=t?t.m:e.V++;var r=Pt(e.F);Ut(r,"SID",e.J),Ut(r,"RID",n),Ut(r,"AID",e.U),Bn(e,r),e.o&&e.s&&Pn(r,e.o,e.s),n=new lt(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=zn(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),an(e.i,n),gt(n,r,t)}function Bn(e,t){e.j&&At({},(function(e,n){Ut(t,n,e)}))}function zn(e,t,n){n=Math.min(e.l.length,n);var r=e.j?g(e.j.Oa,e.j,e):null;e:for(var i=e.l,s=-1;;){var o=["count="+n];-1==s?0<n?(s=i[0].h,o.push("ofs="+s)):s=0:o.push("ofs="+s);for(var a=!0,c=0;c<n;c++){var u=i[c].h,h=i[c].g;if(0>(u-=s))s=Math.max(0,i[c].h-100),a=!1;else try{dn(h,o,"req"+u+"_")}catch(l){r&&r(h)}}if(a){r=o.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function Kn(e){e.g||e.u||(e.Y=1,De(e.Ga,e),e.A=0)}function Gn(e){return!(e.g||e.u||3<=e.A)&&(e.Y++,e.u=et(g(e.Ga,e),Jn(e,e.A)),e.A++,!0)}function Hn(e){null!=e.B&&(c.clearTimeout(e.B),e.B=null)}function Wn(e){e.g=new lt(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=Pt(e.oa);Ut(t,"RID","rpc"),Ut(t,"SID",e.J),Ut(t,"CI",e.N?"0":"1"),Ut(t,"AID",e.U),Bn(e,t),Ut(t,"TYPE","xmlhttp"),e.o&&e.s&&Pn(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=jt(Pt(t)),n.s=null,n.U=!0,yt(n,e)}function $n(e){null!=e.v&&(c.clearTimeout(e.v),e.v=null)}function Qn(e,t){var n=null;if(e.g==t){$n(e),Hn(e),e.g=null;var r=2}else{if(!on(e.i,t))return;n=t.D,cn(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;_e(r=$e(),new Ze(r,n,t,i)),Vn(e)}else Kn(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(sn(e.i)>=e.i.j-(e.m?1:0))&&(e.m?(e.l=t.D.concat(e.l),!0):!(1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya))&&(e.m=et(g(e.Ha,e,t),Jn(e,e.C)),e.C++,!0))}(e,t)||2==r&&Gn(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:Yn(e,5);break;case 4:Yn(e,10);break;case 3:Yn(e,6);break;default:Yn(e,2)}}function Jn(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function Yn(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=g(e.jb,e);n||(n=new Rt("//www.google.com/images/cleardot.gif"),c.location&&"http"==c.location.protocol||Lt(n,"https"),jt(n)),function(e,t){var n=new Ke;if(c.Image){var r=new Image;r.onload=y(fn,n,r,"TestLoadImage: loaded",!0,t),r.onerror=y(fn,n,r,"TestLoadImage: error",!1,t),r.onabort=y(fn,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=y(fn,n,r,"TestLoadImage: timeout",!1,t),c.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Xe(2);e.G=0,e.j&&e.j.va(t),Xn(e),Un(e)}function Xn(e){e.G=0,e.I=-1,e.j&&(0==un(e.i).length&&0==e.l.length||(e.i.i.length=0,E(e.l),e.l.length=0),e.j.ua())}function Zn(e,t,n){var r=function(e){return e instanceof Rt?Pt(e):new Rt(e,void 0)}(n);if(""!=r.i)t&&xt(r,t+"."+r.i),Mt(r,r.m);else{var i=c.location;r=function(e,t,n,r){var i=new Rt(null,void 0);return e&&Lt(i,e),t&&xt(i,t),n&&Mt(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&R(e.aa,(function(e,t){Ut(r,t,e)})),t=e.D,n=e.sa,t&&n&&Ut(r,t,n),Ut(r,"VER",e.ma),Bn(e,r),r}function er(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ba&&!e.qa?new In(new pn({ib:!0})):new In(e.qa)).L=e.H,t}function tr(){}function nr(){if(V&&!(10<=Number(Z)))throw Error("Environmental error: no available transport.")}function rr(e,t){Ie.call(this),this.g=new xn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!S(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!S(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new or(this)}function ir(e){ct.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function sr(){ut.call(this),this.status=1}function or(e){this.g=e}(s=In.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():ot.g(),this.C=this.u?it(this.u):it(ot),this.g.onreadystatechange=g(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(s){return void kn(this,s)}e=n||"";var i=new Nt(this.headers);r&&At(r,(function(e,t){i.set(t,e)})),r=function(e){e:{for(var t=Sn,n=e.length,r="string"===typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"===typeof e?e.charAt(t):e[t]}(i.T()),n=c.FormData&&e instanceof c.FormData,!(0<=I(En,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(e,t){this.g.setRequestHeader(t,e)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Cn(this),0<this.B&&((this.K=function(e){return V&&Y()&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=g(this.pa,this)):this.A=Fe(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){kn(this,s)}},s.pa=function(){"undefined"!=typeof a&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,_e(this,"timeout"),this.abort(8))},s.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,_e(this,"complete"),_e(this,"abort"),On(this))},s.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),On(this,!0)),In.Z.M.call(this)},s.Fa=function(){this.s||(this.F||this.v||this.l?Nn(this):this.cb())},s.cb=function(){Nn(this)},s.ba=function(){try{return 2<Dn(this)?this.g.status:-1}catch(U){return-1}},s.ga=function(){try{return this.g?this.g.responseText:""}catch(U){return""}},s.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),bn(t)}},s.Da=function(){return this.m},s.La=function(){return"string"===typeof this.j?this.j:String(this.j)},(s=xn.prototype).ma=8,s.G=1,s.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(t){}},s.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new lt(this,this.h,e,void 0),n=this.s;if(this.P&&(n?x(n=P(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var s=this.l[i];if(void 0===(s="__data__"in s.g&&"string"===typeof(s=s.g.__data__)?s.length:void 0))break;if(4096<(r+=s)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=zn(this,t,r),Ut(i=Pt(this.F),"RID",e),Ut(i,"CVER",22),this.D&&Ut(i,"X-HTTP-Session-Id",this.D),Bn(this,i),this.o&&n&&Pn(i,this.o,n),an(this.i,t),this.Ra&&Ut(i,"TYPE","init"),this.ja?(Ut(i,"$req",r),Ut(i,"SID","null"),t.$=!0,gt(t,i,null)):gt(t,i,r),this.G=2}}else 3==this.G&&(e?qn(this,e):0==this.l.length||rn(this.i)||qn(this))},s.Ga=function(){if(this.u=null,Wn(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=et(g(this.bb,this),e)}},s.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Xe(10),Fn(this),Wn(this))},s.ab=function(){null!=this.v&&(this.v=null,Fn(this),Gn(this),Xe(19))},s.jb=function(e){e?(this.h.info("Successfully pinged google.com"),Xe(2)):(this.h.info("Failed to ping google.com"),Xe(1))},(s=tr.prototype).xa=function(){},s.wa=function(){},s.va=function(){},s.ua=function(){},s.Oa=function(){},nr.prototype.g=function(e,t){return new rr(e,t)},v(rr,Ie),rr.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),De(g(e.hb,e,t))),Xe(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=Zn(e,null,e.W),Vn(e)},rr.prototype.close=function(){Mn(this.g)},rr.prototype.u=function(e){if("string"===typeof e){var t={};t.__data__=e,jn(this.g,t)}else this.v?((t={}).__data__=Ee(e),jn(this.g,t)):jn(this.g,e)},rr.prototype.M=function(){this.g.j=null,delete this.j,Mn(this.g),delete this.g,rr.Z.M.call(this)},v(ir,ct),v(sr,ut),v(or,tr),or.prototype.xa=function(){_e(this.g,"a")},or.prototype.wa=function(e){_e(this.g,new ir(e))},or.prototype.va=function(e){_e(this.g,new sr(e))},or.prototype.ua=function(){_e(this.g,"b")},nr.prototype.createWebChannel=nr.prototype.g,rr.prototype.send=rr.prototype.u,rr.prototype.open=rr.prototype.m,rr.prototype.close=rr.prototype.close,tt.NO_ERROR=0,tt.TIMEOUT=8,tt.HTTP_ERROR=6,nt.COMPLETE="complete",st.EventType=at,at.OPEN="a",at.CLOSE="b",at.ERROR="c",at.MESSAGE="d",Ie.prototype.listen=Ie.prototype.N,In.prototype.listenOnce=In.prototype.O,In.prototype.getLastError=In.prototype.La,In.prototype.getLastErrorCode=In.prototype.Da,In.prototype.getStatus=In.prototype.ba,In.prototype.getResponseJson=In.prototype.Qa,In.prototype.getResponseText=In.prototype.ga,In.prototype.send=In.prototype.ea;var ar=function(){return new nr},cr=function(){return $e()},ur=tt,hr=nt,lr=He,dr={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},fr=pn,pr=st,mr=In}).call(this,n(20))},14:function(e,t,n){"use strict";var r=n(1),i=n(9),s=n(5),o=n(8);class a{constructor(e,t){this._delegate=e,this.firebase=t,Object(s._addComponent)(e,new i.a("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Object(s.deleteApp)(this._delegate)))}_getService(e,t=s._DEFAULT_ENTRY_NAME){var n;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=s._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Object(s._addComponent)(this._delegate,e)}_addOrOverwriteComponent(e){Object(s._addOrOverwriteComponent)(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const c={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},u=new r.b("app-compat","Firebase",c);const h=function e(){const t=function(e){const t={},n={__esModule:!0,initializeApp:function(i,o={}){const a=s.initializeApp(i,o);if(Object(r.e)(t,a.name))return t[a.name];const c=new e(a,n);return t[a.name]=c,c},app:i,registerVersion:s.registerVersion,setLogLevel:s.setLogLevel,onLog:s.onLog,apps:null,SDK_VERSION:s.SDK_VERSION,INTERNAL:{registerComponent:function(t){const o=t.name,a=o.replace("-compat","");if(s._registerComponent(t)&&"PUBLIC"===t.type){const s=(e=i())=>{if("function"!==typeof e[a])throw u.create("invalid-app-argument",{appName:o});return e[a]()};void 0!==t.serviceProps&&Object(r.i)(s,t.serviceProps),n[a]=s,e.prototype[a]=function(...e){return this._getService.bind(this,o).apply(this,t.multipleInstances?e:[])}}return"PUBLIC"===t.type?n[a]:null},removeApp:function(e){delete t[e]},useAsService:function(e,t){if("serverAuth"===t)return null;return t},modularAPIs:s}};function i(e){if(e=e||s._DEFAULT_ENTRY_NAME,!Object(r.e)(t,e))throw u.create("no-app",{appName:e});return t[e]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(t).map(e=>t[e])}}),i.App=e,n}(a);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){Object(r.i)(t,e)},createSubscribe:r.g,ErrorFactory:r.b,deepExtend:r.i}),t}(),l=new o.b("@firebase/app-compat");if(Object(r.m)()&&void 0!==self.firebase){l.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const e=self.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&l.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const d=h;var f;Object(s.registerVersion)("@firebase/app-compat","0.1.1",f),t.a=d},2:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return ve})),n.d(t,"c",(function(){return Ne})),n.d(t,"d",(function(){return Re})),n.d(t,"e",(function(){return Le})),n.d(t,"f",(function(){return Pe})),n.d(t,"g",(function(){return Ee})),n.d(t,"h",(function(){return De})),n.d(t,"i",(function(){return fn})),n.d(t,"j",(function(){return rr})),n.d(t,"k",(function(){return c})),n.d(t,"l",(function(){return on})),n.d(t,"m",(function(){return xe})),n.d(t,"n",(function(){return Me})),n.d(t,"o",(function(){return I})),n.d(t,"p",(function(){return fe})),n.d(t,"q",(function(){return g})),n.d(t,"r",(function(){return Ut})),n.d(t,"s",(function(){return S})),n.d(t,"t",(function(){return Ln})),n.d(t,"u",(function(){return Z})),n.d(t,"w",(function(){return it})),n.d(t,"x",(function(){return Lt})),n.d(t,"y",(function(){return tr})),n.d(t,"z",(function(){return Mt})),n.d(t,"A",(function(){return st})),n.d(t,"B",(function(){return rt})),n.d(t,"C",(function(){return me})),n.d(t,"E",(function(){return at})),n.d(t,"F",(function(){return l})),n.d(t,"G",(function(){return dt})),n.d(t,"H",(function(){return St})),n.d(t,"I",(function(){return Nt})),n.d(t,"J",(function(){return Pn})),n.d(t,"K",(function(){return X})),n.d(t,"L",(function(){return Qt})),n.d(t,"M",(function(){return ht})),n.d(t,"N",(function(){return Je})),n.d(t,"O",(function(){return un})),n.d(t,"P",(function(){return Tn})),n.d(t,"Q",(function(){return Rn})),n.d(t,"R",(function(){return Dt})),n.d(t,"S",(function(){return Ye})),n.d(t,"T",(function(){return hn})),n.d(t,"U",(function(){return _n})),n.d(t,"V",(function(){return Dn})),n.d(t,"W",(function(){return ft})),n.d(t,"X",(function(){return nt})),n.d(t,"Y",(function(){return ut})),n.d(t,"Z",(function(){return Ve})),n.d(t,"ab",(function(){return Qe})),n.d(t,"bb",(function(){return Xe})),n.d(t,"cb",(function(){return ct})),n.d(t,"db",(function(){return lt})),n.d(t,"eb",(function(){return cn})),n.d(t,"fb",(function(){return In})),n.d(t,"gb",(function(){return Cn})),n.d(t,"hb",(function(){return Ke})),n.d(t,"ib",(function(){return gt})),n.d(t,"jb",(function(){return yt})),n.d(t,"kb",(function(){return dn})),n.d(t,"lb",(function(){return mt})),n.d(t,"mb",(function(){return pt})),n.d(t,"nb",(function(){return ot})),n.d(t,"v",(function(){return vr})),n.d(t,"D",(function(){return gr}));var r=n(1),i=n(5);function s(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;var o=n(8),a=n(9);const c={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},u={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function h(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const l=function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},d=h,f=new r.b("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),p=new o.b("@firebase/auth");function m(e,...t){p.logLevel<=o.a.ERROR&&p.error(`Auth (${i.SDK_VERSION}): ${e}`,...t)}function g(e,...t){throw b(e,...t)}function y(e,...t){return b(e,...t)}function v(e,t,n){const i=Object.assign(Object.assign({},d()),{[t]:n});return new r.b("auth","Firebase",i).create(t,{appName:e.name})}function w(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&g(e,"argument-error"),v(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function b(e,...t){if("string"!==typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return f.create(e,...t)}function I(e,t,...n){if(!e)throw b(t,...n)}function _(e){const t="INTERNAL ASSERTION FAILED: "+e;throw m(t),new Error(t)}function T(e,t){e||_(t)}const E=new Map;function S(e){T(e instanceof Function,"Expected a class definition");let t=E.get(e);return t?(T(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,E.set(e,t),t)}function k(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function A(){return"http:"===N()||"https:"===N()}function N(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class O{constructor(e,t){this.shortDelay=e,this.longDelay=t,T(t>e,"Short delay should be less than long delay!"),this.isMobile=Object(r.s)()||Object(r.u)()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(A()||Object(r.n)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function C(e,t){T(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class D{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:void _("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:void _("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:void _("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const R={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},P=new O(3e4,6e4);function L(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function x(e,t,n,i,s={}){return M(e,s,()=>{let s={},o={};i&&("GET"===t?o=i:s={body:JSON.stringify(i)});const a=Object(r.x)(Object.assign({key:e.config.apiKey},o)).slice(1),c=new(D.headers());return c.set("Content-Type","application/json"),c.set("X-Client-Version",e._getSdkClientVersion()),e.languageCode&&c.set("X-Firebase-Locale",e.languageCode),D.fetch()(U(e,e.config.apiHost,n,a),Object.assign({method:t,headers:c,referrerPolicy:"no-referrer"},s))})}async function M(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},R),t);try{const t=new j(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw V(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const t=r.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw V(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw V(e,"email-already-in-use",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw v(e,a,o);g(e,a)}}catch(s){if(s instanceof r.c)throw s;g(e,"network-request-failed")}}async function F(e,t,n,r,i={}){const s=await x(e,t,n,r,i);return"mfaPendingCredential"in s&&g(e,"multi-factor-auth-required",{serverResponse:s}),s}function U(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?C(e.config,i):`${e.config.apiScheme}://${i}`}class j{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(y(this.auth,"timeout")),P.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function V(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=y(e,t,r);return i.customData._tokenResponse=n,i}function q(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function B(e){return 1e3*Number(e)}function z(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return m("JWT malformed, contained fewer than 3 sections"),null;try{const e=Object(r.d)(n);return e?JSON.parse(e):(m("Failed to decode base64 JWT payload"),null)}catch(s){return m("Caught error parsing JWT payload as JSON",s),null}}async function K(e,t,n=!1){if(n)return t;try{return await t}catch(i){throw i instanceof r.c&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(i)&&e.auth.currentUser===e&&await e.auth.signOut(),i}}class G{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e.code&&this.schedule(!0))}this.schedule()}}class H{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=q(this.lastLoginAt),this.creationTime=q(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function W(e){var t;const n=e.auth,r=await e.getIdToken(),i=await K(e,async function(e,t){return x(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));I(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const o=i.users[0];e._notifyReloadListener(o);const a=(null===(t=o.providerUserInfo)||void 0===t?void 0:t.length)?o.providerUserInfo.map(e=>{var{providerId:t}=e,n=s(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}):[];const c=(u=e.providerData,h=a,[...u.filter(e=>!h.some(t=>t.providerId===e.providerId)),...h]);var u,h;const l=e.isAnonymous,d=!(e.email&&o.passwordHash)&&!(null===c||void 0===c?void 0:c.length),f=!!l&&d,p={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new H(o.createdAt,o.lastLoginAt),isAnonymous:f};Object.assign(e,p)}class ${constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){I(e.idToken,"internal-error"),I("undefined"!==typeof e.idToken,"internal-error"),I("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):function(e){const t=z(e);return I(t,"internal-error"),I("undefined"!==typeof t.exp,"internal-error"),I("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return I(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:s}=await async function(e,t){const n=await M(e,{},()=>{const n=Object(r.x)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:s}=e.config,o=U(e,i,"/v1/token","key="+s);return D.fetch()(o,{method:"POST",headers:{"X-Client-Version":e._getSdkClientVersion(),"Content-Type":"application/x-www-form-urlencoded"},body:n})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new $;return n&&(I("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(I("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(I("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $,this.toJSON())}_performRefresh(){return _("not implemented")}}function Q(e,t){I("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class J{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=s(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new G(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.metadata=new H(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await K(this,this.stsTokenManager.getToken(this.auth,e));return I(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=Object(r.k)(e),i=await n.getIdToken(t),s=z(i);I(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const o="object"===typeof s.firebase?s.firebase:void 0,a=null===o||void 0===o?void 0:o.sign_in_provider;return{claims:s,token:i,authTime:q(B(s.auth_time)),issuedAtTime:q(B(s.iat)),expirationTime:q(B(s.exp)),signInProvider:a||null,signInSecondFactor:(null===o||void 0===o?void 0:o.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Object(r.k)(e);await W(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(I(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new J(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){I(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await W(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await K(this,async function(e,t){return x(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,c,u;const h=null!==(n=t.displayName)&&void 0!==n?n:void 0,l=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:w,isAnonymous:b,providerData:_,stsTokenManager:T}=t;I(v&&T,e,"internal-error");const E=$.fromJSON(this.name,T);I("string"===typeof v,e,"internal-error"),Q(h,e.name),Q(l,e.name),I("boolean"===typeof w,e,"internal-error"),I("boolean"===typeof b,e,"internal-error"),Q(d,e.name),Q(f,e.name),Q(p,e.name),Q(m,e.name),Q(g,e.name),Q(y,e.name);const S=new J({uid:v,auth:e,email:l,emailVerified:w,displayName:h,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:E,createdAt:g,lastLoginAt:y});return _&&Array.isArray(_)&&(S.providerData=_.map(e=>Object.assign({},e))),m&&(S._redirectEventId=m),S}static async _fromIdTokenResponse(e,t,n=!1){const r=new $;r.updateFromServerResponse(t);const i=new J({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await W(i),i}}class Y{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Y.type="NONE";const X=Y;function Z(e,t,n){return`firebase:${e}:${t}:${n}`}class ee{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Z(this.userKey,r.apiKey,i),this.fullPersistenceKey=Z("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?J._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new ee(S(X),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||S(X);const s=Z(n,e.config.apiKey,e.name);let o=null;for(const u of t)try{const t=await u._get(s);if(t){const n=J._fromJSON(e,t);u!==i&&(o=n),i=u;break}}catch(c){}const a=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch(c){}})),new ee(i,e,n)):new ee(i,e,n)}}function te(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(se(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ne(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ae(t))return"Blackberry";if(ce(t))return"Webos";if(re(t))return"Safari";if((t.includes("chrome/")||ie(t))&&!t.includes("edge/"))return"Chrome";if(oe(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function ne(e=Object(r.l)()){return/firefox\//i.test(e)}function re(e=Object(r.l)()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function ie(e=Object(r.l)()){return/crios\//i.test(e)}function se(e=Object(r.l)()){return/iemobile/i.test(e)}function oe(e=Object(r.l)()){return/android/i.test(e)}function ae(e=Object(r.l)()){return/blackberry/i.test(e)}function ce(e=Object(r.l)()){return/webos/i.test(e)}function ue(e=Object(r.l)()){return/iphone|ipad|ipod/i.test(e)}function he(e=Object(r.l)()){return ue(e)||oe(e)||ce(e)||ae(e)||/windows phone/i.test(e)||se(e)}function le(e,t=[]){let n;switch(e){case"Browser":n=te(Object(r.l)());break;case"Worker":n=`${te(Object(r.l)())}-${e}`;break;default:n=e}const s=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${i.SDK_VERSION}/${s}`}class de{constructor(e,t){this.app=e,this.config=t,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new pe(this),this.idTokenSubscription=new pe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=f,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=t.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=S(t)),this._initializationPromise=this.queue(async()=>{var n;this._deleted||(this.persistenceManager=await ee.create(this,e),this._deleted||((null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)&&await this._popupRedirectResolver._initialize(this),await this.initializeCurrentUser(t),this._deleted||(this._isInitialized=!0)))}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e):void 0}async initializeCurrentUser(e){var t;let n=await this.assertedPersistence.getCurrentUser();if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,i=null===n||void 0===n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(e);r&&r!==i||!(null===s||void 0===s?void 0:s.user)||(n=s.user)}return n?n._redirectEventId?(I(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await W(e)}catch(t){if("auth/network-request-failed"!==t.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?Object(r.k)(e):null;return t&&I(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){if(!this._deleted)return e&&I(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(S(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new r.b("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&S(e)||this._popupRedirectResolver;I(t,this,"argument-error"),this.redirectPersistenceManager=await ee.create(this,[S(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return I(s,this,"internal-error"),s.then(()=>i(this.currentUser)),"function"===typeof t?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return I(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=le(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getSdkClientVersion(){return this.clientVersion}}function fe(e){return Object(r.k)(e)}class pe{constructor(e){this.auth=e,this.observer=null,this.addObserver=Object(r.g)(e=>this.observer=e)}get next(){return I(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function me(e,t,n){const r=fe(e);I(r._canInitEmulator,r,"emulator-config-failed"),I(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),s=ge(t),{host:o,port:a}=function(e){const t=ge(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:ye(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:ye(t)}}}(t),c=null===a?"":":"+a;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),function(e){function t(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"===typeof window||"undefined"===typeof document||e||("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}(i)}function ge(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function ye(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class ve{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return _("not implemented")}_getIdTokenResponse(e){return _("not implemented")}_linkToIdToken(e,t){return _("not implemented")}_getReauthenticationResolver(e){return _("not implemented")}}async function we(e,t){return x(e,"POST","/v1/accounts:resetPassword",L(e,t))}async function be(e,t){return x(e,"POST","/v1/accounts:update",t)}async function Ie(e,t){return x(e,"POST","/v1/accounts:sendOobCode",L(e,t))}class _e extends ve{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new _e(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new _e(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return async function(e,t){return F(e,"POST","/v1/accounts:signInWithPassword",L(e,t))}(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return F(e,"POST","/v1/accounts:signInWithEmailLink",L(e,t))}(e,{email:this._email,oobCode:this._password});default:g(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return be(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return F(e,"POST","/v1/accounts:signInWithEmailLink",L(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:g(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Te(e,t){return F(e,"POST","/v1/accounts:signInWithIdp",L(e,t))}class Ee extends ve{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ee(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):g("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=s(t,["providerId","signInMethod"]);if(!n||!r)return null;const o=new Ee(n,r);return Object.assign(o,i),o}_getIdTokenResponse(e){return Te(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Te(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Te(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Object(r.x)(t)}return e}}const Se={USER_NOT_FOUND:"user-not-found"};class ke extends ve{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ke({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ke({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return F(e,"POST","/v1/accounts:signInWithPhoneNumber",L(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await F(e,"POST","/v1/accounts:signInWithPhoneNumber",L(e,t));if(n.temporaryProof)throw V(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return F(e,"POST","/v1/accounts:signInWithPhoneNumber",L(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Se)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new ke({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Ae{constructor(e){var t,n,i,s,o,a;const c=Object(r.y)(Object(r.j)(e)),u=null!==(t=c.apiKey)&&void 0!==t?t:null,h=null!==(n=c.oobCode)&&void 0!==n?n:null,l=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=c.mode)&&void 0!==i?i:null);I(u&&h&&l,"argument-error"),this.apiKey=u,this.operation=l,this.code=h,this.continueUrl=null!==(s=c.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=c.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function(e){const t=Object(r.y)(Object(r.j)(e)).link,n=t?Object(r.y)(Object(r.j)(t)).deep_link_id:null,i=Object(r.y)(Object(r.j)(e)).deep_link_id;return(i?Object(r.y)(Object(r.j)(i)).link:null)||i||n||t||e}(e);try{return new Ae(t)}catch(n){return null}}}class Ne{constructor(){this.providerId=Ne.PROVIDER_ID}static credential(e,t){return _e._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Ae.parseLink(t);return I(n,"argument-error"),_e._fromEmailAndCode(e,n.code,n.tenantId)}}Ne.PROVIDER_ID="password",Ne.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Ne.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Oe{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ce extends Oe{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class De extends Ce{static credentialFromJSON(e){const t="string"===typeof e?JSON.parse(e):e;return I("providerId"in t&&"signInMethod"in t,"argument-error"),Ee._fromParams(t)}credential(e){return this._credential(e)}_credential(e){return I(e.idToken||e.accessToken,"argument-error"),Ee._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return De.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return De.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:r,pendingToken:i,nonce:s,providerId:o}=e;if(!n&&!r&&!t&&!i)return null;if(!o)return null;try{return new De(o)._credential({idToken:t,accessToken:n,rawNonce:s,pendingToken:i})}catch(a){return null}}}class Re extends Ce{constructor(){super("facebook.com")}static credential(e){return Ee._fromParams({providerId:Re.PROVIDER_ID,signInMethod:Re.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Re.credentialFromTaggedObject(e)}static credentialFromError(e){return Re.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Re.credential(e.oauthAccessToken)}catch(t){return null}}}Re.FACEBOOK_SIGN_IN_METHOD="facebook.com",Re.PROVIDER_ID="facebook.com";class Pe extends Ce{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ee._fromParams({providerId:Pe.PROVIDER_ID,signInMethod:Pe.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Pe.credentialFromTaggedObject(e)}static credentialFromError(e){return Pe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Pe.credential(t,n)}catch(r){return null}}}Pe.GOOGLE_SIGN_IN_METHOD="google.com",Pe.PROVIDER_ID="google.com";class Le extends Ce{constructor(){super("github.com")}static credential(e){return Ee._fromParams({providerId:Le.PROVIDER_ID,signInMethod:Le.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Le.credentialFromTaggedObject(e)}static credentialFromError(e){return Le.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Le.credential(e.oauthAccessToken)}catch(t){return null}}}Le.GITHUB_SIGN_IN_METHOD="github.com",Le.PROVIDER_ID="github.com";class xe extends ve{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return Te(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Te(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Te(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,pendingToken:i}=t;return n&&r&&i&&n===r?new xe(n,i):null}static _create(e,t){return new xe(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Me extends Ce{constructor(){super("twitter.com")}static credential(e,t){return Ee._fromParams({providerId:Me.PROVIDER_ID,signInMethod:Me.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Me.credentialFromTaggedObject(e)}static credentialFromError(e){return Me.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Me.credential(t,n)}catch(r){return null}}}async function Fe(e,t){return F(e,"POST","/v1/accounts:signUp",L(e,t))}Me.TWITTER_SIGN_IN_METHOD="twitter.com",Me.PROVIDER_ID="twitter.com";class Ue{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await J._fromIdTokenResponse(e,n,r),s=je(n);return new Ue({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=je(n);return new Ue({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function je(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}async function Ve(e){var t;const n=fe(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Ue({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await Fe(n,{returnSecureToken:!0}),i=await Ue._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}class qe extends r.c{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,this.name="FirebaseError",Object.setPrototypeOf(this,qe.prototype),this.appName=e.name,this.code=t.code,this.tenantId=null!==(i=e.tenantId)&&void 0!==i?i:void 0,this.serverResponse=t.customData.serverResponse}static _fromErrorAndOperation(e,t,n,r){return new qe(e,t,n,r)}}function Be(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw qe._fromErrorAndOperation(e,n,t,r);throw n})}function ze(e){return new Set(e.map(({providerId:e})=>e).filter(e=>!!e))}async function Ke(e,t){const n=Object(r.k)(e);await He(!0,n,t);const{providerUserInfo:i}=await async function(e,t){return x(e,"POST","/v1/accounts:update",t)}(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),s=ze(i||[]);return n.providerData=n.providerData.filter(e=>s.has(e.providerId)),s.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function Ge(e,t,n=!1){const r=await K(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Ue._forOperation(e,"link",r)}async function He(e,t,n){await W(t);const r=!1===e?"provider-already-linked":"no-such-provider";I(ze(t.providerData).has(n)===e,t.auth,r)}async function We(e,t,n=!1){const{auth:r}=e;try{const i=await K(e,Be(r,"reauthenticate",t,e),n);I(i.idToken,r,"internal-error");const s=z(i.idToken);I(s,r,"internal-error");const{sub:o}=s;return I(e.uid===o,r,"user-mismatch"),Ue._forOperation(e,"reauthenticate",i)}catch(i){throw"auth/user-not-found"===(null===i||void 0===i?void 0:i.code)&&g(r,"user-mismatch"),i}}async function $e(e,t,n=!1){const r=await Be(e,"signIn",t),i=await Ue._fromIdTokenResponse(e,"signIn",r);return n||await e._updateCurrentUser(i.user),i}async function Qe(e,t){return $e(fe(e),t)}async function Je(e,t){const n=Object(r.k)(e);return await He(!1,n,t.providerId),Ge(n,t)}async function Ye(e,t){return We(Object(r.k)(e),t)}async function Xe(e,t){const n=fe(e),r=await async function(e,t){return F(e,"POST","/v1/accounts:signInWithCustomToken",L(e,t))}(n,{token:t,returnSecureToken:!0}),i=await Ue._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}class Ze{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?et._fromServerResponse(e,t):g(e,"internal-error")}}class et extends Ze{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new et(t)}}function tt(e,t,n){var r;I((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),I("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(I(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iosBundleId=n.iOS.bundleId),n.android&&(I(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function nt(e,t,n){const i=Object(r.k)(e),s={requestType:"PASSWORD_RESET",email:t};n&&tt(i,s,n),await async function(e,t){return Ie(e,t)}(i,s)}async function rt(e,t,n){await we(Object(r.k)(e),{oobCode:t,newPassword:n})}async function it(e,t){await async function(e,t){return x(e,"POST","/v1/accounts:update",L(e,t))}(Object(r.k)(e),{oobCode:t})}async function st(e,t){const n=Object(r.k)(e),i=await we(n,{oobCode:t}),s=i.requestType;switch(I(s,n,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":I(i.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":I(i.mfaInfo,n,"internal-error");default:I(i.email,n,"internal-error")}let o=null;return i.mfaInfo&&(o=Ze._fromServerResponse(fe(n),i.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.newEmail:i.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.email:i.newEmail)||null,multiFactorInfo:o},operation:s}}async function ot(e,t){const{data:n}=await st(Object(r.k)(e),t);return n.email}async function at(e,t,n){const r=fe(e),i=await Fe(r,{returnSecureToken:!0,email:t,password:n}),s=await Ue._fromIdTokenResponse(r,"signIn",i);return await r._updateCurrentUser(s.user),s}function ct(e,t,n){return Qe(Object(r.k)(e),Ne.credential(t,n))}async function ut(e,t,n){const i=Object(r.k)(e),s={requestType:"EMAIL_SIGNIN",email:t};I(n.handleCodeInApp,i,"argument-error"),n&&tt(i,s,n),await async function(e,t){return Ie(e,t)}(i,s)}function ht(e,t){const n=Ae.parseLink(t);return"EMAIL_SIGNIN"===(null===n||void 0===n?void 0:n.operation)}async function lt(e,t,n){const i=Object(r.k)(e),s=Ne.credentialWithLink(t,n||k());return I(s._tenantId===(i.tenantId||null),i,"tenant-id-mismatch"),Qe(i,s)}async function dt(e,t){const n={identifier:t,continueUri:A()?k():"http://localhost"},{signinMethods:i}=await async function(e,t){return x(e,"POST","/v1/accounts:createAuthUri",L(e,t))}(Object(r.k)(e),n);return i||[]}async function ft(e,t){const n=Object(r.k)(e),i={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&tt(n.auth,i,t);const{email:s}=await async function(e,t){return Ie(e,t)}(n.auth,i);s!==e.email&&await e.reload()}async function pt(e,t,n){const i=Object(r.k)(e),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&tt(i.auth,s,n);const{email:o}=await async function(e,t){return Ie(e,t)}(i.auth,s);o!==e.email&&await e.reload()}async function mt(e,{displayName:t,photoURL:n}){if(void 0===t&&void 0===n)return;const i=Object(r.k)(e),s={idToken:await i.getIdToken(),displayName:t,photoUrl:n,returnSecureToken:!0},o=await K(i,async function(e,t){return x(e,"POST","/v1/accounts:update",t)}(i.auth,s));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;const a=i.providerData.find(({providerId:e})=>"password"===e);a&&(a.displayName=i.displayName,a.photoURL=i.photoURL),await i._updateTokensIfNecessary(o)}function gt(e,t){return vt(Object(r.k)(e),t,null)}function yt(e,t){return vt(Object(r.k)(e),null,t)}async function vt(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const s=await K(e,be(r,i));await e._updateTokensIfNecessary(s,!0)}class wt{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class bt extends wt{constructor(e,t,n,r){super(e,t,n),this.username=r}}class It extends wt{constructor(e,t){super(e,"facebook.com",t)}}class _t extends bt{constructor(e,t){super(e,"github.com",t,"string"===typeof(null===t||void 0===t?void 0:t.login)?null===t||void 0===t?void 0:t.login:null)}}class Tt extends wt{constructor(e,t){super(e,"google.com",t)}}class Et extends bt{constructor(e,t,n){super(e,"twitter.com",t,n)}}function St(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;const{providerId:r}=e,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null===e||void 0===e?void 0:e.idToken)){const r=null===(n=null===(t=z(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(r){return new wt(s,"anonymous"!==r&&"custom"!==r?r:null)}}if(!r)return null;switch(r){case"facebook.com":return new It(s,i);case"github.com":return new _t(s,i);case"google.com":return new Tt(s,i);case"twitter.com":return new Et(s,i,e.screenName||null);case"custom":case"anonymous":return new wt(s,null);default:return new wt(s,r,i)}}(n)}class kt{constructor(e,t){this.type=e,this.credential=t}static _fromIdtoken(e){return new kt("enroll",e)}static _fromMfaPendingCredential(e){return new kt("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(null===e||void 0===e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return kt._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return kt._fromIdtoken(e.multiFactorSession.idToken)}return null}}class At{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=fe(e),r=(t.serverResponse.mfaInfo||[]).map(e=>Ze._fromServerResponse(n,e));I(t.serverResponse.mfaPendingCredential,n,"internal-error");const i=kt._fromMfaPendingCredential(t.serverResponse.mfaPendingCredential);return new At(i,r,async e=>{const r=await e._process(n,i);delete t.serverResponse.mfaInfo,delete t.serverResponse.mfaPendingCredential;const s=Object.assign(Object.assign({},t.serverResponse),{idToken:r.idToken,refreshToken:r.refreshToken});switch(t.operationType){case"signIn":const e=await Ue._fromIdTokenResponse(n,t.operationType,s);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return I(t.user,n,"internal-error"),Ue._forOperation(t.user,t.operationType,s);default:g(n,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function Nt(e,t){var n;const i=Object(r.k)(e),s=t;return I(t.operationType,i,"argument-error"),I(null===(n=s.serverResponse)||void 0===n?void 0:n.mfaPendingCredential,i,"argument-error"),At._fromError(i,s)}class Ot{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(t=>Ze._fromServerResponse(e.auth,t)))})}static _fromUser(e){return new Ot(e)}async getSession(){return kt._fromIdtoken(await this.user.getIdToken())}async enroll(e,t){const n=e,r=await this.getSession(),i=await K(this.user,n._process(this.user.auth,r,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t="string"===typeof e?e:e.uid,n=await this.user.getIdToken(),r=await K(this.user,(i=this.user.auth,s={idToken:n,mfaEnrollmentId:t},x(i,"POST","/v2/accounts/mfaEnrollment:withdraw",Object.assign({tenantId:i.tenantId},s))));var i,s;this.enrolledFactors=this.enrolledFactors.filter(({uid:e})=>e!==t),await this.user._updateTokensIfNecessary(r);try{await this.user.reload()}catch(o){if("auth/user-token-expired"!==o.code)throw o}}}const Ct=new WeakMap;function Dt(e){const t=Object(r.k)(e);return Ct.has(t)||Ct.set(t,Ot._fromUser(t)),Ct.get(t)}class Rt{constructor(e,t){this.storage=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem("__sak","1"),this.storage.removeItem("__sak"),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}}class Pt extends Rt{constructor(){super(window.localStorage,"LOCAL"),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=Object(r.l)();return re(e)||ue(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=he(),this._shouldAllowMigration=!0,this.boundEventHandler=this.onStorageEvent.bind(this)}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);Object(r.q)()&&10===document.documentMode&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Pt.type="LOCAL";const Lt=Pt;class xt extends Rt{constructor(){super(window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}xt.type="SESSION";const Mt=xt;class Ft{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Ft(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map(async e=>e(t.origin,i)),a=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Ut(e="",t=10){let n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Ft.receivers=[];class jt{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise((o,a)=>{const c=Ut("",20);r.port1.start();const u=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Vt(){return window}function qt(){return"undefined"!==typeof Vt().WorkerGlobalScope&&"function"===typeof Vt().importScripts}const Bt="firebaseLocalStorageDb";class zt{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Kt(e,t){return e.transaction(["firebaseLocalStorage"],t?"readwrite":"readonly").objectStore("firebaseLocalStorage")}function Gt(){const e=indexedDB.open(Bt,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(r){n(r)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains("firebaseLocalStorage")?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Bt);return new zt(e).toPromise()}(),t(await Gt()))})})}async function Ht(e,t,n){const r=Kt(e,!0).put({fbase_key:t,value:n});return new zt(r).toPromise()}function Wt(e,t){const n=Kt(e,!0).delete(t);return new zt(n).toPromise()}class $t{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Gt()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return qt()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ft._getInstance(qt()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new jt(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Gt();return await Ht(e,"__sak","1"),await Wt(e,"__sak"),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Ht(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Kt(e,!1).get(t),r=await new zt(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Wt(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Kt(e,!1).getAll();return new zt(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}$t.type="LOCAL";const Qt=$t;function Jt(e){return new Promise((t,n)=>{const r=document.createElement("script");var i,s;r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=y("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(null!==(s=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==s?s:document).appendChild(r)})}function Yt(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Xt{constructor(e){this.auth=e,this.counter=1e12,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new Zt(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||1e12;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||1e12;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||1e12;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class Zt{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r="string"===typeof e?document.getElementById(e):e;I(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout(()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(n){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(n){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const en=Yt("rcb"),tn=new O(3e4,6e4);class nn{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!Vt().grecaptcha}load(e,t=""){return I(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)?Promise.resolve(Vt().grecaptcha):new Promise((n,i)=>{const s=Vt().setTimeout(()=>{i(y(e,"network-request-failed"))},tn.get());Vt()[en]=()=>{Vt().clearTimeout(s),delete Vt()[en];const r=Vt().grecaptcha;if(!r)return void i(y(e,"internal-error"));const o=r.render;r.render=(e,t)=>{const n=o(e,t);return this.counter++,n},this.hostLanguage=t,n(r)};Jt("https://www.google.com/recaptcha/api.js??"+Object(r.x)({onload:en,render:"explicit",hl:t})).catch(()=>{clearTimeout(s),i(y(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!Vt().grecaptcha&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class rn{async load(e){return new Xt(e)}clearedOneInstance(){}}const sn={theme:"light",type:"image"};class on{constructor(e,t=Object.assign({},sn),n){this.parameters=t,this.type="recaptcha",this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=fe(n),this.isInvisible="invisible"===this.parameters.size,I("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment");const r="string"===typeof e?document.getElementById(e):e;I(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new rn:new nn,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise(n=>{const r=e=>{e&&(this.tokenChangeListeners.delete(r),n(e))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){I(!this.parameters.sitekey,this.auth,"argument-error"),I(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),I("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(e=>e(t)),"function"===typeof e)e(t);else if("string"===typeof e){const n=Vt()[e];"function"===typeof n&&n(t)}}}assertNotDestroyed(){I(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){I(A()&&!qt(),this.auth,"internal-error"),await function(){let e=null;return new Promise(t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()}).catch(t=>{throw e&&window.removeEventListener("load",e),t})}(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await async function(e){return(await x(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);I(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return I(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class an{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=ke._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function cn(e,t,n){const i=fe(e),s=await ln(i,t,Object(r.k)(n));return new an(s,e=>Qe(i,e))}async function un(e,t,n){const i=Object(r.k)(e);await He(!1,i,"phone");const s=await ln(i.auth,t,Object(r.k)(n));return new an(s,e=>Je(i,e))}async function hn(e,t,n){const i=Object(r.k)(e),s=await ln(i.auth,t,Object(r.k)(n));return new an(s,e=>Ye(i,e))}async function ln(e,t,n){var r;const i=await n.verify();try{let s;if(I("string"===typeof i,e,"argument-error"),I("recaptcha"===n.type,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){I("enroll"===t.type,e,"internal-error");return(await function(e,t){return x(e,"POST","/v2/accounts/mfaEnrollment:start",Object.assign({tenantId:e.tenantId},t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo}{I("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;I(n,e,"missing-multi-factor-info");return(await function(e,t){return x(e,"POST","/v2/accounts/mfaSignIn:start",Object.assign({tenantId:e.tenantId},t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return x(e,"POST","/v1/accounts:sendVerificationCode",L(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}async function dn(e,t){await Ge(Object(r.k)(e),t)}class fn{constructor(e){this.providerId=fn.PROVIDER_ID,this.auth=fe(e)}verifyPhoneNumber(e,t){return ln(this.auth,e,Object(r.k)(t))}static credential(e,t){return ke._fromVerification(e,t)}static credentialFromResult(e){const t=e;return fn.credentialFromTaggedObject(t)}static credentialFromError(e){return fn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?ke._fromTokenResponse(t,n):null}}function pn(e,t){return t?S(t):(I(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}fn.PROVIDER_ID="phone",fn.PHONE_SIGN_IN_METHOD="phone";class mn extends ve{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Te(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Te(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Te(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function gn(e){return $e(e.auth,new mn(e),e.bypassAuthState)}function yn(e){const{auth:t,user:n}=e;return I(n,t,"internal-error"),We(n,new mn(e),e.bypassAuthState)}async function vn(e){const{auth:t,user:n}=e;return I(n,t,"internal-error"),Ge(n,new mn(e),e.bypassAuthState)}class wn{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return gn;case"linkViaPopup":case"linkViaRedirect":return vn;case"reauthViaPopup":case"reauthViaRedirect":return yn;default:g(this.auth,"internal-error")}}resolve(e){T(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){T(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const bn=new O(2e3,1e4);async function In(e,t,n){const r=fe(e);w(e,t,Oe);const i=pn(r,n);return new En(r,"signInViaPopup",t,i).executeNotNull()}async function _n(e,t,n){const i=Object(r.k)(e);w(i.auth,t,Oe);const s=pn(i.auth,n);return new En(i.auth,"reauthViaPopup",t,s,i).executeNotNull()}async function Tn(e,t,n){const i=Object(r.k)(e);w(i.auth,t,Oe);const s=pn(i.auth,n);return new En(i.auth,"linkViaPopup",t,s,i).executeNotNull()}class En extends wn{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,En.currentPopupAction&&En.currentPopupAction.cancel(),En.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return I(e,this.auth,"internal-error"),e}async onExecution(){T(1===this.filter.length,"Popup operations only handle one event");const e=Ut();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(y(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(y(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,En.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(y(this.auth,"popup-closed-by-user"))},2e3):this.pollId=window.setTimeout(e,bn.get())};e()}}En.currentPopupAction=null;const Sn=new Map;class kn extends wn{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Sn.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=On(t),r="true"===await Nn(e)._get(n);return await Nn(e)._remove(n),r}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Sn.set(this.auth._key(),e)}return e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function An(e,t){return Nn(e)._set(On(t),"true")}function Nn(e){return S(e._redirectPersistence)}function On(e){return Z("pendingRedirect",e.config.apiKey,e.name)}function Cn(e,t,n){return async function(e,t,n){const r=fe(e);w(e,t,Oe);const i=pn(r,n);return await An(i,r),i._openRedirect(r,t,"signInViaRedirect")}(e,t,n)}function Dn(e,t,n){return async function(e,t,n){const i=Object(r.k)(e);w(i.auth,t,Oe);const s=pn(i.auth,n);await An(s,i.auth);const o=await xn(i);return s._openRedirect(i.auth,t,"reauthViaRedirect",o)}(e,t,n)}function Rn(e,t,n){return async function(e,t,n){const i=Object(r.k)(e);w(i.auth,t,Oe);const s=pn(i.auth,n);await He(!1,i,t.providerId),await An(s,i.auth);const o=await xn(i);return s._openRedirect(i.auth,t,"linkViaRedirect",o)}(e,t,n)}async function Pn(e,t){return await fe(e)._initializationPromise,Ln(e,t,!1)}async function Ln(e,t,n=!1){const r=fe(e),i=pn(r,t),s=new kn(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}async function xn(e){const t=Ut(e.uid+":::");return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}class Mn{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Un(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Un(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(y(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Fn(e))}saveEventToCache(e){this.cachedEventUids.add(Fn(e)),this.lastProcessedEventTime=Date.now()}}function Fn(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Un({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null===t||void 0===t?void 0:t.code)}async function jn(e,t={}){return x(e,"GET","/v1/projects",t)}const Vn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,qn=/^https?/;function Bn(e){const t=k(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!qn.test(n))return!1;if(Vn.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const zn=new O(3e4,6e4);function Kn(){const e=Vt().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}let Gn=null;function Hn(e){return Gn=Gn||function(e){return new Promise((t,n)=>{var r,i,s;function o(){Kn(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Kn(),n(y(e,"network-request-failed"))},timeout:zn.get()})}if(null===(i=null===(r=Vt().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Vt().gapi)||void 0===s?void 0:s.load)){const t=Yt("iframefcb");return Vt()[t]=()=>{gapi.load?o():n(y(e,"network-request-failed"))},Jt("https://apis.google.com/js/api.js?onload="+t)}o()}}).catch(e=>{throw Gn=null,e})}(e),Gn}const Wn=new O(5e3,15e3),$n={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},Qn=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Jn(e){const t=e.config;I(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?C(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,s={apiKey:t.apiKey,appName:e.name,v:i.SDK_VERSION},o=Qn.get(e.config.apiHost);o&&(s.eid=o);const a=e._getFrameworks();return a.length&&(s.fw=a.join(",")),`${n}?${Object(r.x)(s).slice(1)}`}const Yn={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Xn{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Zn(e,t,n,i=500,s=600){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let c="";const u=Object.assign(Object.assign({},Yn),{width:i.toString(),height:s.toString(),top:o,left:a}),h=Object(r.l)().toLowerCase();n&&(c=ie(h)?"_blank":n),ne(h)&&(t=t||"http://localhost",u.scrollbars="yes");const l=Object.entries(u).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(function(e=Object(r.l)()){var t;return ue(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(h)&&"_self"!==c)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",c),new Xn(null);const d=window.open(t||"",c,l);I(d,e,"popup-blocked");try{d.focus()}catch(f){}return new Xn(d)}function er(e,t,n,s,o,a){I(e.config.authDomain,e,"auth-domain-config-required"),I(e.config.apiKey,e,"invalid-api-key");const c={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:s,v:i.SDK_VERSION,eventId:o};if(t instanceof Oe){t.setDefaultLanguage(e.languageCode),c.providerId=t.providerId||"",Object(r.p)(t.getCustomParameters())||(c.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))c[e]=t}if(t instanceof Ce){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(c.scopes=e.join(","))}e.tenantId&&(c.tid=e.tenantId);const u=c;for(const r of Object.keys(u))void 0===u[r]&&delete u[r];return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/__/auth/handler`;return C(e,"emulator/auth/handler")}(e)}?${Object(r.x)(u).slice(1)}`}const tr=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Mt,this._completeRedirectFn=Ln}async _openPopup(e,t,n,r){var i;T(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return Zn(e,er(e,t,n,k(),r),Ut())}async _openRedirect(e,t,n,r){var i;return await this._originValidation(e),i=er(e,t,n,k(),r),Vt().location.href=i,new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(T(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n}async initAndGetManager(e){const t=await async function(e){const t=await Hn(e),n=Vt().gapi;return I(n,e,"internal-error"),t.open({where:document.body,url:Jn(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$n,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=y(e,"network-request-failed"),s=Vt().setTimeout(()=>{r(i)},Wn.get());function o(){Vt().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{r(i)})}))}(e),n=new Mn(e);return t.register("authEvent",t=>{I(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send("webStorageSupport",{type:"webStorageSupport"},n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==i&&t(!!i),g(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await jn(e);for(const r of t)try{if(Bn(r))return}catch(n){}g(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return he()||re()||ue()}};class nr extends class{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return _("unexpected MultiFactorSessionType")}}}{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new nr(e)}_finalizeEnroll(e,t,n){return function(e,t){return x(e,"POST","/v2/accounts/mfaEnrollment:finalize",Object.assign({tenantId:e.tenantId},t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return function(e,t){return x(e,"POST","/v2/accounts/mfaSignIn:finalize",Object.assign({tenantId:e.tenantId},t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class rr{constructor(){}static assertion(e){return nr._fromCredential(e)}}var ir;class sr{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){I(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function or(){return window}ir="Browser",Object(i._registerComponent)(new a.a("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),{apiKey:r,authDomain:i}=n.options;return(e=>{I(r&&!r.includes(":"),"invalid-api-key",{appName:e.name}),I(!(null===i||void 0===i?void 0:i.includes(":")),"argument-error",{appName:e.name});const n={apiKey:r,authDomain:i,clientPlatform:ir,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:le(ir)},s=new de(e,n);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(S);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(s,t),s})(n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Object(i._registerComponent)(new a.a("auth-internal",e=>(e=>new sr(e))(fe(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),Object(i.registerVersion)("@firebase/auth","0.17.2",function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(ir));async function ar(e,t,n){var r;const{BuildInfo:i}=or();T(t.sessionId,"AuthEvent did not contain a session ID");const s=await async function(e){const t=function(e){if(T(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!==typeof TextEncoder)return(new TextEncoder).encode(e);const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join("")}(t.sessionId),o={};return ue()?o.ibi=i.packageName:oe()?o.apn=i.packageName:g(e,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,er(e,n,t.type,void 0,null!==(r=t.eventId)&&void 0!==r?r:void 0,o)}function cr(e){const{cordova:t}=or();return new Promise(n=>{t.plugins.browsertab.isAvailable(i=>{let s=null;i?t.plugins.browsertab.openUrl(e):s=t.InAppBrowser.open(e,function(e=Object(r.l)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}()?"_blank":"_system","location=yes"),n(s)})})}class ur extends Mn{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}async function hr(e){const t=await fr()._get(pr(e));return t&&await fr()._remove(pr(e)),t}function lr(e,t){var n,r;const i=function(e){const t=mr(e),n=t.link?decodeURIComponent(t.link):void 0,r=mr(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return mr(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){const t=mr(i),s=t.firebaseError?function(e){try{return JSON.parse(e)}catch(t){return null}}(decodeURIComponent(t.firebaseError)):null,o=null===(r=null===(n=null===s||void 0===s?void 0:s.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],a=o?y(o):null;return a?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:a,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function dr(){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<20;n++){const n=Math.floor(Math.random()*t.length);e.push(t.charAt(n))}return e.join("")}function fr(){return S(Lt)}function pr(e){return Z("authEvent",e.config.apiKey,e.name)}function mr(e){if(!(null===e||void 0===e?void 0:e.includes("?")))return{};const[t,...n]=e.split("?");return Object(r.y)(n.join("?"))}const gr=class{constructor(){this._redirectPersistence=Mt,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Ln}async _initialize(e){const t=e._key();let n=this.eventManagers.get(t);return n||(n=new ur(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){g(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,r){!function(e){var t,n,r,i,s,o,a,c,u,h;const l=or();I("function"===typeof(null===(t=null===l||void 0===l?void 0:l.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),I("undefined"!==typeof(null===(n=null===l||void 0===l?void 0:l.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),I("function"===typeof(null===(s=null===(i=null===(r=null===l||void 0===l?void 0:l.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===s?void 0:s.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),I("function"===typeof(null===(c=null===(a=null===(o=null===l||void 0===l?void 0:l.cordova)||void 0===o?void 0:o.plugins)||void 0===a?void 0:a.browsertab)||void 0===c?void 0:c.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),I("function"===typeof(null===(h=null===(u=null===l||void 0===l?void 0:l.cordova)||void 0===u?void 0:u.InAppBrowser)||void 0===h?void 0:h.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),Sn.clear(),await this._originValidation(e);const s=function(e,t,n=null){return{type:t,eventId:n,urlResponse:null,sessionId:dr(),postBody:null,tenantId:e.tenantId,error:y(e,"no-auth-event")}}(e,n,r);await function(e,t){return fr()._set(pr(e),t)}(e,s);const o=await ar(e,s,t);return async function(e,t,n){const{cordova:r}=or();let i=()=>{};try{await new Promise((s,o)=>{let a=null;function c(){var e;s();const t=null===(e=r.plugins.browsertab)||void 0===e?void 0:e.close;"function"===typeof t&&t(),"function"===typeof(null===n||void 0===n?void 0:n.close)&&n.close()}function u(){a||(a=window.setTimeout(()=>{o(y(e,"redirect-cancelled-by-user"))},2e3))}function h(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&u()}t.addPassiveListener(c),document.addEventListener("resume",u,!1),oe()&&document.addEventListener("visibilitychange",h,!1),i=()=>{t.removePassiveListener(c),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",h,!1),a&&window.clearTimeout(a)}})}finally{i()}}(e,i,await cr(o))}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){const{BuildInfo:t}=or(),n={};ue()?n.iosBundleId=t.packageName:oe()?n.androidPackageName=t.packageName:g(e,"operation-not-supported-in-this-environment"),await jn(e,n)}(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:n,handleOpenURL:r,BuildInfo:i}=or(),s=setTimeout(async()=>{await hr(e),t.onEvent(yr())},500),o=async n=>{clearTimeout(s);const r=await hr(e);let i=null;r&&(null===n||void 0===n?void 0:n.url)&&(i=lr(r,n.url)),t.onEvent(i||yr())};"undefined"!==typeof n&&"function"===typeof n.subscribe&&n.subscribe(null,o);const a=r,c=i.packageName.toLowerCase()+"://";or().handleOpenURL=async e=>{if(e.toLowerCase().startsWith(c)&&o({url:e}),"function"===typeof a)try{a(e)}catch(t){console.error(t)}}}};function yr(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:y("no-auth-event")}}function vr(e,t){fe(e)._logFramework(t)}},23:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.create;Object.create},33:function(e,t,n){"use strict";var r=n(14);n.d(t,"a",(function(){return r.a}));r.a.registerVersion("firebase","9.0.2","app-compat")},4:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return su})),n.d(t,"b",(function(){return tc})),n.d(t,"c",(function(){return Va})),n.d(t,"d",(function(){return Oa})),n.d(t,"e",(function(){return Lc})),n.d(t,"f",(function(){return ec})),n.d(t,"g",(function(){return _})),n.d(t,"h",(function(){return rc})),n.d(t,"i",(function(){return xc})),n.d(t,"j",(function(){return Mc})),n.d(t,"k",(function(){return M})),n.d(t,"l",(function(){return cu})),n.d(t,"m",(function(){return ya})),n.d(t,"n",(function(){return re})),n.d(t,"o",(function(){return K})),n.d(t,"p",(function(){return Ea})),n.d(t,"q",(function(){return w})),n.d(t,"r",(function(){return H})),n.d(t,"s",(function(){return m})),n.d(t,"t",(function(){return ba})),n.d(t,"u",(function(){return bu})),n.d(t,"v",(function(){return Cu})),n.d(t,"w",(function(){return Ou})),n.d(t,"x",(function(){return Wa})),n.d(t,"y",(function(){return Ra})),n.d(t,"z",(function(){return Pa})),n.d(t,"A",(function(){return Na})),n.d(t,"B",(function(){return wu})),n.d(t,"C",(function(){return Au})),n.d(t,"D",(function(){return Ja})),n.d(t,"E",(function(){return La})),n.d(t,"F",(function(){return Ka})),n.d(t,"G",(function(){return Ga})),n.d(t,"H",(function(){return Qa})),n.d(t,"I",(function(){return eu})),n.d(t,"J",(function(){return Zc})),n.d(t,"K",(function(){return Ba})),n.d(t,"L",(function(){return Tu})),n.d(t,"M",(function(){return hu})),n.d(t,"N",(function(){return du})),n.d(t,"O",(function(){return fu})),n.d(t,"P",(function(){return pu})),n.d(t,"Q",(function(){return mu})),n.d(t,"R",(function(){return gu})),n.d(t,"S",(function(){return Du})),n.d(t,"T",(function(){return Wc})),n.d(t,"U",(function(){return $c})),n.d(t,"V",(function(){return Ya})),n.d(t,"W",(function(){return Xa})),n.d(t,"X",(function(){return Iu})),n.d(t,"Y",(function(){return _u})),n.d(t,"Z",(function(){return Gc})),n.d(t,"ab",(function(){return qc})),n.d(t,"bb",(function(){return Ma})),n.d(t,"cb",(function(){return xa})),n.d(t,"db",(function(){return ku})),n.d(t,"eb",(function(){return Nu})),n.d(t,"fb",(function(){return yu})),n.d(t,"gb",(function(){return d})),n.d(t,"hb",(function(){return Uc})),n.d(t,"ib",(function(){return Yc})),n.d(t,"jb",(function(){return Jc})),n.d(t,"kb",(function(){return vu})),n.d(t,"lb",(function(){return $a})),n.d(t,"mb",(function(){return zc}));var r=n(5),i=n(9),s=n(8),o=n(1),a=n(10);class c{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}c.UNAUTHENTICATED=new c(null),c.GOOGLE_CREDENTIALS=new c("google-credentials-uid"),c.FIRST_PARTY=new c("first-party-uid"),c.MOCK_USER=new c("mock-user");let u="9.0.2";const h=new s.b("@firebase/firestore");function l(){return h.logLevel}function d(e){h.setLogLevel(e)}function f(e,...t){if(h.logLevel<=s.a.DEBUG){const n=t.map(g);h.debug(`Firestore (${u}): ${e}`,...n)}}function p(e,...t){if(h.logLevel<=s.a.ERROR){const n=t.map(g);h.error(`Firestore (${u}): ${e}`,...n)}}function m(e,...t){if(h.logLevel<=s.a.WARN){const n=t.map(g);h.warn(`Firestore (${u}): ${e}`,...n)}}function g(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function y(e="Unexpected state"){const t=`FIRESTORE (${u}) INTERNAL ASSERTION FAILED: `+e;throw p(t),new Error(t)}function v(e,t){e||y()}function w(e,t){e||y()}function b(e,t){return e}const I={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class _ extends Error{constructor(e,t){super(t),this.code=e,this.message=t,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class T{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class E{constructor(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+e}}class S{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(c.UNAUTHENTICATED))}shutdown(){}}class k{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class A{constructor(e){this.t=e,this.currentUser=c.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new T;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new T,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{f("FirebaseCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(f("FirebaseCredentialsProvider","Auth not yet detected"),i.resolve(),i=new T)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(f("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(v("string"==typeof t.accessToken),new E(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return v(null===e||"string"==typeof e),new c(e)}}class N{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=c.FIRST_PARTY}get authHeaders(){const e={"X-Goog-AuthUser":this.l},t=this.h.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),this.m&&(e["X-Goog-Iam-Authorization-Token"]=this.m),e}}class O{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new N(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(c.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class C{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.g(e),this.p=e=>t.writeSequenceNumber(e))}g(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.p&&this.p(e),e}}function D(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}C.T=-1;class R{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const r=D(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length))}return n}}function P(e,t){return e<t?-1:e>t?1:0}function L(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}function x(e){return e+"\0"}class M{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new _(I.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new _(I.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new _(I.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new _(I.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return M.fromMillis(Date.now())}static fromDate(e){return M.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new M(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?P(this.nanoseconds,e.nanoseconds):P(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class F{constructor(e){this.timestamp=e}static fromTimestamp(e){return new F(e)}static min(){return new F(new M(0,0))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function U(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function j(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function V(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class q{constructor(e,t,n){void 0===t?t=0:t>e.length&&y(),void 0===n?n=e.length-t:n>e.length-t&&y(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===q.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof q?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class B extends q{construct(e,t,n){return new B(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new _(I.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new B(t)}static emptyPath(){return new B([])}}const z=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class K extends q{construct(e,t,n){return new K(e,t,n)}static isValidIdentifier(e){return z.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),K.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new K(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new _(I.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new _(I.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new _(I.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new _(I.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new K(t)}static emptyPath(){return new K([])}}class G{constructor(e){this.fields=e,e.sort(K.comparator)}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return L(this.fields,e.fields,(e,t)=>e.isEqual(t))}}function H(){return"undefined"!=typeof atob}class W{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new W(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new W(t)}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return P(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}W.EMPTY_BYTE_STRING=new W("");const $=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Q(e){if(v(!!e),"string"==typeof e){let t=0;const n=$.exec(e);if(v(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:J(e.seconds),nanos:J(e.nanos)}}function J(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Y(e){return"string"==typeof e?W.fromBase64String(e):W.fromUint8Array(e)}function X(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Z(e){const t=Q(e.mapValue.fields.__local_write_time__.timestampValue);return new M(t.seconds,t.nanos)}function ee(e){return null==e}function te(e){return 0===e&&1/e==-1/0}function ne(e){return"number"==typeof e&&Number.isInteger(e)&&!te(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}class re{constructor(e){this.path=e}static fromPath(e){return new re(B.fromString(e))}static fromName(e){return new re(B.fromString(e).popFirst(5))}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}isEqual(e){return null!==e&&0===B.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return B.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new re(new B(e.slice()))}}function ie(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?X(e)?4:10:y()}function se(e,t){const n=ie(e);if(n!==ie(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Z(e).isEqual(Z(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Q(e.timestampValue),r=Q(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Y(e.bytesValue).isEqual(Y(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return J(e.geoPointValue.latitude)===J(t.geoPointValue.latitude)&&J(e.geoPointValue.longitude)===J(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return J(e.integerValue)===J(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=J(e.doubleValue),r=J(t.doubleValue);return n===r?te(n)===te(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return L(e.arrayValue.values||[],t.arrayValue.values||[],se);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(U(n)!==U(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!se(n[i],r[i])))return!1;return!0}(e,t);default:return y()}}function oe(e,t){return void 0!==(e.values||[]).find(e=>se(e,t))}function ae(e,t){const n=ie(e),r=ie(t);if(n!==r)return P(n,r);switch(n){case 0:return 0;case 1:return P(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=J(e.integerValue||e.doubleValue),r=J(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return ce(e.timestampValue,t.timestampValue);case 4:return ce(Z(e),Z(t));case 5:return P(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Y(e),r=Y(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=P(n[i],r[i]);if(0!==e)return e}return P(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=P(J(e.latitude),J(t.latitude));return 0!==n?n:P(J(e.longitude),J(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=ae(n[i],r[i]);if(e)return e}return P(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=P(r[o],s[o]);if(0!==e)return e;const t=ae(n[r[o]],i[s[o]]);if(0!==t)return t}return P(r.length,s.length)}(e.mapValue,t.mapValue);default:throw y()}}function ce(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return P(e,t);const n=Q(e),r=Q(t),i=P(n.seconds,r.seconds);return 0!==i?i:P(n.nanos,r.nanos)}function ue(e){return function e(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(e){const t=Q(e);return`time(${t.seconds},${t.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Y(t.bytesValue).toBase64():"referenceValue"in t?(r=t.referenceValue,re.fromName(r).toString()):"geoPointValue"in t?`geo(${(n=t.geoPointValue).latitude},${n.longitude})`:"arrayValue"in t?function(t){let n="[",r=!0;for(const i of t.values||[])r?r=!1:n+=",",n+=e(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(t){const n=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const s of n)i?i=!1:r+=",",r+=`${s}:${e(t.fields[s])}`;return r+"}"}(t.mapValue):y();var n,r}(e)}function he(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function le(e){return!!e&&"integerValue"in e}function de(e){return!!e&&"arrayValue"in e}function fe(e){return!!e&&"nullValue"in e}function pe(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function me(e){return!!e&&"mapValue"in e}function ge(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return j(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=ge(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=ge(e.arrayValue.values[n]);return t}return Object.assign({},e)}class ye{constructor(e){this.value=e}static empty(){return new ye({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!me(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ge(t)}setAll(e){let t=K.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=ge(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());me(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return se(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];me(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){j(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new ye(ge(this.value))}}function ve(e){const t=[];return j(e.fields,(e,n)=>{const r=new K([e]);if(me(n)){const e=ve(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new G(t)}class we{constructor(e,t,n,r,i){this.key=e,this.documentType=t,this.version=n,this.data=r,this.documentState=i}static newInvalidDocument(e){return new we(e,0,F.min(),ye.empty(),0)}static newFoundDocument(e,t,n){return new we(e,1,t,n,0)}static newNoDocument(e,t){return new we(e,2,t,ye.empty(),0)}static newUnknownDocument(e,t){return new we(e,3,t,ye.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ye.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ye.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof we&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}clone(){return new we(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class be{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.A=null}}function Ie(e,t=null,n=[],r=[],i=null,s=null,o=null){return new be(e,t,n,r,i,s,o)}function _e(e){const t=b(e);if(null===t.A){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>function(e){return e.field.canonicalString()+e.op.toString()+ue(e.value)}(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),ee(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=xe(t.startAt)),t.endAt&&(e+="|ub:",e+=xe(t.endAt)),t.A=e}return t.A}function Te(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let i=0;i<e.orderBy.length;i++)if(!Fe(e.orderBy[i],t.orderBy[i]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let i=0;i<e.filters.length;i++)if(n=e.filters[i],r=t.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!se(n.value,r.value))return!1;var n,r;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!je(e.startAt,t.startAt)&&je(e.endAt,t.endAt)}function Ee(e){return re.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Se extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.R(e,t,n):new ke(e,t,n):"array-contains"===t?new Ce(e,n):"in"===t?new De(e,n):"not-in"===t?new Re(e,n):"array-contains-any"===t?new Pe(e,n):new Se(e,t,n)}static R(e,t,n){return"in"===t?new Ae(e,n):new Ne(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.P(ae(t,this.value)):null!==t&&ie(this.value)===ie(t)&&this.P(ae(t,this.value))}P(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return y()}}v(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class ke extends Se{constructor(e,t,n){super(e,t,n),this.key=re.fromName(n.referenceValue)}matches(e){const t=re.comparator(e.key,this.key);return this.P(t)}}class Ae extends Se{constructor(e,t){super(e,"in",t),this.keys=Oe("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Ne extends Se{constructor(e,t){super(e,"not-in",t),this.keys=Oe("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Oe(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>re.fromName(e.referenceValue))}class Ce extends Se{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return de(t)&&oe(t.arrayValue,this.value)}}class De extends Se{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&oe(this.value.arrayValue,t)}}class Re extends Se{constructor(e,t){super(e,"not-in",t)}matches(e){if(oe(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!oe(this.value.arrayValue,t)}}class Pe extends Se{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!de(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>oe(this.value.arrayValue,e))}}class Le{constructor(e,t){this.position=e,this.before=t}}function xe(e){return`${e.before?"b":"a"}:${e.position.map(e=>ue(e)).join(",")}`}class Me{constructor(e,t="asc"){this.field=e,this.dir=t}}function Fe(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function Ue(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?re.comparator(re.fromName(o.referenceValue),n.key):ae(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function je(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.before!==t.before||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!se(e.position[n],t.position[n]))return!1;return!0}class Ve{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.V=null,this.S=null,this.startAt,this.endAt}}function qe(e,t,n,r,i,s,o,a){return new Ve(e,t,n,r,i,s,o,a)}function Be(e){return new Ve(e)}function ze(e){return!ee(e.limit)&&"F"===e.limitType}function Ke(e){return!ee(e.limit)&&"L"===e.limitType}function Ge(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function He(e){for(const t of e.filters)if(t.v())return t.field;return null}function We(e){return null!==e.collectionGroup}function $e(e){const t=b(e);if(null===t.V){t.V=[];const e=He(t),n=Ge(t);if(null!==e&&null===n)e.isKeyField()||t.V.push(new Me(e)),t.V.push(new Me(K.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.V.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.V.push(new Me(K.keyField(),e))}}}return t.V}function Qe(e){const t=b(e);if(!t.S)if("F"===t.limitType)t.S=Ie(t.path,t.collectionGroup,$e(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of $e(t)){const t="desc"===i.dir?"asc":"desc";e.push(new Me(i.field,t))}const n=t.endAt?new Le(t.endAt.position,!t.endAt.before):null,r=t.startAt?new Le(t.startAt.position,!t.startAt.before):null;t.S=Ie(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t.S}function Je(e,t,n){return new Ve(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Ye(e,t){return Te(Qe(e),Qe(t))&&e.limitType===t.limitType}function Xe(e){return`${_e(Qe(e))}|lt:${e.limitType}`}function Ze(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>{return`${(t=e).field.canonicalString()} ${t.op} ${ue(t.value)}`;var t}).join(", ")}]`),ee(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e)).join(", ")}]`),e.startAt&&(t+=", startAt: "+xe(e.startAt)),e.endAt&&(t+=", endAt: "+xe(e.endAt)),`Target(${t})`}(Qe(e))}; limitType=${e.limitType})`}function et(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):re.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of e.explicitOrderBy)if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!Ue(e.startAt,$e(e),t))&&(!e.endAt||!Ue(e.endAt,$e(e),t))}(e,t)}function tt(e){return(t,n)=>{let r=!1;for(const i of $e(e)){const e=nt(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function nt(e,t,n){const r=e.field.isKeyField()?re.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?ae(r,i):y()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return y()}}function rt(e,t){if(e.D){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:te(t)?"-0":t}}function it(e){return{integerValue:""+e}}function st(e,t){return ne(t)?it(t):rt(e,t)}class ot{constructor(){this._=void 0}}function at(e,t,n){return e instanceof ht?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof lt?dt(e,t):e instanceof ft?pt(e,t):function(e,t){const n=ut(e,t),r=gt(n)+gt(e.C);return le(n)&&le(e.C)?it(r):rt(e.N,r)}(e,t)}function ct(e,t,n){return e instanceof lt?dt(e,t):e instanceof ft?pt(e,t):n}function ut(e,t){return e instanceof mt?le(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}class ht extends ot{}class lt extends ot{constructor(e){super(),this.elements=e}}function dt(e,t){const n=yt(t);for(const r of e.elements)n.some(e=>se(e,r))||n.push(r);return{arrayValue:{values:n}}}class ft extends ot{constructor(e){super(),this.elements=e}}function pt(e,t){let n=yt(t);for(const r of e.elements)n=n.filter(e=>!se(e,r));return{arrayValue:{values:n}}}class mt extends ot{constructor(e,t){super(),this.N=e,this.C=t}}function gt(e){return J(e.integerValue||e.doubleValue)}function yt(e){return de(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class vt{constructor(e,t){this.field=e,this.transform=t}}class wt{constructor(e,t){this.version=e,this.transformResults=t}}class bt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new bt}static exists(e){return new bt(void 0,e)}static updateTime(e){return new bt(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function It(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class _t{}function Tt(e,t,n){e instanceof Nt?function(e,t,n){const r=e.value.clone(),i=Dt(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Ot?function(e,t,n){if(!It(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Dt(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Ct(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Et(e,t,n){e instanceof Nt?function(e,t,n){if(!It(e.precondition,t))return;const r=e.value.clone(),i=Rt(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument(At(t),r).setHasLocalMutations()}(e,t,n):e instanceof Ot?function(e,t,n){if(!It(e.precondition,t))return;const r=Rt(e.fieldTransforms,n,t),i=t.data;i.setAll(Ct(e)),i.setAll(r),t.convertToFoundDocument(At(t),i).setHasLocalMutations()}(e,t,n):function(e,t){It(e.precondition,t)&&t.convertToNoDocument(F.min())}(e,t)}function St(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=ut(r.transform,e||null);null!=i&&(null==n&&(n=ye.empty()),n.set(r.field,i))}return n||null}function kt(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&L(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof lt&&t instanceof lt||e instanceof ft&&t instanceof ft?L(e.elements,t.elements,se):e instanceof mt&&t instanceof mt?se(e.C,t.C):e instanceof ht&&t instanceof ht}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function At(e){return e.isFoundDocument()?e.version:F.min()}class Nt extends _t{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}}class Ot extends _t{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}}function Ct(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Dt(e,t,n){const r=new Map;v(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,ct(o,a,n[i]))}return r}function Rt(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,at(e,s,t))}return r}class Pt extends _t{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}}class Lt extends _t{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}}class xt{constructor(e){this.count=e}}var Mt,Ft;function Ut(e){switch(e){case I.OK:return y();case I.CANCELLED:case I.UNKNOWN:case I.DEADLINE_EXCEEDED:case I.RESOURCE_EXHAUSTED:case I.INTERNAL:case I.UNAVAILABLE:case I.UNAUTHENTICATED:return!1;case I.INVALID_ARGUMENT:case I.NOT_FOUND:case I.ALREADY_EXISTS:case I.PERMISSION_DENIED:case I.FAILED_PRECONDITION:case I.ABORTED:case I.OUT_OF_RANGE:case I.UNIMPLEMENTED:case I.DATA_LOSS:return!0;default:return y()}}function jt(e){if(void 0===e)return p("GRPC error has no .code"),I.UNKNOWN;switch(e){case Mt.OK:return I.OK;case Mt.CANCELLED:return I.CANCELLED;case Mt.UNKNOWN:return I.UNKNOWN;case Mt.DEADLINE_EXCEEDED:return I.DEADLINE_EXCEEDED;case Mt.RESOURCE_EXHAUSTED:return I.RESOURCE_EXHAUSTED;case Mt.INTERNAL:return I.INTERNAL;case Mt.UNAVAILABLE:return I.UNAVAILABLE;case Mt.UNAUTHENTICATED:return I.UNAUTHENTICATED;case Mt.INVALID_ARGUMENT:return I.INVALID_ARGUMENT;case Mt.NOT_FOUND:return I.NOT_FOUND;case Mt.ALREADY_EXISTS:return I.ALREADY_EXISTS;case Mt.PERMISSION_DENIED:return I.PERMISSION_DENIED;case Mt.FAILED_PRECONDITION:return I.FAILED_PRECONDITION;case Mt.ABORTED:return I.ABORTED;case Mt.OUT_OF_RANGE:return I.OUT_OF_RANGE;case Mt.UNIMPLEMENTED:return I.UNIMPLEMENTED;case Mt.DATA_LOSS:return I.DATA_LOSS;default:return y()}}(Ft=Mt||(Mt={}))[Ft.OK=0]="OK",Ft[Ft.CANCELLED=1]="CANCELLED",Ft[Ft.UNKNOWN=2]="UNKNOWN",Ft[Ft.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ft[Ft.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ft[Ft.NOT_FOUND=5]="NOT_FOUND",Ft[Ft.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ft[Ft.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ft[Ft.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ft[Ft.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ft[Ft.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ft[Ft.ABORTED=10]="ABORTED",Ft[Ft.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ft[Ft.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ft[Ft.INTERNAL=13]="INTERNAL",Ft[Ft.UNAVAILABLE=14]="UNAVAILABLE",Ft[Ft.DATA_LOSS=15]="DATA_LOSS";class Vt{constructor(e,t){this.comparator=e,this.root=t||Bt.EMPTY}insert(e,t){return new Vt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bt.BLACK,null,null))}remove(e){return new Vt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new qt(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new qt(this.root,e,this.comparator,!1)}getReverseIterator(){return new qt(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new qt(this.root,e,this.comparator,!0)}}class qt{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bt{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Bt.RED,this.left=null!=r?r:Bt.EMPTY,this.right=null!=i?i:Bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Bt(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Bt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Bt.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw y();if(this.right.isRed())throw y();const e=this.left.check();if(e!==this.right.check())throw y();return e+(this.isRed()?0:1)}}Bt.EMPTY=null,Bt.RED=!0,Bt.BLACK=!1,Bt.EMPTY=new class{constructor(){this.size=0}get key(){throw y()}get value(){throw y()}get color(){throw y()}get left(){throw y()}get right(){throw y()}copy(e,t,n,r,i){return this}insert(e,t,n){return new Bt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class zt{constructor(e){this.comparator=e,this.data=new Vt(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Kt(this.data.getIterator())}getIteratorFrom(e){return new Kt(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof zt))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new zt(this.comparator);return t.data=e,t}}class Kt{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}const Gt=new Vt(re.comparator);function Ht(){return Gt}const Wt=new Vt(re.comparator);function $t(){return Wt}const Qt=new Vt(re.comparator);function Jt(){return Qt}const Yt=new zt(re.comparator);function Xt(...e){let t=Yt;for(const n of e)t=t.add(n);return t}const Zt=new zt(P);function en(){return Zt}class tn{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t){const n=new Map;return n.set(e,nn.createSynthesizedTargetChangeForCurrentChange(e,t)),new tn(F.min(),n,en(),Ht(),Xt())}}class nn{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t){return new nn(W.EMPTY_BYTE_STRING,t,Xt(),Xt(),Xt())}}class rn{constructor(e,t,n,r){this.k=e,this.removedTargetIds=t,this.key=n,this.$=r}}class sn{constructor(e,t){this.targetId=e,this.O=t}}class on{constructor(e,t,n=W.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class an{constructor(){this.F=0,this.M=hn(),this.L=W.EMPTY_BYTE_STRING,this.B=!1,this.U=!0}get current(){return this.B}get resumeToken(){return this.L}get q(){return 0!==this.F}get K(){return this.U}j(e){e.approximateByteSize()>0&&(this.U=!0,this.L=e)}W(){let e=Xt(),t=Xt(),n=Xt();return this.M.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:y()}}),new nn(this.L,this.B,e,t,n)}G(){this.U=!1,this.M=hn()}H(e,t){this.U=!0,this.M=this.M.insert(e,t)}J(e){this.U=!0,this.M=this.M.remove(e)}Y(){this.F+=1}X(){this.F-=1}Z(){this.U=!0,this.B=!0}}class cn{constructor(e){this.tt=e,this.et=new Map,this.nt=Ht(),this.st=un(),this.it=new zt(P)}rt(e){for(const t of e.k)e.$&&e.$.isFoundDocument()?this.ot(t,e.$):this.at(t,e.key,e.$);for(const t of e.removedTargetIds)this.at(t,e.key,e.$)}ct(e){this.forEachTarget(e,t=>{const n=this.ut(t);switch(e.state){case 0:this.ht(t)&&n.j(e.resumeToken);break;case 1:n.X(),n.q||n.G(),n.j(e.resumeToken);break;case 2:n.X(),n.q||this.removeTarget(t);break;case 3:this.ht(t)&&(n.Z(),n.j(e.resumeToken));break;case 4:this.ht(t)&&(this.lt(t),n.j(e.resumeToken));break;default:y()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.et.forEach((e,n)=>{this.ht(n)&&t(n)})}ft(e){const t=e.targetId,n=e.O.count,r=this.dt(t);if(r){const e=r.target;if(Ee(e))if(0===n){const n=new re(e.path);this.at(t,n,we.newNoDocument(n,F.min()))}else v(1===n);else this.wt(t)!==n&&(this.lt(t),this.it=this.it.add(t))}}_t(e){const t=new Map;this.et.forEach((n,r)=>{const i=this.dt(r);if(i){if(n.current&&Ee(i.target)){const t=new re(i.target.path);null!==this.nt.get(t)||this.gt(r,t)||this.at(r,t,we.newNoDocument(t,e))}n.K&&(t.set(r,n.W()),n.G())}});let n=Xt();this.st.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.dt(e);return!t||2===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))});const r=new tn(e,t,this.it,this.nt,n);return this.nt=Ht(),this.st=un(),this.it=new zt(P),r}ot(e,t){if(!this.ht(e))return;const n=this.gt(e,t.key)?2:0;this.ut(e).H(t.key,n),this.nt=this.nt.insert(t.key,t),this.st=this.st.insert(t.key,this.yt(t.key).add(e))}at(e,t,n){if(!this.ht(e))return;const r=this.ut(e);this.gt(e,t)?r.H(t,1):r.J(t),this.st=this.st.insert(t,this.yt(t).delete(e)),n&&(this.nt=this.nt.insert(t,n))}removeTarget(e){this.et.delete(e)}wt(e){const t=this.ut(e).W();return this.tt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Y(e){this.ut(e).Y()}ut(e){let t=this.et.get(e);return t||(t=new an,this.et.set(e,t)),t}yt(e){let t=this.st.get(e);return t||(t=new zt(P),this.st=this.st.insert(e,t)),t}ht(e){const t=null!==this.dt(e);return t||f("WatchChangeAggregator","Detected inactive target",e),t}dt(e){const t=this.et.get(e);return t&&t.q?null:this.tt.Et(e)}lt(e){this.et.set(e,new an),this.tt.getRemoteKeysForTarget(e).forEach(t=>{this.at(e,t,null)})}gt(e,t){return this.tt.getRemoteKeysForTarget(e).has(t)}}function un(){return new Vt(re.comparator)}function hn(){return new Vt(re.comparator)}const ln={asc:"ASCENDING",desc:"DESCENDING"},dn={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class fn{constructor(e,t){this.databaseId=e,this.D=t}}function pn(e,t){return e.D?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function mn(e,t){return e.D?t.toBase64():t.toUint8Array()}function gn(e,t){return pn(e,t.toTimestamp())}function yn(e){return v(!!e),F.fromTimestamp(function(e){const t=Q(e);return new M(t.seconds,t.nanos)}(e))}function vn(e,t){return function(e){return new B(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function wn(e){const t=B.fromString(e);return v(Bn(t)),t}function bn(e,t){return vn(e.databaseId,t.path)}function In(e,t){const n=wn(t);if(n.get(1)!==e.databaseId.projectId)throw new _(I.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new _(I.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new re(Sn(n))}function _n(e,t){return vn(e.databaseId,t)}function Tn(e){const t=wn(e);return 4===t.length?B.emptyPath():Sn(t)}function En(e){return new B(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Sn(e){return v(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function kn(e,t,n){return{name:bn(e,t),fields:n.value.mapValue.fields}}function An(e,t,n){const r=In(e,t.name),i=yn(t.updateTime),s=new ye({mapValue:{fields:t.fields}}),o=we.newFoundDocument(r,i,s);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function Nn(e,t){let n;if(t instanceof Nt)n={update:kn(e,t.key,t.value)};else if(t instanceof Pt)n={delete:bn(e,t.key)};else if(t instanceof Ot)n={update:kn(e,t.key,t.data),updateMask:qn(t.fieldMask)};else{if(!(t instanceof Lt))return y();n={verify:bn(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof ht)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof lt)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof ft)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof mt)return{fieldPath:t.field.canonicalString(),increment:n.C};throw y()}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:gn(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:y()}(e,t.precondition)),n}function On(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?bt.updateTime(yn(e.updateTime)):void 0!==e.exists?bt.exists(e.exists):bt.none()}(t.currentDocument):bt.none(),r=t.updateTransforms?t.updateTransforms.map(t=>function(e,t){let n=null;if("setToServerValue"in t)v("REQUEST_TIME"===t.setToServerValue),n=new ht;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new lt(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new ft(e)}else"increment"in t?n=new mt(e,t.increment):y();const r=K.fromServerFormat(t.fieldPath);return new vt(r,n)}(e,t)):[];if(t.update){t.update.name;const i=In(e,t.update.name),s=new ye({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new G(t.map(e=>K.fromServerFormat(e)))}(t.updateMask);return new Ot(i,s,e,n,r)}return new Nt(i,s,n,r)}if(t.delete){const r=In(e,t.delete);return new Pt(r,n)}if(t.verify){const r=In(e,t.verify);return new Lt(r,n)}return y()}function Cn(e,t){return{documents:[_n(e,t.path)]}}function Dn(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=_n(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=_n(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0===e.length)return;const t=e.map(e=>function(e){if("=="===e.op){if(pe(e.value))return{unaryFilter:{field:Fn(e.field),op:"IS_NAN"}};if(fe(e.value))return{unaryFilter:{field:Fn(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(pe(e.value))return{unaryFilter:{field:Fn(e.field),op:"IS_NOT_NAN"}};if(fe(e.value))return{unaryFilter:{field:Fn(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fn(e.field),op:Mn(e.op),value:e.value}}}(e));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:Fn(e.field),direction:xn(e.dir)}}(e))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(e,t){return e.D||ee(t)?t:{value:t}}(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=Pn(t.startAt)),t.endAt&&(n.structuredQuery.endAt=Pn(t.endAt)),n}function Rn(e){let t=Tn(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){v(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function e(t){return t?void 0!==t.unaryFilter?[Vn(t)]:void 0!==t.fieldFilter?[jn(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(t=>e(t)).reduce((e,t)=>e.concat(t)):y():[]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(e=>function(e){return new Me(Un(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,ee(t)?null:t}(n.limit));let c=null;n.startAt&&(c=Ln(n.startAt));let u=null;return n.endAt&&(u=Ln(n.endAt)),qe(t,i,o,s,a,"F",c,u)}function Pn(e){return{before:e.before,values:e.position}}function Ln(e){const t=!!e.before,n=e.values||[];return new Le(n,t)}function xn(e){return ln[e]}function Mn(e){return dn[e]}function Fn(e){return{fieldPath:e.canonicalString()}}function Un(e){return K.fromServerFormat(e.fieldPath)}function jn(e){return Se.create(Un(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return y()}}(e.fieldFilter.op),e.fieldFilter.value)}function Vn(e){switch(e.unaryFilter.op){case"IS_NAN":Un(e.unaryFilter.field);return Se.create(r._removeServiceInstance,"==",{doubleValue:NaN});case"IS_NULL":Un(e.unaryFilter.field);return Se.create(r._registerComponent,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":Un(e.unaryFilter.field);return Se.create(r.registerVersion,"!=",{doubleValue:NaN});case"IS_NOT_NULL":Un(e.unaryFilter.field);return Se.create(r.SDK_VERSION,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return y()}}function qn(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Bn(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function zn(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Gn(t)),t=Kn(e.get(n),t);return Gn(t)}function Kn(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=t}}return n}function Gn(e){return e+"\x01\x01"}function Hn(e){const t=e.length;if(v(t>=2),2===t)return v("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),B.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("\x01",s);switch((t<0||t>n)&&y(),e.charAt(t+1)){case"\x01":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"\x10":i+=e.substring(s,t),i+="\0";break;case"\x11":i+=e.substring(s,t+1);break;default:y()}s=t+2}return new B(r)}class Wn{constructor(e,t){this.seconds=e,this.nanoseconds=t}}class $n{constructor(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n}}$n.store="owner",$n.key="owner";class Qn{constructor(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n}}Qn.store="mutationQueues",Qn.keyPath="userId";class Jn{constructor(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}}Jn.store="mutations",Jn.keyPath="batchId",Jn.userMutationsIndex="userMutationsIndex",Jn.userMutationsKeyPath=["userId","batchId"];class Yn{constructor(){}static prefixForUser(e){return[e]}static prefixForPath(e,t){return[e,zn(t)]}static key(e,t,n){return[e,zn(t),n]}}Yn.store="documentMutations",Yn.PLACEHOLDER=new Yn;class Xn{constructor(e,t){this.path=e,this.readTime=t}}class Zn{constructor(e,t){this.path=e,this.version=t}}class er{constructor(e,t,n,r,i,s){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=s}}er.store="remoteDocuments",er.readTimeIndex="readTimeIndex",er.readTimeIndexPath="readTime",er.collectionReadTimeIndex="collectionReadTimeIndex",er.collectionReadTimeIndexPath=["parentPath","readTime"];class tr{constructor(e){this.byteSize=e}}tr.store="remoteDocumentGlobal",tr.key="remoteDocumentGlobalKey";class nr{constructor(e,t,n,r,i,s,o){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=s,this.query=o}}nr.store="targets",nr.keyPath="targetId",nr.queryTargetsIndexName="queryTargetsIndex",nr.queryTargetsKeyPath=["canonicalId","targetId"];class rr{constructor(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n}}rr.store="targetDocuments",rr.keyPath=["targetId","path"],rr.documentTargetsIndex="documentTargetsIndex",rr.documentTargetsKeyPath=["path","targetId"];class ir{constructor(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r}}ir.key="targetGlobalKey",ir.store="targetGlobal";class sr{constructor(e,t){this.collectionId=e,this.parent=t}}sr.store="collectionParents",sr.keyPath=["collectionId","parent"];class or{constructor(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r}}or.store="clientMetadata",or.keyPath="clientId";class ar{constructor(e,t,n){this.bundleId=e,this.createTime=t,this.version=n}}ar.store="bundles",ar.keyPath="bundleId";class cr{constructor(e,t,n){this.name=e,this.readTime=t,this.bundledQuery=n}}cr.store="namedQueries",cr.keyPath="name";const ur=[Qn.store,Jn.store,Yn.store,er.store,nr.store,$n.store,ir.store,rr.store,or.store,tr.store,sr.store,ar.store,cr.store],hr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lr{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}class dr{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&y(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new dr((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof dr?t:dr.resolve(t)}catch(e){return dr.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):dr.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):dr.reject(t)}static resolve(e){return new dr((t,n)=>{t(e)})}static reject(e){return new dr((t,n)=>{n(e)})}static waitFor(e){return new dr((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=dr.resolve(!1);for(const n of e)t=t.next(e=>e?dr.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}}class fr{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.Tt=new T,this.transaction.oncomplete=()=>{this.Tt.resolve()},this.transaction.onabort=()=>{t.error?this.Tt.reject(new gr(e,t.error)):this.Tt.resolve()},this.transaction.onerror=t=>{const n=Ir(t.target.error);this.Tt.reject(new gr(e,n))}}static open(e,t,n,r){try{return new fr(t,e.transaction(r,n))}catch(e){throw new gr(t,e)}}get It(){return this.Tt.promise}abort(e){e&&this.Tt.reject(e),this.aborted||(f("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}store(e){const t=this.transaction.objectStore(e);return new vr(t)}}class pr{constructor(e,t,n){this.name=e,this.version=t,this.At=n,12.2===pr.Rt(Object(o.l)())&&p("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return f("SimpleDb","Removing database:",e),wr(window.indexedDB.deleteDatabase(e)).toPromise()}static bt(){if("undefined"==typeof indexedDB)return!1;if(pr.Pt())return!0;const e=Object(o.l)(),t=pr.Rt(e),n=0<t&&t<10,r=pr.vt(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static Pt(){var t;return"undefined"!=typeof e&&"YES"===(null===(t=e.env)||void 0===t?void 0:t.Vt)}static St(e,t){return e.store(t)}static Rt(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static vt(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async Dt(e){return this.db||(f("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new gr(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new _(I.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new _(I.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new gr(e,r))},r.onupgradeneeded=e=>{f("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.At.Ct(t,r.transaction,e.oldVersion,this.version).next(()=>{f("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.Nt&&(this.db.onversionchange=e=>this.Nt(e)),this.db}xt(e){this.Nt=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.Dt(e);const t=fr.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).catch(e=>(t.abort(e),dr.reject(e))).toPromise();return s.catch(()=>{}),await t.It,s}catch(e){const t="FirebaseError"!==e.name&&s<3;if(f("SimpleDb","Transaction failed with error:",e.message,"Retrying:",t),this.close(),!t)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class mr{constructor(e){this.kt=e,this.$t=!1,this.Ot=null}get isDone(){return this.$t}get Ft(){return this.Ot}set cursor(e){this.kt=e}done(){this.$t=!0}Mt(e){this.Ot=e}delete(){return wr(this.kt.delete())}}class gr extends _{constructor(e,t){super(I.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function yr(e){return"IndexedDbTransactionError"===e.name}class vr{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(f("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(f("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),wr(n)}add(e){return f("SimpleDb","ADD",this.store.name,e,e),wr(this.store.add(e))}get(e){return wr(this.store.get(e)).next(t=>(void 0===t&&(t=null),f("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return f("SimpleDb","DELETE",this.store.name,e),wr(this.store.delete(e))}count(){return f("SimpleDb","COUNT",this.store.name),wr(this.store.count())}Lt(e,t){const n=this.cursor(this.options(e,t)),r=[];return this.Bt(n,(e,t)=>{r.push(t)}).next(()=>r)}Ut(e,t){f("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.qt=!1;const r=this.cursor(n);return this.Bt(r,(e,t,n)=>n.delete())}Kt(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.Bt(r,t)}jt(e){const t=this.cursor({});return new dr((n,r)=>{t.onerror=e=>{const t=Ir(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next(e=>{e?r.continue():n()}):n()}})}Bt(e,t){const n=[];return new dr((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new mr(i),o=t(i.primaryKey,i.value,s);if(o instanceof dr){const e=o.catch(e=>(s.done(),dr.reject(e)));n.push(e)}s.isDone?r():null===s.Ft?i.continue():i.continue(s.Ft)}}).next(()=>dr.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.qt?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function wr(e){return new dr((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=Ir(e.target.error);n(t)}})}let br=!1;function Ir(e){const t=pr.Rt(Object(o.l)());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new _("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return br||(br=!0,setTimeout(()=>{throw e},0)),e}}return e}class _r extends lr{constructor(e,t){super(),this.Qt=e,this.currentSequenceNumber=t}}function Tr(e,t){const n=b(e);return pr.St(n.Qt,t)}class Er{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Tt(t,e,n[r])}}applyToLocalView(e){for(const t of this.baseMutations)t.key.isEqual(e.key)&&Et(t,e,this.localWriteTime);for(const t of this.mutations)t.key.isEqual(e.key)&&Et(t,e,this.localWriteTime)}applyToLocalDocumentSet(e){this.mutations.forEach(t=>{const n=e.get(t.key),r=n;this.applyToLocalView(r),n.isValidDocument()||r.convertToNoDocument(F.min())})}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Xt())}isEqual(e){return this.batchId===e.batchId&&L(this.mutations,e.mutations,(e,t)=>kt(e,t))&&L(this.baseMutations,e.baseMutations,(e,t)=>kt(e,t))}}class Sr{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){v(e.mutations.length===n.length);let r=Jt();const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new Sr(e,t,n,r)}}class kr{constructor(e,t,n,r,i=F.min(),s=F.min(),o=W.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(e){return new kr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new kr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new kr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Ar{constructor(e){this.Wt=e}}function Nr(e,t){if(t.document)return An(e.Wt,t.document,!!t.hasCommittedMutations);if(t.noDocument){const e=re.fromSegments(t.noDocument.path),n=Pr(t.noDocument.readTime),r=we.newNoDocument(e,n);return t.hasCommittedMutations?r.setHasCommittedMutations():r}if(t.unknownDocument){const e=re.fromSegments(t.unknownDocument.path),n=Pr(t.unknownDocument.version);return we.newUnknownDocument(e,n)}return y()}function Or(e,t,n){const r=Cr(n),i=t.key.path.popLast().toArray();if(t.isFoundDocument()){const n=function(e,t){return{name:bn(e,t.key),fields:t.data.value.mapValue.fields,updateTime:pn(e,t.version.toTimestamp())}}(e.Wt,t),s=t.hasCommittedMutations;return new er(null,null,n,s,r,i)}if(t.isNoDocument()){const e=t.key.path.toArray(),n=Rr(t.version),s=t.hasCommittedMutations;return new er(null,new Xn(e,n),null,s,r,i)}if(t.isUnknownDocument()){const e=t.key.path.toArray(),n=Rr(t.version);return new er(new Zn(e,n),null,null,!0,r,i)}return y()}function Cr(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Dr(e){const t=new M(e[0],e[1]);return F.fromTimestamp(t)}function Rr(e){const t=e.toTimestamp();return new Wn(t.seconds,t.nanoseconds)}function Pr(e){const t=new M(e.seconds,e.nanoseconds);return F.fromTimestamp(t)}function Lr(e,t){const n=(t.baseMutations||[]).map(t=>On(e.Wt,t));for(let s=0;s<t.mutations.length-1;++s){const e=t.mutations[s];if(s+1<t.mutations.length&&void 0!==t.mutations[s+1].transform){const n=t.mutations[s+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}const r=t.mutations.map(t=>On(e.Wt,t)),i=M.fromMillis(t.localWriteTimeMs);return new Er(t.batchId,i,n,r)}function xr(e){const t=Pr(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Pr(e.lastLimboFreeSnapshotVersion):F.min();let r;var i;return void 0!==e.query.documents?(v(1===(i=e.query).documents.length),r=Qe(Be(Tn(i.documents[0])))):r=function(e){return Qe(Rn(e))}(e.query),new kr(r,e.targetId,0,e.lastListenSequenceNumber,t,n,W.fromBase64String(e.resumeToken))}function Mr(e,t){const n=Rr(t.snapshotVersion),r=Rr(t.lastLimboFreeSnapshotVersion);let i;i=Ee(t.target)?Cn(e.Wt,t.target):Dn(e.Wt,t.target);const s=t.resumeToken.toBase64();return new nr(t.targetId,_e(t.target),n,s,t.sequenceNumber,r,i)}function Fr(e){const t=Rn({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Je(t,t.limit,"L"):t}class Ur{getBundleMetadata(e,t){return jr(e).get(t).next(e=>{if(e)return{id:(t=e).bundleId,createTime:Pr(t.createTime),version:t.version};var t})}saveBundleMetadata(e,t){return jr(e).put({bundleId:(n=t).id,createTime:Rr(yn(n.createTime)),version:n.version});var n}getNamedQuery(e,t){return Vr(e).get(t).next(e=>{if(e)return{name:(t=e).name,query:Fr(t.bundledQuery),readTime:Pr(t.readTime)};var t})}saveNamedQuery(e,t){return Vr(e).put(function(e){return{name:e.name,readTime:Rr(yn(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function jr(e){return Tr(e,ar.store)}function Vr(e){return Tr(e,cr.store)}class qr{constructor(){this.Gt=new Br}addToCollectionParentIndex(e,t){return this.Gt.add(t),dr.resolve()}getCollectionParents(e,t){return dr.resolve(this.Gt.getEntries(t))}}class Br{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new zt(B.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new zt(B.comparator)).toArray()}}class zr{constructor(){this.zt=new Br}addToCollectionParentIndex(e,t){if(!this.zt.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.zt.add(t)});const i={collectionId:n,parent:zn(r)};return Kr(e).put(i)}return dr.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[x(t),""],!1,!0);return Kr(e).Lt(r).next(e=>{for(const r of e){if(r.collectionId!==t)break;n.push(Hn(r.parent))}return n})}}function Kr(e){return Tr(e,sr.store)}const Gr={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Hr{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Hr(e,Hr.DEFAULT_COLLECTION_PERCENTILE,Hr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Wr(e,t,n){const r=e.store(Jn.store),i=e.store(Yn.store),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.Kt({range:o},(e,t,n)=>(a++,n.delete()));s.push(c.next(()=>{v(1===a)}));const u=[];for(const h of n.mutations){const e=Yn.key(t,h.key.path,n.batchId);s.push(i.delete(e)),u.push(h.key)}return dr.waitFor(s).next(()=>u)}function $r(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw y();t=e.noDocument}return JSON.stringify(t).length}Hr.DEFAULT_COLLECTION_PERCENTILE=10,Hr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Hr.DEFAULT=new Hr(41943040,Hr.DEFAULT_COLLECTION_PERCENTILE,Hr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Hr.DISABLED=new Hr(-1,0,0);class Qr{constructor(e,t,n,r){this.userId=e,this.N=t,this.Ht=n,this.referenceDelegate=r,this.Jt={}}static Yt(e,t,n,r){v(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new Qr(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Yr(e).Kt({index:Jn.userMutationsIndex,range:n},(e,n,r)=>{t=!1,r.done()}).next(()=>t)}addMutationBatch(e,t,n,r){const i=Xr(e),s=Yr(e);return s.add({}).next(o=>{v("number"==typeof o);const a=new Er(o,t,n,r),c=function(e,t,n){const r=n.baseMutations.map(t=>Nn(e.Wt,t)),i=n.mutations.map(t=>Nn(e.Wt,t));return new Jn(t,n.batchId,n.localWriteTime.toMillis(),r,i)}(this.N,this.userId,a),u=[];let h=new zt((e,t)=>P(e.canonicalString(),t.canonicalString()));for(const e of r){const t=Yn.key(this.userId,e.key.path,o);h=h.add(e.key.path.popLast()),u.push(s.put(c)),u.push(i.put(t,Yn.PLACEHOLDER))}return h.forEach(t=>{u.push(this.Ht.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.Jt[o]=a.keys()}),dr.waitFor(u).next(()=>a)})}lookupMutationBatch(e,t){return Yr(e).get(t).next(e=>e?(v(e.userId===this.userId),Lr(this.N,e)):null)}Xt(e,t){return this.Jt[t]?dr.resolve(this.Jt[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){const n=e.keys();return this.Jt[t]=n,n}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return Yr(e).Kt({index:Jn.userMutationsIndex,range:r},(e,t,r)=>{t.userId===this.userId&&(v(t.batchId>=n),i=Lr(this.N,t)),r.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return Yr(e).Kt({index:Jn.userMutationsIndex,range:t,reverse:!0},(e,t,r)=>{n=t.batchId,r.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Yr(e).Lt(Jn.userMutationsIndex,t).next(e=>e.map(e=>Lr(this.N,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Yn.prefixForPath(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return Xr(e).Kt({range:r},(n,r,s)=>{const[o,a,c]=n,u=Hn(a);if(o===this.userId&&t.path.isEqual(u))return Yr(e).get(c).next(e=>{if(!e)throw y();v(e.userId===this.userId),i.push(Lr(this.N,e))});s.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new zt(P);const r=[];return t.forEach(t=>{const i=Yn.prefixForPath(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=Xr(e).Kt({range:s},(e,r,i)=>{const[s,o,a]=e,c=Hn(o);s===this.userId&&t.path.isEqual(c)?n=n.add(a):i.done()});r.push(o)}),dr.waitFor(r).next(()=>this.Zt(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=Yn.prefixForPath(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new zt(P);return Xr(e).Kt({range:s},(e,t,i)=>{const[s,a,c]=e,u=Hn(a);s===this.userId&&n.isPrefixOf(u)?u.length===r&&(o=o.add(c)):i.done()}).next(()=>this.Zt(e,o))}Zt(e,t){const n=[],r=[];return t.forEach(t=>{r.push(Yr(e).get(t).next(e=>{if(null===e)throw y();v(e.userId===this.userId),n.push(Lr(this.N,e))}))}),dr.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return Wr(e.Qt,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.te(t.batchId)}),dr.forEach(n,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}te(e){delete this.Jt[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return dr.resolve();const n=IDBKeyRange.lowerBound(Yn.prefixForUser(this.userId)),r=[];return Xr(e).Kt({range:n},(e,t,n)=>{if(e[0]===this.userId){const t=Hn(e[1]);r.push(t)}else n.done()}).next(()=>{v(0===r.length)})})}containsKey(e,t){return Jr(e,this.userId,t)}ee(e){return Zr(e).get(this.userId).next(e=>e||new Qn(this.userId,-1,""))}}function Jr(e,t,n){const r=Yn.prefixForPath(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Xr(e).Kt({range:s,qt:!0},(e,n,r)=>{const[s,a,c]=e;s===t&&a===i&&(o=!0),r.done()}).next(()=>o)}function Yr(e){return Tr(e,Jn.store)}function Xr(e){return Tr(e,Yn.store)}function Zr(e){return Tr(e,Qn.store)}class ei{constructor(e){this.ne=e}next(){return this.ne+=2,this.ne}static se(){return new ei(0)}static ie(){return new ei(-1)}}class ti{constructor(e,t){this.referenceDelegate=e,this.N=t}allocateTargetId(e){return this.re(e).next(t=>{const n=new ei(t.highestTargetId);return t.highestTargetId=n.next(),this.oe(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.re(e).next(e=>F.fromTimestamp(new M(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.re(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.re(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.oe(e,r)))}addTargetData(e,t){return this.ae(e,t).next(()=>this.re(e).next(n=>(n.targetCount+=1,this.ce(t,n),this.oe(e,n))))}updateTargetData(e,t){return this.ae(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ni(e).delete(t.targetId)).next(()=>this.re(e)).next(t=>(v(t.targetCount>0),t.targetCount-=1,this.oe(e,t)))}removeTargets(e,t,n){let r=0;const i=[];return ni(e).Kt((s,o)=>{const a=xr(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))}).next(()=>dr.waitFor(i)).next(()=>r)}forEachTarget(e,t){return ni(e).Kt((e,n)=>{const r=xr(n);t(r)})}re(e){return ri(e).get(ir.key).next(e=>(v(null!==e),e))}oe(e,t){return ri(e).put(ir.key,t)}ae(e,t){return ni(e).put(Mr(this.N,t))}ce(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.re(e).next(e=>e.targetCount)}getTargetData(e,t){const n=_e(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return ni(e).Kt({range:r,index:nr.queryTargetsIndexName},(e,n,r)=>{const s=xr(n);Te(t,s.target)&&(i=s,r.done())}).next(()=>i)}addMatchingKeys(e,t,n){const r=[],i=ii(e);return t.forEach(t=>{const s=zn(t.path);r.push(i.put(new rr(n,s))),r.push(this.referenceDelegate.addReference(e,n,t))}),dr.waitFor(r)}removeMatchingKeys(e,t,n){const r=ii(e);return dr.forEach(t,t=>{const i=zn(t.path);return dr.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])})}removeMatchingKeysForTargetId(e,t){const n=ii(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=ii(e);let i=Xt();return r.Kt({range:n,qt:!0},(e,t,n)=>{const r=Hn(e[1]),s=new re(r);i=i.add(s)}).next(()=>i)}containsKey(e,t){const n=zn(t.path),r=IDBKeyRange.bound([n],[x(n)],!1,!0);let i=0;return ii(e).Kt({index:rr.documentTargetsIndex,qt:!0,range:r},([e,t],n,r)=>{0!==e&&(i++,r.done())}).next(()=>i>0)}Et(e,t){return ni(e).get(t).next(e=>e?xr(e):null)}}function ni(e){return Tr(e,nr.store)}function ri(e){return Tr(e,ir.store)}function ii(e){return Tr(e,rr.store)}async function si(e){if(e.code!==I.FAILED_PRECONDITION||e.message!==hr)throw e;f("LocalStore","Unexpectedly lost primary lease")}function oi([e,t],[n,r]){const i=P(e,n);return 0===i?P(t,r):i}class ai{constructor(e){this.ue=e,this.buffer=new zt(oi),this.he=0}le(){return++this.he}fe(e){const t=[e,this.le()];if(this.buffer.size<this.ue)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();oi(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ci{constructor(e,t){this.garbageCollector=e,this.asyncQueue=t,this.de=!1,this.we=null}start(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this._e(e)}stop(){this.we&&(this.we.cancel(),this.we=null)}get started(){return null!==this.we}_e(e){const t=this.de?3e5:6e4;f("LruGarbageCollector",`Garbage collection scheduled in ${t}ms`),this.we=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.we=null,this.de=!0;try{await e.collectGarbage(this.garbageCollector)}catch(e){yr(e)?f("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await si(e)}await this._e(e)})}}class ui{constructor(e,t){this.me=e,this.params=t}calculateTargetCount(e,t){return this.me.ge(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return dr.resolve(C.T);const n=new ai(t);return this.me.forEachTarget(e,e=>n.fe(e.sequenceNumber)).next(()=>this.me.ye(e,e=>n.fe(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.me.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.me.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(f("LruGarbageCollector","Garbage collection skipped; disabled"),dr.resolve(Gr)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(f("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Gr):this.pe(e,t))}getCacheSize(e){return this.me.getCacheSize(e)}pe(e,t){let n,r,i,o,a,c,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(f("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,o=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,a=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(u=Date.now(),l()<=s.a.DEBUG&&f("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-h}ms\n\tDetermined least recently used ${r} in `+(a-o)+"ms\n"+`\tRemoved ${i} targets in `+(c-a)+"ms\n"+`\tRemoved ${e} documents in `+(u-c)+"ms\n"+`Total Duration: ${u-h}ms`),dr.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}class hi{constructor(e,t){this.db=e,this.garbageCollector=function(e,t){return new ui(e,t)}(this,t)}ge(e){const t=this.Ee(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}Ee(e){let t=0;return this.ye(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}ye(e,t){return this.Te(e,(e,n)=>t(n))}addReference(e,t,n){return li(e,n)}removeReference(e,t,n){return li(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return li(e,t)}Ie(e,t){return function(e,t){let n=!1;return Zr(e).jt(r=>Jr(e,r,t).next(e=>(e&&(n=!0),dr.resolve(!e)))).next(()=>n)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Te(e,(s,o)=>{if(o<=t){const t=this.Ie(e,s).next(t=>{if(!t)return i++,n.getEntry(e,s).next(()=>(n.removeEntry(s),ii(e).delete([0,zn(s.path)])))});r.push(t)}}).next(()=>dr.waitFor(r)).next(()=>n.apply(e)).next(()=>i)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return li(e,t)}Te(e,t){const n=ii(e);let r,i=C.T;return n.Kt({index:rr.documentTargetsIndex},([e,n],{path:s,sequenceNumber:o})=>{0===e?(i!==C.T&&t(new re(Hn(r)),i),i=o,r=s):i=C.T}).next(()=>{i!==C.T&&t(new re(Hn(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function li(e,t){return ii(e).put(function(e,t){return new rr(0,zn(e.path),t)}(t,e.currentSequenceNumber))}class di{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1}forEach(e){j(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return V(this.inner)}}class fi{constructor(){this.changes=new di(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}getReadTime(e){const t=this.changes.get(e);return t?t.readTime:F.min()}addEntry(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})}removeEntry(e,t=null){this.assertNotApplied(),this.changes.set(e,{document:we.newInvalidDocument(e),readTime:t})}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?dr.resolve(n.document):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class pi{constructor(e,t){this.N=e,this.Ht=t}addEntry(e,t,n){return yi(e).put(vi(t),n)}removeEntry(e,t){const n=yi(e),r=vi(t);return n.delete(r)}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.Ae(e,n)))}getEntry(e,t){return yi(e).get(vi(t)).next(e=>this.Re(t,e))}be(e,t){return yi(e).get(vi(t)).next(e=>({document:this.Re(t,e),size:$r(e)}))}getEntries(e,t){let n=Ht();return this.Pe(e,t,(e,t)=>{const r=this.Re(e,t);n=n.insert(e,r)}).next(()=>n)}ve(e,t){let n=Ht(),r=new Vt(re.comparator);return this.Pe(e,t,(e,t)=>{const i=this.Re(e,t);n=n.insert(e,i),r=r.insert(e,$r(t))}).next(()=>({documents:n,Ve:r}))}Pe(e,t,n){if(t.isEmpty())return dr.resolve();const r=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),i=t.getIterator();let s=i.getNext();return yi(e).Kt({range:r},(e,t,r)=>{const o=re.fromSegments(e);for(;s&&re.comparator(s,o)<0;)n(s,null),s=i.getNext();s&&s.isEqual(o)&&(n(s,t),s=i.hasNext()?i.getNext():null),s?r.Mt(s.path.toArray()):r.done()}).next(()=>{for(;s;)n(s,null),s=i.hasNext()?i.getNext():null})}getDocumentsMatchingQuery(e,t,n){let r=Ht();const i=t.path.length+1,s={};if(n.isEqual(F.min())){const e=t.path.toArray();s.range=IDBKeyRange.lowerBound(e)}else{const e=t.path.toArray(),r=Cr(n);s.range=IDBKeyRange.lowerBound([e,r],!0),s.index=er.collectionReadTimeIndex}return yi(e).Kt(s,(e,n,s)=>{if(e.length!==i)return;const o=Nr(this.N,n);t.path.isPrefixOf(o.key.path)?et(t,o)&&(r=r.insert(o.key,o)):s.done()}).next(()=>r)}newChangeBuffer(e){return new mi(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return gi(e).get(tr.key).next(e=>(v(!!e),e))}Ae(e,t){return gi(e).put(tr.key,t)}Re(e,t){if(t){const e=Nr(this.N,t);if(!e.isNoDocument()||!e.version.isEqual(F.min()))return e}return we.newInvalidDocument(e)}}class mi extends fi{constructor(e,t){super(),this.Se=e,this.trackRemovals=t,this.De=new di(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){const t=[];let n=0,r=new zt((e,t)=>P(e.canonicalString(),t.canonicalString()));return this.changes.forEach((i,s)=>{const o=this.De.get(i);if(s.document.isValidDocument()){const a=Or(this.Se.N,s.document,this.getReadTime(i));r=r.add(i.path.popLast());const c=$r(a);n+=c-o,t.push(this.Se.addEntry(e,i,a))}else if(n-=o,this.trackRemovals){const n=Or(this.Se.N,we.newNoDocument(i,F.min()),this.getReadTime(i));t.push(this.Se.addEntry(e,i,n))}else t.push(this.Se.removeEntry(e,i))}),r.forEach(n=>{t.push(this.Se.Ht.addToCollectionParentIndex(e,n))}),t.push(this.Se.updateMetadata(e,n)),dr.waitFor(t)}getFromCache(e,t){return this.Se.be(e,t).next(e=>(this.De.set(t,e.size),e.document))}getAllFromCache(e,t){return this.Se.ve(e,t).next(({documents:e,Ve:t})=>(t.forEach((e,t)=>{this.De.set(e,t)}),e))}}function gi(e){return Tr(e,tr.store)}function yi(e){return Tr(e,er.store)}function vi(e){return e.path.toArray()}class wi{constructor(e){this.N=e}Ct(e,t,n,r){v(n<r&&n>=0&&r<=11);const i=new fr("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore($n.store)}(e),function(e){e.createObjectStore(Qn.store,{keyPath:Qn.keyPath}),e.createObjectStore(Jn.store,{keyPath:Jn.keyPath,autoIncrement:!0}).createIndex(Jn.userMutationsIndex,Jn.userMutationsKeyPath,{unique:!0}),e.createObjectStore(Yn.store)}(e),bi(e),function(e){e.createObjectStore(er.store)}(e));let s=dr.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(rr.store),e.deleteObjectStore(nr.store),e.deleteObjectStore(ir.store)}(e),bi(e)),s=s.next(()=>function(e){const t=e.store(ir.store),n=new ir(0,0,F.min().toTimestamp(),0);return t.put(ir.key,n)}(i))),n<4&&r>=4&&(0!==n&&(s=s.next(()=>function(e,t){return t.store(Jn.store).Lt().next(n=>{e.deleteObjectStore(Jn.store),e.createObjectStore(Jn.store,{keyPath:Jn.keyPath,autoIncrement:!0}).createIndex(Jn.userMutationsIndex,Jn.userMutationsKeyPath,{unique:!0});const r=t.store(Jn.store),i=n.map(e=>r.put(e));return dr.waitFor(i)})}(e,i))),s=s.next(()=>{!function(e){e.createObjectStore(or.store,{keyPath:or.keyPath})}(e)})),n<5&&r>=5&&(s=s.next(()=>this.Ce(i))),n<6&&r>=6&&(s=s.next(()=>(function(e){e.createObjectStore(tr.store)}(e),this.Ne(i)))),n<7&&r>=7&&(s=s.next(()=>this.xe(i))),n<8&&r>=8&&(s=s.next(()=>this.ke(e,i))),n<9&&r>=9&&(s=s.next(()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e),function(e){const t=e.objectStore(er.store);t.createIndex(er.readTimeIndex,er.readTimeIndexPath,{unique:!1}),t.createIndex(er.collectionReadTimeIndex,er.collectionReadTimeIndexPath,{unique:!1})}(t)})),n<10&&r>=10&&(s=s.next(()=>this.$e(i))),n<11&&r>=11&&(s=s.next(()=>{!function(e){e.createObjectStore(ar.store,{keyPath:ar.keyPath})}(e),function(e){e.createObjectStore(cr.store,{keyPath:cr.keyPath})}(e)})),s}Ne(e){let t=0;return e.store(er.store).Kt((e,n)=>{t+=$r(n)}).next(()=>{const n=new tr(t);return e.store(tr.store).put(tr.key,n)})}Ce(e){const t=e.store(Qn.store),n=e.store(Jn.store);return t.Lt().next(t=>dr.forEach(t,t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.Lt(Jn.userMutationsIndex,r).next(n=>dr.forEach(n,n=>{v(n.userId===t.userId);const r=Lr(this.N,n);return Wr(e,t.userId,r).next(()=>{})}))}))}xe(e){const t=e.store(rr.store),n=e.store(er.store);return e.store(ir.store).get(ir.key).next(e=>{const r=[];return n.Kt((n,i)=>{const s=new B(n),o=function(e){return[0,zn(e)]}(s);r.push(t.get(o).next(n=>n?dr.resolve():(n=>t.put(new rr(0,zn(n),e.highestListenSequenceNumber)))(s)))}).next(()=>dr.waitFor(r))})}ke(e,t){e.createObjectStore(sr.store,{keyPath:sr.keyPath});const n=t.store(sr.store),r=new Br,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:zn(r)})}};return t.store(er.store).Kt({qt:!0},(e,t)=>{const n=new B(e);return i(n.popLast())}).next(()=>t.store(Yn.store).Kt({qt:!0},([e,t,n],r)=>{const s=Hn(t);return i(s.popLast())}))}$e(e){const t=e.store(nr.store);return t.Kt((e,n)=>{const r=xr(n),i=Mr(this.N,r);return t.put(i)})}}function bi(e){e.createObjectStore(rr.store,{keyPath:rr.keyPath}).createIndex(rr.documentTargetsIndex,rr.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(nr.store,{keyPath:nr.keyPath}).createIndex(nr.queryTargetsIndexName,nr.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(ir.store)}const Ii="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class _i{constructor(e,t,n,r,i,s,o,a,c,u){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Oe=i,this.window=s,this.document=o,this.Fe=c,this.Me=u,this.Le=null,this.Be=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ue=null,this.inForeground=!1,this.qe=null,this.Ke=null,this.je=Number.NEGATIVE_INFINITY,this.Qe=e=>Promise.resolve(),!_i.bt())throw new _(I.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new hi(this,r),this.We=t+"main",this.N=new Ar(a),this.Ge=new pr(this.We,11,new wi(this.N)),this.ze=new ti(this.referenceDelegate,this.N),this.Ht=new zr,this.He=function(e,t){return new pi(e,t)}(this.N,this.Ht),this.Je=new Ur,this.window&&this.window.localStorage?this.Ye=this.window.localStorage:(this.Ye=null,!1===u&&p("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Xe().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new _(I.FAILED_PRECONDITION,Ii);return this.Ze(),this.tn(),this.en(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.ze.getHighestSequenceNumber(e))}).then(e=>{this.Le=new C(e,this.Fe)}).then(()=>{this.Be=!0}).catch(e=>(this.Ge&&this.Ge.close(),Promise.reject(e)))}nn(e){return this.Qe=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ge.xt(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Oe.enqueueAndForget(async()=>{this.started&&await this.Xe()}))}Xe(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ei(e).put(new or(this.clientId,Date.now(),this.networkEnabled,this.inForeground)).next(()=>{if(this.isPrimary)return this.sn(e).next(e=>{e||(this.isPrimary=!1,this.Oe.enqueueRetryable(()=>this.Qe(!1)))})}).next(()=>this.rn(e)).next(t=>this.isPrimary&&!t?this.on(e).next(()=>!1):!!t&&this.an(e).next(()=>!0))).catch(e=>{if(yr(e))return f("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return f("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Oe.enqueueRetryable(()=>this.Qe(e)),this.isPrimary=e})}sn(e){return Ti(e).get($n.key).next(e=>dr.resolve(this.cn(e)))}un(e){return Ei(e).delete(this.clientId)}async hn(){if(this.isPrimary&&!this.ln(this.je,18e5)){this.je=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{const t=Tr(e,or.store);return t.Lt().next(e=>{const n=this.fn(e,18e5),r=e.filter(e=>-1===n.indexOf(e));return dr.forEach(r,e=>t.delete(e.clientId)).next(()=>r)})}).catch(()=>[]);if(this.Ye)for(const t of e)this.Ye.removeItem(this.dn(t.clientId))}}en(){this.Ke=this.Oe.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Xe().then(()=>this.hn()).then(()=>this.en()))}cn(e){return!!e&&e.ownerId===this.clientId}rn(e){return this.Me?dr.resolve(!0):Ti(e).get($n.key).next(t=>{if(null!==t&&this.ln(t.leaseTimestampMs,5e3)&&!this.wn(t.ownerId)){if(this.cn(t)&&this.networkEnabled)return!0;if(!this.cn(t)){if(!t.allowTabSynchronization)throw new _(I.FAILED_PRECONDITION,Ii);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ei(e).Lt().next(e=>void 0===this.fn(e,5e3).find(e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&f("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.Be=!1,this._n(),this.Ke&&(this.Ke.cancel(),this.Ke=null),this.mn(),this.gn(),await this.Ge.runTransaction("shutdown","readwrite",[$n.store,or.store],e=>{const t=new _r(e,C.T);return this.on(t).next(()=>this.un(t))}),this.Ge.close(),this.yn()}fn(e,t){return e.filter(e=>this.ln(e.updateTimeMs,t)&&!this.wn(e.clientId))}pn(){return this.runTransaction("getActiveClients","readonly",e=>Ei(e).Lt().next(e=>this.fn(e,18e5).map(e=>e.clientId)))}get started(){return this.Be}getMutationQueue(e){return Qr.Yt(e,this.N,this.Ht,this.referenceDelegate)}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getIndexManager(){return this.Ht}getBundleCache(){return this.Je}runTransaction(e,t,n){f("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite";let i;return this.Ge.runTransaction(e,r,ur,r=>(i=new _r(r,this.Le?this.Le.next():C.T),"readwrite-primary"===t?this.sn(i).next(e=>!!e||this.rn(i)).next(t=>{if(!t)throw p(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Oe.enqueueRetryable(()=>this.Qe(!1)),new _(I.FAILED_PRECONDITION,hr);return n(i)}).next(e=>this.an(i).next(()=>e)):this.En(i).next(()=>n(i)))).then(e=>(i.raiseOnCommittedEvent(),e))}En(e){return Ti(e).get($n.key).next(e=>{if(null!==e&&this.ln(e.leaseTimestampMs,5e3)&&!this.wn(e.ownerId)&&!this.cn(e)&&!(this.Me||this.allowTabSynchronization&&e.allowTabSynchronization))throw new _(I.FAILED_PRECONDITION,Ii)})}an(e){const t=new $n(this.clientId,this.allowTabSynchronization,Date.now());return Ti(e).put($n.key,t)}static bt(){return pr.bt()}on(e){const t=Ti(e);return t.get($n.key).next(e=>this.cn(e)?(f("IndexedDbPersistence","Releasing primary lease."),t.delete($n.key)):dr.resolve())}ln(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(p(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Ze(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.qe=()=>{this.Oe.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Xe()))},this.document.addEventListener("visibilitychange",this.qe),this.inForeground="visible"===this.document.visibilityState)}mn(){this.qe&&(this.document.removeEventListener("visibilitychange",this.qe),this.qe=null)}tn(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Ue=()=>{this._n(),Object(o.v)()&&navigator.appVersion.match("Version/14")&&this.Oe.enterRestrictedMode(!0),this.Oe.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ue))}gn(){this.Ue&&(this.window.removeEventListener("pagehide",this.Ue),this.Ue=null)}wn(e){var t;try{const n=null!==(null===(t=this.Ye)||void 0===t?void 0:t.getItem(this.dn(e)));return f("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return p("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}_n(){if(this.Ye)try{this.Ye.setItem(this.dn(this.clientId),String(Date.now()))}catch(Ru){p("Failed to set zombie client id.",Ru)}}yn(){if(this.Ye)try{this.Ye.removeItem(this.dn(this.clientId))}catch(Ru){}}dn(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ti(e){return Tr(e,$n.store)}function Ei(e){return Tr(e,or.store)}function Si(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class ki{constructor(e,t){this.progress=e,this.Tn=t}}class Ai{constructor(e,t,n){this.He=e,this.In=t,this.Ht=n}An(e,t){return this.In.getAllMutationBatchesAffectingDocumentKey(e,t).next(n=>this.Rn(e,t,n))}Rn(e,t,n){return this.He.getEntry(e,t).next(e=>{for(const t of n)t.applyToLocalView(e);return e})}bn(e,t){e.forEach((e,n)=>{for(const r of t)r.applyToLocalView(n)})}Pn(e,t){return this.He.getEntries(e,t).next(t=>this.vn(e,t).next(()=>t))}vn(e,t){return this.In.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>this.bn(t,e))}getDocumentsMatchingQuery(e,t,n){return function(e){return re.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.Vn(e,t.path):We(t)?this.Sn(e,t,n):this.Dn(e,t,n)}Vn(e,t){return this.An(e,new re(t)).next(e=>{let t=$t();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}Sn(e,t,n){const r=t.collectionGroup;let i=$t();return this.Ht.getCollectionParents(e,r).next(s=>dr.forEach(s,s=>{const o=function(e,t){return new Ve(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(r));return this.Dn(e,o,n).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}Dn(e,t,n){let r,i;return this.He.getDocumentsMatchingQuery(e,t,n).next(n=>(r=n,this.In.getAllMutationBatchesAffectingQuery(e,t))).next(t=>(i=t,this.Cn(e,i,r).next(e=>{r=e;for(const t of i)for(const e of t.mutations){const n=e.key;let i=r.get(n);null==i&&(i=we.newInvalidDocument(n),r=r.insert(n,i)),Et(e,i,t.localWriteTime),i.isFoundDocument()||(r=r.remove(n))}}))).next(()=>(r.forEach((e,n)=>{et(t,n)||(r=r.remove(e))}),r))}Cn(e,t,n){let r=Xt();for(const s of t)for(const e of s.mutations)e instanceof Ot&&null===n.get(e.key)&&(r=r.add(e.key));let i=n;return this.He.getEntries(e,r).next(e=>(e.forEach((e,t)=>{t.isFoundDocument()&&(i=i.insert(e,t))}),i))}}class Ni{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Nn=n,this.xn=r}static kn(e,t){let n=Xt(),r=Xt();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Ni(e,t.fromCache,n,r)}}class Oi{$n(e){this.On=e}getDocumentsMatchingQuery(e,t,n,r){return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||n.isEqual(F.min())?this.Fn(e,t):this.On.Pn(e,r).next(i=>{const o=this.Mn(t,i);return(ze(t)||Ke(t))&&this.Ln(t.limitType,o,r,n)?this.Fn(e,t):(l()<=s.a.DEBUG&&f("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Ze(t)),this.On.getDocumentsMatchingQuery(e,t,n).next(e=>(o.forEach(t=>{e=e.insert(t.key,t)}),e)))})}Mn(e,t){let n=new zt(tt(e));return t.forEach((t,r)=>{et(e,r)&&(n=n.add(r))}),n}Ln(e,t,n,r){if(n.size!==t.size)return!0;const i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Fn(e,t){return l()<=s.a.DEBUG&&f("QueryEngine","Using full collection scan to execute query:",Ze(t)),this.On.getDocumentsMatchingQuery(e,t,F.min())}}class Ci{constructor(e,t,n,r){this.persistence=e,this.Bn=t,this.N=r,this.Un=new Vt(P),this.qn=new di(e=>_e(e),Te),this.Kn=F.min(),this.In=e.getMutationQueue(n),this.jn=e.getRemoteDocumentCache(),this.ze=e.getTargetCache(),this.Qn=new Ai(this.jn,this.In,this.persistence.getIndexManager()),this.Je=e.getBundleCache(),this.Bn.$n(this.Qn)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Un))}}function Di(e,t,n,r){return new Ci(e,t,n,r)}async function Ri(e,t){const n=b(e);let r=n.In,i=n.Qn;const s=await n.persistence.runTransaction("Handle user change","readonly",e=>{let s;return n.In.getAllMutationBatches(e).next(o=>(s=o,r=n.persistence.getMutationQueue(t),i=new Ai(n.jn,r,n.persistence.getIndexManager()),r.getAllMutationBatches(e))).next(t=>{const n=[],r=[];let o=Xt();for(const e of s){n.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return i.Pn(e,o).next(e=>({Wn:e,removedBatchIds:n,addedBatchIds:r}))})});return n.In=r,n.Qn=i,n.Bn.$n(n.Qn),s}function Pi(e){const t=b(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.ze.getLastRemoteSnapshotVersion(e))}function Li(e,t,n,r,i){let s=Xt();return n.forEach(e=>s=s.add(e)),t.getEntries(e,s).next(e=>{let s=Ht();return n.forEach((n,o)=>{const a=e.get(n),c=(null==i?void 0:i.get(n))||r;o.isNoDocument()&&o.version.isEqual(F.min())?(t.removeEntry(n,c),s=s.insert(n,o)):!a.isValidDocument()||o.version.compareTo(a.version)>0||0===o.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(o,c),s=s.insert(n,o)):f("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",o.version)}),s})}function xi(e,t){const n=b(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.In.getNextMutationBatchAfterBatchId(e,t)))}function Mi(e,t){const n=b(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.ze.getTargetData(e,t).next(i=>i?(r=i,dr.resolve(r)):n.ze.allocateTargetId(e).next(i=>(r=new kr(t,i,0,e.currentSequenceNumber),n.ze.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Un.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Un=n.Un.insert(e.targetId,e),n.qn.set(t,e.targetId)),e})}async function Fi(e,t,n){const r=b(e),i=r.Un.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!yr(e))throw e;f("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.Un=r.Un.remove(t),r.qn.delete(i.target)}function Ui(e,t,n){const r=b(e);let i=F.min(),s=Xt();return r.persistence.runTransaction("Execute query","readonly",e=>function(e,t,n){const r=b(e),i=r.qn.get(n);return void 0!==i?dr.resolve(r.Un.get(i)):r.ze.getTargetData(t,n)}(r,e,Qe(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.ze.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Bn.getDocumentsMatchingQuery(e,t,n?i:F.min(),n?s:Xt())).next(e=>({documents:e,Gn:s})))}function ji(e,t){const n=b(e),r=b(n.ze),i=n.Un.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",e=>r.Et(e,t).next(e=>e?e.target:null))}function Vi(e){const t=b(e);return t.persistence.runTransaction("Get new document changes","readonly",e=>function(e,t,n){const r=b(e);let i=Ht(),s=Cr(n);const o=yi(t),a=IDBKeyRange.lowerBound(s,!0);return o.Kt({index:er.readTimeIndex,range:a},(e,t)=>{const n=Nr(r.N,t);i=i.insert(n.key,n),s=t.readTime}).next(()=>({Tn:i,readTime:Dr(s)}))}(t.jn,e,t.Kn)).then(({Tn:e,readTime:n})=>(t.Kn=n,e))}async function qi(e,t,n=Xt()){const r=await Mi(e,Qe(Fr(t.bundledQuery))),i=b(e);return i.persistence.runTransaction("Save named query","readwrite",e=>{const s=yn(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.Je.saveNamedQuery(e,t);const o=r.withResumeToken(W.EMPTY_BYTE_STRING,s);return i.Un=i.Un.insert(o.targetId,o),i.ze.updateTargetData(e,o).next(()=>i.ze.removeMatchingKeysForTargetId(e,r.targetId)).next(()=>i.ze.addMatchingKeys(e,n,r.targetId)).next(()=>i.Je.saveNamedQuery(e,t))})}class Bi{constructor(e){this.N=e,this.Yn=new Map,this.Xn=new Map}getBundleMetadata(e,t){return dr.resolve(this.Yn.get(t))}saveBundleMetadata(e,t){var n;return this.Yn.set(t.id,{id:(n=t).id,version:n.version,createTime:yn(n.createTime)}),dr.resolve()}getNamedQuery(e,t){return dr.resolve(this.Xn.get(t))}saveNamedQuery(e,t){return this.Xn.set(t.name,function(e){return{name:e.name,query:Fr(e.bundledQuery),readTime:yn(e.readTime)}}(t)),dr.resolve()}}class zi{constructor(){this.Zn=new zt(Ki.ts),this.es=new zt(Ki.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,t){const n=new Ki(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}ss(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.rs(new Ki(e,t))}os(e,t){e.forEach(e=>this.removeReference(e,t))}cs(e){const t=new re(new B([])),n=new Ki(t,e),r=new Ki(t,e+1),i=[];return this.es.forEachInRange([n,r],e=>{this.rs(e),i.push(e.key)}),i}us(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const t=new re(new B([])),n=new Ki(t,e),r=new Ki(t,e+1);let i=Xt();return this.es.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new Ki(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Ki{constructor(e,t){this.key=e,this.ls=t}static ts(e,t){return re.comparator(e.key,t.key)||P(e.ls,t.ls)}static ns(e,t){return P(e.ls,t.ls)||re.comparator(e.key,t.key)}}class Gi{constructor(e,t){this.Ht=e,this.referenceDelegate=t,this.In=[],this.fs=1,this.ds=new zt(Ki.ts)}checkEmpty(e){return dr.resolve(0===this.In.length)}addMutationBatch(e,t,n,r){const i=this.fs;this.fs++,this.In.length>0&&this.In[this.In.length-1];const s=new Er(i,t,n,r);this.In.push(s);for(const o of r)this.ds=this.ds.add(new Ki(o.key,i)),this.Ht.addToCollectionParentIndex(e,o.key.path.popLast());return dr.resolve(s)}lookupMutationBatch(e,t){return dr.resolve(this.ws(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this._s(n),i=r<0?0:r;return dr.resolve(this.In.length>i?this.In[i]:null)}getHighestUnacknowledgedBatchId(){return dr.resolve(0===this.In.length?-1:this.fs-1)}getAllMutationBatches(e){return dr.resolve(this.In.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ki(t,0),r=new Ki(t,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([n,r],e=>{const t=this.ws(e.ls);i.push(t)}),dr.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new zt(P);return t.forEach(e=>{const t=new Ki(e,0),r=new Ki(e,Number.POSITIVE_INFINITY);this.ds.forEachInRange([t,r],e=>{n=n.add(e.ls)})}),dr.resolve(this.gs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;re.isDocumentKey(i)||(i=i.child(""));const s=new Ki(new re(i),0);let o=new zt(P);return this.ds.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ls)),!0)},s),dr.resolve(this.gs(o))}gs(e){const t=[];return e.forEach(e=>{const n=this.ws(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){v(0===this.ys(t.batchId,"removed")),this.In.shift();let n=this.ds;return dr.forEach(t.mutations,r=>{const i=new Ki(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.ds=n})}te(e){}containsKey(e,t){const n=new Ki(t,0),r=this.ds.firstAfterOrEqual(n);return dr.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.In.length,dr.resolve()}ys(e,t){return this._s(e)}_s(e){return 0===this.In.length?0:e-this.In[0].batchId}ws(e){const t=this._s(e);return t<0||t>=this.In.length?null:this.In[t]}}class Hi{constructor(e,t){this.Ht=e,this.ps=t,this.docs=new Vt(re.comparator),this.size=0}addEntry(e,t,n){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ps(t);return this.docs=this.docs.insert(r,{document:t.clone(),size:o,readTime:n}),this.size+=o-s,this.Ht.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return dr.resolve(n?n.document.clone():we.newInvalidDocument(t))}getEntries(e,t){let n=Ht();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.clone():we.newInvalidDocument(e))}),dr.resolve(n)}getDocumentsMatchingQuery(e,t,n){let r=Ht();const i=new re(t.path.child("")),s=this.docs.getIteratorFrom(i);for(;s.hasNext();){const{key:e,value:{document:i,readTime:o}}=s.getNext();if(!t.path.isPrefixOf(e.path))break;o.compareTo(n)<=0||et(t,i)&&(r=r.insert(i.key,i.clone()))}return dr.resolve(r)}Es(e,t){return dr.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Wi(this)}getSize(e){return dr.resolve(this.size)}}class Wi extends fi{constructor(e){super(),this.Se=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.document.isValidDocument()?t.push(this.Se.addEntry(e,r.document,this.getReadTime(n))):this.Se.removeEntry(n)}),dr.waitFor(t)}getFromCache(e,t){return this.Se.getEntry(e,t)}getAllFromCache(e,t){return this.Se.getEntries(e,t)}}class $i{constructor(e){this.persistence=e,this.Ts=new di(e=>_e(e),Te),this.lastRemoteSnapshotVersion=F.min(),this.highestTargetId=0,this.Is=0,this.As=new zi,this.targetCount=0,this.Rs=ei.se()}forEachTarget(e,t){return this.Ts.forEach((e,n)=>t(n)),dr.resolve()}getLastRemoteSnapshotVersion(e){return dr.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return dr.resolve(this.Is)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),dr.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Is&&(this.Is=t),dr.resolve()}ae(e){this.Ts.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Rs=new ei(t),this.highestTargetId=t),e.sequenceNumber>this.Is&&(this.Is=e.sequenceNumber)}addTargetData(e,t){return this.ae(t),this.targetCount+=1,dr.resolve()}updateTargetData(e,t){return this.ae(t),dr.resolve()}removeTargetData(e,t){return this.Ts.delete(t.target),this.As.cs(t.targetId),this.targetCount-=1,dr.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Ts.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Ts.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),dr.waitFor(i).next(()=>r)}getTargetCount(e){return dr.resolve(this.targetCount)}getTargetData(e,t){const n=this.Ts.get(t)||null;return dr.resolve(n)}addMatchingKeys(e,t,n){return this.As.ss(t,n),dr.resolve()}removeMatchingKeys(e,t,n){this.As.os(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),dr.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.As.cs(t),dr.resolve()}getMatchingKeysForTargetId(e,t){const n=this.As.hs(t);return dr.resolve(n)}containsKey(e,t){return dr.resolve(this.As.containsKey(t))}}class Qi{constructor(e,t){this.bs={},this.Le=new C(0),this.Be=!1,this.Be=!0,this.referenceDelegate=e(this),this.ze=new $i(this),this.Ht=new qr,this.He=function(e,t){return new Hi(e,t)}(this.Ht,e=>this.referenceDelegate.Ps(e)),this.N=new Ar(t),this.Je=new Bi(this.N)}start(){return Promise.resolve()}shutdown(){return this.Be=!1,Promise.resolve()}get started(){return this.Be}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Ht}getMutationQueue(e){let t=this.bs[e.toKey()];return t||(t=new Gi(this.Ht,this.referenceDelegate),this.bs[e.toKey()]=t),t}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getBundleCache(){return this.Je}runTransaction(e,t,n){f("MemoryPersistence","Starting transaction:",e);const r=new Ji(this.Le.next());return this.referenceDelegate.vs(),n(r).next(e=>this.referenceDelegate.Vs(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ss(e,t){return dr.or(Object.values(this.bs).map(n=>()=>n.containsKey(e,t)))}}class Ji extends lr{constructor(e){super(),this.currentSequenceNumber=e}}class Yi{constructor(e){this.persistence=e,this.Ds=new zi,this.Cs=null}static Ns(e){return new Yi(e)}get xs(){if(this.Cs)return this.Cs;throw y()}addReference(e,t,n){return this.Ds.addReference(n,t),this.xs.delete(n.toString()),dr.resolve()}removeReference(e,t,n){return this.Ds.removeReference(n,t),this.xs.add(n.toString()),dr.resolve()}markPotentiallyOrphaned(e,t){return this.xs.add(t.toString()),dr.resolve()}removeTarget(e,t){this.Ds.cs(t.targetId).forEach(e=>this.xs.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.xs.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}vs(){this.Cs=new Set}Vs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return dr.forEach(this.xs,n=>{const r=re.fromPath(n);return this.ks(e,r).next(e=>{e||t.removeEntry(r)})}).next(()=>(this.Cs=null,t.apply(e)))}updateLimboDocument(e,t){return this.ks(e,t).next(e=>{e?this.xs.delete(t.toString()):this.xs.add(t.toString())})}Ps(e){return 0}ks(e,t){return dr.or([()=>dr.resolve(this.Ds.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ss(e,t)])}}function Xi(e,t){return`firestore_clients_${e}_${t}`}function Zi(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+="_"+t.uid),r}function es(e,t){return`firestore_targets_${e}_${t}`}class ts{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static $s(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new _(r.error.code,r.error.message))),s?new ts(e,t,r.state,i):(p("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Os(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ns{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static $s(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new _(n.error.code,n.error.message))),i?new ns(e,n.state,r):(p("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Os(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class rs{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=en();for(let s=0;r&&s<n.activeTargetIds.length;++s)r=ne(n.activeTargetIds[s]),i=i.add(n.activeTargetIds[s]);return r?new rs(e,i):(p("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class is{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new is(t.clientId,t.onlineState):(p("SharedClientState","Failed to parse online state: "+e),null)}}class ss{constructor(){this.activeTargetIds=en()}Fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ms(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Os(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class os{constructor(e,t,n,r,i){this.window=e,this.Oe=t,this.persistenceKey=n,this.Ls=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Bs=this.Us.bind(this),this.qs=new Vt(P),this.started=!1,this.Ks=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.js=Xi(this.persistenceKey,this.Ls),this.Qs=function(e){return"firestore_sequence_number_"+e}(this.persistenceKey),this.qs=this.qs.insert(this.Ls,new ss),this.Ws=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Gs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.zs=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.Hs=function(e){return"firestore_online_state_"+e}(this.persistenceKey),this.Js=function(e){return"firestore_bundle_loaded_"+e}(this.persistenceKey),this.window.addEventListener("storage",this.Bs)}static bt(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.pn();for(const n of e){if(n===this.Ls)continue;const e=this.getItem(Xi(this.persistenceKey,n));if(e){const t=rs.$s(n,e);t&&(this.qs=this.qs.insert(t.clientId,t))}}this.Ys();const t=this.storage.getItem(this.Hs);if(t){const e=this.Xs(t);e&&this.Zs(e)}for(const n of this.Ks)this.Us(n);this.Ks=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Qs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ti(this.qs)}isActiveQueryTarget(e){let t=!1;return this.qs.forEach((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.ei(e,"pending")}updateMutationState(e,t,n){this.ei(e,t,n),this.ni(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(es(this.persistenceKey,e));if(n){const r=ns.$s(e,n);r&&(t=r.state)}}return this.si.Fs(e),this.Ys(),t}removeLocalQueryTarget(e){this.si.Ms(e),this.Ys()}isLocalQueryTarget(e){return this.si.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(es(this.persistenceKey,e))}updateQueryState(e,t,n){this.ii(e,t,n)}handleUserChange(e,t,n){t.forEach(e=>{this.ni(e)}),this.currentUser=e,n.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.ri(e)}notifyBundleLoaded(){this.oi()}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Bs),this.removeItem(this.js),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return f("SharedClientState","READ",e,t),t}setItem(e,t){f("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){f("SharedClientState","REMOVE",e),this.storage.removeItem(e)}Us(e){const t=e;if(t.storageArea===this.storage){if(f("SharedClientState","EVENT",t.key,t.newValue),t.key===this.js)return void p("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Oe.enqueueRetryable(async()=>{if(this.started){if(null!==t.key)if(this.Ws.test(t.key)){if(null==t.newValue){const e=this.ai(t.key);return this.ci(e,null)}{const e=this.ui(t.key,t.newValue);if(e)return this.ci(e.clientId,e)}}else if(this.Gs.test(t.key)){if(null!==t.newValue){const e=this.hi(t.key,t.newValue);if(e)return this.li(e)}}else if(this.zs.test(t.key)){if(null!==t.newValue){const e=this.fi(t.key,t.newValue);if(e)return this.di(e)}}else if(t.key===this.Hs){if(null!==t.newValue){const e=this.Xs(t.newValue);if(e)return this.Zs(e)}}else if(t.key===this.Qs){const e=function(e){let t=C.T;if(null!=e)try{const n=JSON.parse(e);v("number"==typeof n),t=n}catch(e){p("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==C.T&&this.sequenceNumberHandler(e)}else if(t.key===this.Js)return this.syncEngine.wi()}else this.Ks.push(t)})}}get si(){return this.qs.get(this.Ls)}Ys(){this.setItem(this.js,this.si.Os())}ei(e,t,n){const r=new ts(this.currentUser,e,t,n),i=Zi(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Os())}ni(e){const t=Zi(this.persistenceKey,this.currentUser,e);this.removeItem(t)}ri(e){const t={clientId:this.Ls,onlineState:e};this.storage.setItem(this.Hs,JSON.stringify(t))}ii(e,t,n){const r=es(this.persistenceKey,e),i=new ns(e,t,n);this.setItem(r,i.Os())}oi(){this.setItem(this.Js,"value-not-used")}ai(e){const t=this.Ws.exec(e);return t?t[1]:null}ui(e,t){const n=this.ai(e);return rs.$s(n,t)}hi(e,t){const n=this.Gs.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return ts.$s(new c(i),r,t)}fi(e,t){const n=this.zs.exec(e),r=Number(n[1]);return ns.$s(r,t)}Xs(e){return is.$s(e)}async li(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine._i(e.batchId,e.state,e.error);f("SharedClientState","Ignoring mutation for non-active user "+e.user.uid)}di(e){return this.syncEngine.mi(e.targetId,e.state,e.error)}ci(e,t){const n=t?this.qs.insert(e,t):this.qs.remove(e),r=this.ti(this.qs),i=this.ti(n),s=[],o=[];return i.forEach(e=>{r.has(e)||s.push(e)}),r.forEach(e=>{i.has(e)||o.push(e)}),this.syncEngine.gi(s,o).then(()=>{this.qs=n})}Zs(e){this.qs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ti(e){let t=en();return e.forEach((e,n)=>{t=t.unionWith(n.activeTargetIds)}),t}}class as{constructor(){this.yi=new ss,this.pi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.yi.Fs(e),this.pi[e]||"not-current"}updateQueryState(e,t,n){this.pi[e]=t}removeLocalQueryTarget(e){this.yi.Ms(e)}isLocalQueryTarget(e){return this.yi.activeTargetIds.has(e)}clearQueryState(e){delete this.pi[e]}getAllActiveQueryTargets(){return this.yi.activeTargetIds}isActiveQueryTarget(e){return this.yi.activeTargetIds.has(e)}start(){return this.yi=new ss,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(){}}class cs{Ei(e){}shutdown(){}}class us{constructor(){this.Ti=()=>this.Ii(),this.Ai=()=>this.Ri(),this.bi=[],this.Pi()}Ei(e){this.bi.push(e)}shutdown(){window.removeEventListener("online",this.Ti),window.removeEventListener("offline",this.Ai)}Pi(){window.addEventListener("online",this.Ti),window.addEventListener("offline",this.Ai)}Ii(){f("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.bi)e(0)}Ri(){f("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.bi)e(1)}static bt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const hs={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class ls{constructor(e){this.vi=e.vi,this.Vi=e.Vi}Si(e){this.Di=e}Ci(e){this.Ni=e}onMessage(e){this.xi=e}close(){this.Vi()}send(e){this.vi(e)}ki(){this.Di()}$i(e){this.Ni(e)}Oi(e){this.xi(e)}}class ds extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.Fi=t+"://"+e.host,this.Mi="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Li(e,t,n,r){const i=this.Bi(e,t);f("RestConnection","Sending: ",i,n);const s={};return this.Ui(s,r),this.qi(e,i,s,n).then(e=>(f("RestConnection","Received: ",e),e),t=>{throw m("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})}Ki(e,t,n,r){return this.Li(e,t,n,r)}Ui(e,t){if(e["X-Goog-Api-Client"]="gl-js/ fire/"+u,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t)for(const n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n])}Bi(e,t){const n=hs[e];return`${this.Fi}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}qi(e,t,n,r){return new Promise((i,s)=>{const o=new a.g;o.listenOnce(a.c.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case a.a.NO_ERROR:const t=o.getResponseJson();f("Connection","XHR received:",JSON.stringify(t)),i(t);break;case a.a.TIMEOUT:f("Connection",'RPC "'+e+'" timed out'),s(new _(I.DEADLINE_EXCEEDED,"Request time out"));break;case a.a.HTTP_ERROR:const n=o.getStatus();if(f("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const e=o.getResponseJson().error;if(e&&e.status&&e.message){const t=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(I).indexOf(t)>=0?t:I.UNKNOWN}(e.status);s(new _(t,e.message))}else s(new _(I.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new _(I.UNAVAILABLE,"Connection failed."));break;default:y()}}finally{f("Connection",'RPC "'+e+'" completed.')}});const c=JSON.stringify(r);o.send(t,"POST",c,n,15)})}ji(e,t){const n=[this.Fi,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=Object(a.h)(),i=Object(a.i)(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new a.d({})),this.Ui(s.initMessageHeaders,t),Object(o.s)()||Object(o.u)()||Object(o.o)()||Object(o.q)()||Object(o.w)()||Object(o.n)()||(s.httpHeadersOverwriteParam="$httpHeaders");const c=n.join("");f("Connection","Creating WebChannel: "+c,s);const u=r.createWebChannel(c,s);let h=!1,l=!1;const d=new ls({vi:e=>{l?f("Connection","Not sending because WebChannel is closed:",e):(h||(f("Connection","Opening WebChannel transport."),u.open(),h=!0),f("Connection","WebChannel sending:",e),u.send(e))},Vi:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,a.f.EventType.OPEN,()=>{l||f("Connection","WebChannel transport opened.")}),p(u,a.f.EventType.CLOSE,()=>{l||(l=!0,f("Connection","WebChannel transport closed"),d.$i())}),p(u,a.f.EventType.ERROR,e=>{l||(l=!0,m("Connection","WebChannel transport errored:",e),d.$i(new _(I.UNAVAILABLE,"The operation could not be completed")))}),p(u,a.f.EventType.MESSAGE,e=>{var t;if(!l){const n=e.data[0];v(!!n);const r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){f("Connection","WebChannel received error:",i);const e=i.status;let t=function(e){const t=Mt[e];if(void 0!==t)return jt(t)}(e),n=i.message;void 0===t&&(t=I.INTERNAL,n="Unknown error status: "+e+" with message "+i.message),l=!0,d.$i(new _(t,n)),u.close()}else f("Connection","WebChannel received:",n),d.Oi(n)}}),p(i,a.b.STAT_EVENT,e=>{e.stat===a.e.PROXY?f("Connection","Detected buffering proxy"):e.stat===a.e.NOPROXY&&f("Connection","Detected no buffering proxy")}),setTimeout(()=>{d.ki()},0),d}}function fs(){return"undefined"!=typeof window?window:null}function ps(){return"undefined"!=typeof document?document:null}function ms(e){return new fn(e,!0)}class gs{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Oe=e,this.timerId=t,this.Qi=n,this.Wi=r,this.Gi=i,this.zi=0,this.Hi=null,this.Ji=Date.now(),this.reset()}reset(){this.zi=0}Yi(){this.zi=this.Gi}Xi(e){this.cancel();const t=Math.floor(this.zi+this.Zi()),n=Math.max(0,Date.now()-this.Ji),r=Math.max(0,t-n);r>0&&f("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.zi} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Hi=this.Oe.enqueueAfterDelay(this.timerId,r,()=>(this.Ji=Date.now(),e())),this.zi*=this.Wi,this.zi<this.Qi&&(this.zi=this.Qi),this.zi>this.Gi&&(this.zi=this.Gi)}tr(){null!==this.Hi&&(this.Hi.skipDelay(),this.Hi=null)}cancel(){null!==this.Hi&&(this.Hi.cancel(),this.Hi=null)}Zi(){return(Math.random()-.5)*this.zi}}class ys{constructor(e,t,n,r,i,s){this.Oe=e,this.er=n,this.nr=r,this.credentialsProvider=i,this.listener=s,this.state=0,this.sr=0,this.ir=null,this.stream=null,this.rr=new gs(e,t)}ar(){return 1===this.state||2===this.state||4===this.state}cr(){return 2===this.state}start(){3!==this.state?this.auth():this.ur()}async stop(){this.ar()&&await this.close(0)}hr(){this.state=0,this.rr.reset()}lr(){this.cr()&&null===this.ir&&(this.ir=this.Oe.enqueueAfterDelay(this.er,6e4,()=>this.dr()))}wr(e){this._r(),this.stream.send(e)}async dr(){if(this.cr())return this.close(0)}_r(){this.ir&&(this.ir.cancel(),this.ir=null)}async close(e,t){this._r(),this.rr.cancel(),this.sr++,3!==e?this.rr.reset():t&&t.code===I.RESOURCE_EXHAUSTED?(p(t.toString()),p("Using maximum backoff delay to prevent overloading the backend."),this.rr.Yi()):t&&t.code===I.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.mr(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Ci(t)}mr(){}auth(){this.state=1;const e=this.gr(this.sr),t=this.sr;this.credentialsProvider.getToken().then(e=>{this.sr===t&&this.yr(e)},t=>{e(()=>{const e=new _(I.UNKNOWN,"Fetching auth token failed: "+t.message);return this.pr(e)})})}yr(e){const t=this.gr(this.sr);this.stream=this.Er(e),this.stream.Si(()=>{t(()=>(this.state=2,this.listener.Si()))}),this.stream.Ci(e=>{t(()=>this.pr(e))}),this.stream.onMessage(e=>{t(()=>this.onMessage(e))})}ur(){this.state=4,this.rr.Xi(async()=>{this.state=0,this.start()})}pr(e){return f("PersistentStream","close with error: "+e),this.stream=null,this.close(3,e)}gr(e){return t=>{this.Oe.enqueueAndForget(()=>this.sr===e?t():(f("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class vs extends ys{constructor(e,t,n,r,i){super(e,"listen_stream_connection_backoff","listen_stream_idle",t,n,i),this.N=r}Er(e){return this.nr.ji("Listen",e)}onMessage(e){this.rr.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:y()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.D?(v(void 0===t||"string"==typeof t),W.fromBase64String(t||"")):(v(void 0===t||t instanceof Uint8Array),W.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?I.UNKNOWN:jt(e.code);return new _(t,e.message||"")}(o);n=new on(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=In(e,r.document.name),s=yn(r.document.updateTime),o=new ye({mapValue:{fields:r.document.fields}}),a=we.newFoundDocument(i,s,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new rn(c,u,a.key,a)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=In(e,r.document),s=r.readTime?yn(r.readTime):F.min(),o=we.newNoDocument(i,s),a=r.removedTargetIds||[];n=new rn([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=In(e,r.document),s=r.removedTargetIds||[];n=new rn([],s,i,null)}else{if(!("filter"in t))return y();{t.filter;const e=t.filter;e.targetId;const r=e.count||0,i=new xt(r),s=e.targetId;n=new sn(s,i)}}return n}(this.N,e),n=function(e){if(!("targetChange"in e))return F.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?F.min():t.readTime?yn(t.readTime):F.min()}(e);return this.listener.Tr(t,n)}Ir(e){const t={};t.database=En(this.N),t.addTarget=function(e,t){let n;const r=t.target;return n=Ee(r)?{documents:Cn(e,r)}:{query:Dn(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=mn(e,t.resumeToken):t.snapshotVersion.compareTo(F.min())>0&&(n.readTime=pn(e,t.snapshotVersion.toTimestamp())),n}(this.N,e);const n=function(e,t){const n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return y()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.N,e);n&&(t.labels=n),this.wr(t)}Ar(e){const t={};t.database=En(this.N),t.removeTarget=e,this.wr(t)}}class ws extends ys{constructor(e,t,n,r,i){super(e,"write_stream_connection_backoff","write_stream_idle",t,n,i),this.N=r,this.Rr=!1}get br(){return this.Rr}start(){this.Rr=!1,this.lastStreamToken=void 0,super.start()}mr(){this.Rr&&this.Pr([])}Er(e){return this.nr.ji("Write",e)}onMessage(e){if(v(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Rr){this.rr.reset();const t=function(e,t){return e&&e.length>0?(v(void 0!==t),e.map(e=>function(e,t){let n=e.updateTime?yn(e.updateTime):yn(t);return n.isEqual(F.min())&&(n=yn(t)),new wt(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=yn(e.commitTime);return this.listener.vr(n,t)}return v(!e.writeResults||0===e.writeResults.length),this.Rr=!0,this.listener.Vr()}Sr(){const e={};e.database=En(this.N),this.wr(e)}Pr(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Nn(this.N,e))};this.wr(t)}}class bs extends class{}{constructor(e,t,n){super(),this.credentials=e,this.nr=t,this.N=n,this.Dr=!1}Cr(){if(this.Dr)throw new _(I.FAILED_PRECONDITION,"The client has already been terminated.")}Li(e,t,n){return this.Cr(),this.credentials.getToken().then(r=>this.nr.Li(e,t,n,r)).catch(e=>{throw"FirebaseError"===e.name?(e.code===I.UNAUTHENTICATED&&this.credentials.invalidateToken(),e):new _(I.UNKNOWN,e.toString())})}Ki(e,t,n){return this.Cr(),this.credentials.getToken().then(r=>this.nr.Ki(e,t,n,r)).catch(e=>{throw"FirebaseError"===e.name?(e.code===I.UNAUTHENTICATED&&this.credentials.invalidateToken(),e):new _(I.UNKNOWN,e.toString())})}terminate(){this.Dr=!0}}class Is{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.Nr=0,this.kr=null,this.$r=!0}Or(){0===this.Nr&&(this.Fr("Unknown"),this.kr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.kr=null,this.Mr("Backend didn't respond within 10 seconds."),this.Fr("Offline"),Promise.resolve())))}Lr(e){"Online"===this.state?this.Fr("Unknown"):(this.Nr++,this.Nr>=1&&(this.Br(),this.Mr("Connection failed 1 times. Most recent error: "+e.toString()),this.Fr("Offline")))}set(e){this.Br(),this.Nr=0,"Online"===e&&(this.$r=!1),this.Fr(e)}Fr(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}Mr(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.$r?(p(t),this.$r=!1):f("OnlineStateTracker",t)}Br(){null!==this.kr&&(this.kr.cancel(),this.kr=null)}}class _s{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ur=[],this.qr=new Map,this.Kr=new Set,this.jr=[],this.Qr=i,this.Qr.Ei(e=>{n.enqueueAndForget(async()=>{Ds(this)&&(f("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=b(e);t.Kr.add(4),await Es(t),t.Wr.set("Unknown"),t.Kr.delete(4),await Ts(t)}(this))})}),this.Wr=new Is(n,r)}}async function Ts(e){if(Ds(e))for(const t of e.jr)await t(!0)}async function Es(e){for(const t of e.jr)await t(!1)}function Ss(e,t){const n=b(e);n.qr.has(t.targetId)||(n.qr.set(t.targetId,t),Cs(n)?Os(n):$s(n).cr()&&As(n,t))}function ks(e,t){const n=b(e),r=$s(n);n.qr.delete(t),r.cr()&&Ns(n,t),0===n.qr.size&&(r.cr()?r.lr():Ds(n)&&n.Wr.set("Unknown"))}function As(e,t){e.Gr.Y(t.targetId),$s(e).Ir(t)}function Ns(e,t){e.Gr.Y(t),$s(e).Ar(t)}function Os(e){e.Gr=new cn({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.qr.get(t)||null}),$s(e).start(),e.Wr.Or()}function Cs(e){return Ds(e)&&!$s(e).ar()&&e.qr.size>0}function Ds(e){return 0===b(e).Kr.size}function Rs(e){e.Gr=void 0}async function Ps(e){e.qr.forEach((t,n)=>{As(e,t)})}async function Ls(e,t){Rs(e),Cs(e)?(e.Wr.Lr(t),Os(e)):e.Wr.set("Unknown")}async function xs(e,t,n){if(e.Wr.set("Online"),t instanceof on&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.qr.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.qr.delete(r),e.Gr.removeTarget(r))}(e,t)}catch(n){f("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Ms(e,n)}else if(t instanceof rn?e.Gr.rt(t):t instanceof sn?e.Gr.ft(t):e.Gr.ct(t),!n.isEqual(F.min()))try{const t=await Pi(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Gr._t(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.qr.get(r);i&&e.qr.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(t=>{const n=e.qr.get(t);if(!n)return;e.qr.set(t,n.withResumeToken(W.EMPTY_BYTE_STRING,n.snapshotVersion)),Ns(e,t);const r=new kr(n.target,t,1,n.sequenceNumber);As(e,r)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){f("RemoteStore","Failed to raise snapshot:",t),await Ms(e,t)}}async function Ms(e,t,n){if(!yr(t))throw t;e.Kr.add(1),await Es(e),e.Wr.set("Offline"),n||(n=()=>Pi(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{f("RemoteStore","Retrying IndexedDB access"),await n(),e.Kr.delete(1),await Ts(e)})}function Fs(e,t){return t().catch(n=>Ms(e,n,t))}async function Us(e){const t=b(e),n=Qs(t);let r=t.Ur.length>0?t.Ur[t.Ur.length-1].batchId:-1;for(;js(t);)try{const e=await xi(t.localStore,r);if(null===e){0===t.Ur.length&&n.lr();break}r=e.batchId,Vs(t,e)}catch(e){await Ms(t,e)}qs(t)&&Bs(t)}function js(e){return Ds(e)&&e.Ur.length<10}function Vs(e,t){e.Ur.push(t);const n=Qs(e);n.cr()&&n.br&&n.Pr(t.mutations)}function qs(e){return Ds(e)&&!Qs(e).ar()&&e.Ur.length>0}function Bs(e){Qs(e).start()}async function zs(e){Qs(e).Sr()}async function Ks(e){const t=Qs(e);for(const n of e.Ur)t.Pr(n.mutations)}async function Gs(e,t,n){const r=e.Ur.shift(),i=Sr.from(r,t,n);await Fs(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await Us(e)}async function Hs(e,t){t&&Qs(e).br&&await async function(e,t){if(Ut(n=t.code)&&n!==I.ABORTED){const n=e.Ur.shift();Qs(e).hr(),await Fs(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Us(e)}var n}(e,t),qs(e)&&Bs(e)}async function Ws(e,t){const n=b(e);t?(n.Kr.delete(2),await Ts(n)):t||(n.Kr.add(2),await Es(n),n.Wr.set("Unknown"))}function $s(e){return e.zr||(e.zr=function(e,t,n){const r=b(e);return r.Cr(),new vs(t,r.nr,r.credentials,r.N,n)}(e.datastore,e.asyncQueue,{Si:Ps.bind(null,e),Ci:Ls.bind(null,e),Tr:xs.bind(null,e)}),e.jr.push(async t=>{t?(e.zr.hr(),Cs(e)?Os(e):e.Wr.set("Unknown")):(await e.zr.stop(),Rs(e))})),e.zr}function Qs(e){return e.Hr||(e.Hr=function(e,t,n){const r=b(e);return r.Cr(),new ws(t,r.nr,r.credentials,r.N,n)}(e.datastore,e.asyncQueue,{Si:zs.bind(null,e),Ci:Hs.bind(null,e),Vr:Ks.bind(null,e),vr:Gs.bind(null,e)}),e.jr.push(async t=>{t?(e.Hr.hr(),await Us(e)):(await e.Hr.stop(),e.Ur.length>0&&(f("RemoteStore",`Stopping write stream with ${e.Ur.length} pending writes`),e.Ur=[]))})),e.Hr}class Js{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new T,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new Js(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new _(I.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ys(e,t){if(p("AsyncQueue",`${t}: ${e}`),yr(e))return new _(I.UNAVAILABLE,`${t}: ${e}`);throw e}class Xs{constructor(e){this.comparator=e?(t,n)=>e(t,n)||re.comparator(t.key,n.key):(e,t)=>re.comparator(e.key,t.key),this.keyedMap=$t(),this.sortedSet=new Vt(this.comparator)}static emptySet(e){return new Xs(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Xs))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Xs;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Zs{constructor(){this.Jr=new Vt(re.comparator)}track(e){const t=e.doc.key,n=this.Jr.get(t);n?0!==e.type&&3===n.type?this.Jr=this.Jr.insert(t,e):3===e.type&&1!==n.type?this.Jr=this.Jr.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Jr=this.Jr.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Jr=this.Jr.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Jr=this.Jr.remove(t):1===e.type&&2===n.type?this.Jr=this.Jr.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Jr=this.Jr.insert(t,{type:2,doc:e.doc}):y():this.Jr=this.Jr.insert(t,e)}Yr(){const e=[];return this.Jr.inorderTraversal((t,n)=>{e.push(n)}),e}}class eo{constructor(e,t,n,r,i,s,o,a){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(e,t,n,r){const i=[];return t.forEach(e=>{i.push({type:0,doc:e})}),new eo(e,t,Xs.emptySet(t),i,n,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ye(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class to{constructor(){this.Xr=void 0,this.listeners=[]}}class no{constructor(){this.queries=new di(e=>Xe(e),Ye),this.onlineState="Unknown",this.Zr=new Set}}async function ro(e,t){const n=b(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new to),i)try{s.Xr=await n.onListen(r)}catch(e){const n=Ys(e,`Initialization of query '${Ze(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,s),s.listeners.push(t),t.eo(n.onlineState),s.Xr&&t.no(s.Xr)&&ao(n)}async function io(e,t){const n=b(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function so(e,t){const n=b(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.listeners)e.no(i)&&(r=!0);t.Xr=i}}r&&ao(n)}function oo(e,t,n){const r=b(e),i=r.queries.get(t);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(t)}function ao(e){e.Zr.forEach(e=>{e.next()})}class co{constructor(e,t,n){this.query=e,this.so=t,this.io=!1,this.ro=null,this.onlineState="Unknown",this.options=n||{}}no(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new eo(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.io?this.oo(e)&&(this.so.next(e),t=!0):this.ao(e,this.onlineState)&&(this.co(e),t=!0),this.ro=e,t}onError(e){this.so.error(e)}eo(e){this.onlineState=e;let t=!1;return this.ro&&!this.io&&this.ao(this.ro,e)&&(this.co(this.ro),t=!0),t}ao(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.uo||!n)&&(!e.docs.isEmpty()||"Offline"===t)}oo(e){if(e.docChanges.length>0)return!0;const t=this.ro&&this.ro.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}co(e){e=eo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.io=!0,this.so.next(e)}}class uo{constructor(e,t){this.payload=e,this.byteLength=t}ho(){return"metadata"in this.payload}}class ho{constructor(e){this.N=e}zn(e){return In(this.N,e)}Hn(e){return e.metadata.exists?An(this.N,e.document,!1):we.newNoDocument(this.zn(e.metadata.name),this.Jn(e.metadata.readTime))}Jn(e){return yn(e)}}class lo{constructor(e,t,n){this.lo=e,this.localStore=t,this.N=n,this.queries=[],this.documents=[],this.progress=fo(e)}fo(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;return e.payload.namedQuery?this.queries.push(e.payload.namedQuery):e.payload.documentMetadata?(this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t):e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t),t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}wo(e){const t=new Map,n=new ho(this.N);for(const r of e)if(r.metadata.queries){const e=n.zn(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||Xt()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=b(e);let s=Xt(),o=Ht(),a=Jt();for(const h of n){const e=t.zn(h.metadata.name);h.document&&(s=s.add(e)),o=o.insert(e,t.Hn(h)),a=a.insert(e,t.Jn(h.metadata.readTime))}const c=i.jn.newChangeBuffer({trackRemovals:!0}),u=await Mi(i,function(e){return Qe(Be(B.fromString("__bundle__/docs/"+e)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",e=>Li(e,c,o,F.min(),a).next(t=>(c.apply(e),t)).next(t=>i.ze.removeMatchingKeysForTargetId(e,u.targetId).next(()=>i.ze.addMatchingKeys(e,s,u.targetId)).next(()=>i.Qn.vn(e,t)).next(()=>t)))}(this.localStore,new ho(this.N),this.documents,this.lo.id),t=this.wo(this.documents);for(const n of this.queries)await qi(this.localStore,n,t.get(n.name));return this.progress.taskState="Success",new ki(Object.assign({},this.progress),e)}}function fo(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class po{constructor(e){this.key=e}}class mo{constructor(e){this.key=e}}class go{constructor(e,t){this.query=e,this._o=t,this.mo=null,this.current=!1,this.yo=Xt(),this.mutatedKeys=Xt(),this.po=tt(e),this.Eo=new Xs(this.po)}get To(){return this._o}Io(e,t){const n=t?t.Ao:new Zs,r=t?t.Eo:this.Eo;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a=ze(this.query)&&r.size===this.query.limit?r.last():null,c=Ke(this.query)&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const u=r.get(e),h=et(this.query,t)?t:null,l=!!u&&this.mutatedKeys.has(u.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let f=!1;u&&h?u.data.isEqual(h.data)?l!==d&&(n.track({type:3,doc:h}),f=!0):this.Ro(u,h)||(n.track({type:2,doc:h}),f=!0,(a&&this.po(h,a)>0||c&&this.po(h,c)<0)&&(o=!0)):!u&&h?(n.track({type:0,doc:h}),f=!0):u&&!h&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(h?(s=s.add(h),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),ze(this.query)||Ke(this.query))for(;s.size>this.query.limit;){const e=ze(this.query)?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Eo:s,Ao:n,Ln:o,mutatedKeys:i}}Ro(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.Eo;this.Eo=e.Eo,this.mutatedKeys=e.mutatedKeys;const i=e.Ao.Yr();i.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return y()}};return n(e)-n(t)}(e.type,t.type)||this.po(e.doc,t.doc)),this.bo(n);const s=t?this.Po():[],o=0===this.yo.size&&this.current?1:0,a=o!==this.mo;return this.mo=o,0!==i.length||a?{snapshot:new eo(this.query,e.Eo,r,i,e.mutatedKeys,0===o,a,!1),vo:s}:{vo:s}}eo(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Eo:this.Eo,Ao:new Zs,mutatedKeys:this.mutatedKeys,Ln:!1},!1)):{vo:[]}}Vo(e){return!this._o.has(e)&&!!this.Eo.has(e)&&!this.Eo.get(e).hasLocalMutations}bo(e){e&&(e.addedDocuments.forEach(e=>this._o=this._o.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this._o=this._o.delete(e)),this.current=e.current)}Po(){if(!this.current)return[];const e=this.yo;this.yo=Xt(),this.Eo.forEach(e=>{this.Vo(e.key)&&(this.yo=this.yo.add(e.key))});const t=[];return e.forEach(e=>{this.yo.has(e)||t.push(new mo(e))}),this.yo.forEach(n=>{e.has(n)||t.push(new po(n))}),t}So(e){this._o=e.Gn,this.yo=Xt();const t=this.Io(e.documents);return this.applyChanges(t,!0)}Do(){return eo.fromInitialDocuments(this.query,this.Eo,this.mutatedKeys,0===this.mo)}}class yo{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class vo{constructor(e){this.key=e,this.Co=!1}}class wo{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.No={},this.xo=new di(e=>Xe(e),Ye),this.ko=new Map,this.$o=new Set,this.Oo=new Vt(re.comparator),this.Fo=new Map,this.Mo=new zi,this.Lo={},this.Bo=new Map,this.Uo=ei.ie(),this.onlineState="Unknown",this.qo=void 0}get isPrimaryClient(){return!0===this.qo}}async function bo(e,t){const n=Ho(e);let r,i;const s=n.xo.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Do();else{const e=await Mi(n.localStore,Qe(t)),s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await Io(n,t,r,"current"===s),n.isPrimaryClient&&Ss(n.remoteStore,e)}return i}async function Io(e,t,n,r){e.Ko=(t,n,r)=>async function(e,t,n,r){let i=t.view.Io(n);i.Ln&&(i=await Ui(e.localStore,t.query,!1).then(({documents:e})=>t.view.Io(e,i)));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return Ro(e,t.targetId,o.vo),o.snapshot}(e,t,n,r);const i=await Ui(e.localStore,t,!0),s=new go(t,i.Gn),o=s.Io(i.documents),a=nn.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState),c=s.applyChanges(o,e.isPrimaryClient,a);Ro(e,n,c.vo);const u=new yo(t,n,s);return e.xo.set(t,u),e.ko.has(n)?e.ko.get(n).push(t):e.ko.set(n,[t]),c.snapshot}async function _o(e,t){const n=b(e),r=n.xo.get(t),i=n.ko.get(r.targetId);if(i.length>1)return n.ko.set(r.targetId,i.filter(e=>!Ye(e,t))),void n.xo.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Fi(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),ks(n.remoteStore,r.targetId),Co(n,r.targetId)}).catch(si)):(Co(n,r.targetId),await Fi(n.localStore,r.targetId,!0))}async function To(e,t){const n=b(e);try{const e=await function(e,t){const n=b(e),r=t.snapshotVersion;let i=n.Un;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.jn.newChangeBuffer({trackRemovals:!0});i=n.Un;const o=[];t.targetChanges.forEach((t,s)=>{const a=i.get(s);if(!a)return;o.push(n.ze.removeMatchingKeys(e,t.removedDocuments,s).next(()=>n.ze.addMatchingKeys(e,t.addedDocuments,s)));const c=t.resumeToken;if(c.approximateByteSize()>0){const u=a.withResumeToken(c,r).withSequenceNumber(e.currentSequenceNumber);i=i.insert(s,u),function(e,t,n){return v(t.resumeToken.approximateByteSize()>0),0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(a,u,t)&&o.push(n.ze.updateTargetData(e,u))}});let a=Ht();if(t.documentUpdates.forEach((r,i)=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(Li(e,s,t.documentUpdates,r,void 0).next(e=>{a=e})),!r.isEqual(F.min())){const t=n.ze.getLastRemoteSnapshotVersion(e).next(t=>n.ze.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return dr.waitFor(o).next(()=>s.apply(e)).next(()=>n.Qn.vn(e,a)).next(()=>a)}).then(e=>(n.Un=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Fo.get(t);r&&(v(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Co=!0:e.modifiedDocuments.size>0?v(r.Co):e.removedDocuments.size>0&&(v(r.Co),r.Co=!1))}),await xo(n,e,t)}catch(e){await si(e)}}function Eo(e,t,n){const r=b(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.xo.forEach((n,r)=>{const i=r.view.eo(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=b(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.listeners)i.eo(t)&&(r=!0)}),r&&ao(n)}(r.eventManager,t),e.length&&r.No.Tr(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function So(e,t,n){const r=b(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Fo.get(t),s=i&&i.key;if(s){let e=new Vt(re.comparator);e=e.insert(s,we.newNoDocument(s,F.min()));const n=Xt().add(s),i=new tn(F.min(),new Map,new zt(P),e,n);await To(r,i),r.Oo=r.Oo.remove(s),r.Fo.delete(t),Lo(r)}else await Fi(r.localStore,t,!1).then(()=>Co(r,t,n)).catch(si)}async function ko(e,t){const n=b(e),r=t.batch.batchId;try{const e=await function(e,t){const n=b(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.jn.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=dr.resolve();return s.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);v(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&r.addEntry(t,n.commitVersion))})}),o.next(()=>e.In.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.In.performConsistencyCheck(e)).next(()=>n.Qn.Pn(e,r))})}(n.localStore,t);Oo(n,r,null),No(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await xo(n,e)}catch(e){await si(e)}}async function Ao(e,t,n){const r=b(e);try{const e=await function(e,t){const n=b(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.In.lookupMutationBatch(e,t).next(t=>(v(null!==t),r=t.keys(),n.In.removeMutationBatch(e,t))).next(()=>n.In.performConsistencyCheck(e)).next(()=>n.Qn.Pn(e,r))})}(r.localStore,t);Oo(r,t,n),No(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await xo(r,e)}catch(n){await si(n)}}function No(e,t){(e.Bo.get(t)||[]).forEach(e=>{e.resolve()}),e.Bo.delete(t)}function Oo(e,t,n){const r=b(e);let i=r.Lo[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Lo[r.currentUser.toKey()]=i}}function Co(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.ko.get(t))e.xo.delete(r),n&&e.No.jo(r,n);e.ko.delete(t),e.isPrimaryClient&&e.Mo.cs(t).forEach(t=>{e.Mo.containsKey(t)||Do(e,t)})}function Do(e,t){e.$o.delete(t.path.canonicalString());const n=e.Oo.get(t);null!==n&&(ks(e.remoteStore,n),e.Oo=e.Oo.remove(t),e.Fo.delete(n),Lo(e))}function Ro(e,t,n){for(const r of n)r instanceof po?(e.Mo.addReference(r.key,t),Po(e,r)):r instanceof mo?(f("SyncEngine","Document no longer in limbo: "+r.key),e.Mo.removeReference(r.key,t),e.Mo.containsKey(r.key)||Do(e,r.key)):y()}function Po(e,t){const n=t.key,r=n.path.canonicalString();e.Oo.get(n)||e.$o.has(r)||(f("SyncEngine","New document in limbo: "+n),e.$o.add(r),Lo(e))}function Lo(e){for(;e.$o.size>0&&e.Oo.size<e.maxConcurrentLimboResolutions;){const t=e.$o.values().next().value;e.$o.delete(t);const n=new re(B.fromString(t)),r=e.Uo.next();e.Fo.set(r,new vo(n)),e.Oo=e.Oo.insert(n,r),Ss(e.remoteStore,new kr(Qe(Be(n.path)),r,2,C.T))}}async function xo(e,t,n){const r=b(e),i=[],s=[],o=[];r.xo.isEmpty()||(r.xo.forEach((e,a)=>{o.push(r.Ko(a,t,n).then(e=>{if(e){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,e.fromCache?"not-current":"current"),i.push(e);const t=Ni.kn(a.targetId,e);s.push(t)}}))}),await Promise.all(o),r.No.Tr(i),await async function(e,t){const n=b(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>dr.forEach(t,t=>dr.forEach(t.Nn,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>dr.forEach(t.xn,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!yr(e))throw e;f("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Un.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Un=n.Un.insert(e,i)}}}(r.localStore,s))}async function Mo(e,t){const n=b(e);if(!n.currentUser.isEqual(t)){f("SyncEngine","User change. New user:",t.toKey());const e=await Ri(n.localStore,t);n.currentUser=t,function(e,t){e.Bo.forEach(e=>{e.forEach(e=>{e.reject(new _(I.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Bo.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await xo(n,e.Wn)}}function Fo(e,t){const n=b(e),r=n.Fo.get(t);if(r&&r.Co)return Xt().add(r.key);{let e=Xt();const r=n.ko.get(t);if(!r)return e;for(const t of r){const r=n.xo.get(t);e=e.unionWith(r.view.To)}return e}}async function Uo(e,t){const n=b(e),r=await Ui(n.localStore,t.query,!0),i=t.view.So(r);return n.isPrimaryClient&&Ro(n,t.targetId,i.vo),i}async function jo(e){const t=b(e);return Vi(t.localStore).then(e=>xo(t,e))}async function Vo(e,t,n,r){const i=b(e),s=await function(e,t){const n=b(e),r=b(n.In);return n.persistence.runTransaction("Lookup mutation documents","readonly",e=>r.Xt(e,t).next(t=>t?n.Qn.Pn(e,t):dr.resolve(null)))}(i.localStore,t);null!==s?("pending"===n?await Us(i.remoteStore):"acknowledged"===n||"rejected"===n?(Oo(i,t,r||null),No(i,t),function(e,t){b(b(e).In).te(t)}(i.localStore,t)):y(),await xo(i,s)):f("SyncEngine","Cannot apply mutation batch with id: "+t)}async function qo(e,t,n){const r=b(e),i=[],s=[];for(const o of t){let e;const t=r.ko.get(o);if(t&&0!==t.length){e=await Mi(r.localStore,Qe(t[0]));for(const e of t){const t=r.xo.get(e),n=await Uo(r,t);n.snapshot&&s.push(n.snapshot)}}else{const t=await ji(r.localStore,o);e=await Mi(r.localStore,t),await Io(r,Bo(t),o,!1)}i.push(e)}return r.No.Tr(s),i}function Bo(e){return qe(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function zo(e){const t=b(e);return b(b(t.localStore).persistence).pn()}async function Ko(e,t,n,r){const i=b(e);if(i.qo)f("SyncEngine","Ignoring unexpected query state notification.");else if(i.ko.has(t))switch(n){case"current":case"not-current":{const e=await Vi(i.localStore),r=tn.createSynthesizedRemoteEventForCurrentChange(t,"current"===n);await xo(i,e,r);break}case"rejected":await Fi(i.localStore,t,!0),Co(i,t,r);break;default:y()}}async function Go(e,t,n){const r=Ho(e);if(r.qo){for(const e of t){if(r.ko.has(e)){f("SyncEngine","Adding an already active target "+e);continue}const t=await ji(r.localStore,e),n=await Mi(r.localStore,t);await Io(r,Bo(t),n.targetId,!1),Ss(r.remoteStore,n)}for(const e of n)r.ko.has(e)&&await Fi(r.localStore,e,!1).then(()=>{ks(r.remoteStore,e),Co(r,e)}).catch(si)}}function Ho(e){const t=b(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=To.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Fo.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=So.bind(null,t),t.No.Tr=so.bind(null,t.eventManager),t.No.jo=oo.bind(null,t.eventManager),t}function Wo(e){const t=b(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=ko.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Ao.bind(null,t),t}class $o{constructor(){this.synchronizeTabs=!1}async initialize(e){this.N=ms(e.databaseInfo.databaseId),this.sharedClientState=this.Wo(e),this.persistence=this.Go(e),await this.persistence.start(),this.gcScheduler=this.zo(e),this.localStore=this.Ho(e)}zo(e){return null}Ho(e){return Di(this.persistence,new Oi,e.initialUser,this.N)}Go(e){return new Qi(Yi.Ns,this.N)}Wo(e){return new as}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Qo extends $o{constructor(e,t,n){super(),this.Jo=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await async function(e){const t=b(e);return t.persistence.runTransaction("Synchronize last document change read time","readonly",e=>function(e){const t=yi(e);let n=F.min();return t.Kt({index:er.readTimeIndex,reverse:!0},(e,t,r)=>{t.readTime&&(n=Dr(t.readTime)),r.done()}).next(()=>n)}(e)).then(e=>{t.Kn=e})}(this.localStore),await this.Jo.initialize(this,e),await Wo(this.Jo.syncEngine),await Us(this.Jo.remoteStore),await this.persistence.nn(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(this.localStore),Promise.resolve()))}Ho(e){return Di(this.persistence,new Oi,e.initialUser,this.N)}zo(e){const t=this.persistence.referenceDelegate.garbageCollector;return new ci(t,e.asyncQueue)}Go(e){const t=Si(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Hr.withCacheSize(this.cacheSizeBytes):Hr.DEFAULT;return new _i(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,fs(),ps(),this.N,this.sharedClientState,!!this.forceOwnership)}Wo(e){return new as}}class Jo extends Qo{constructor(e,t){super(e,t,!1),this.Jo=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Jo.syncEngine;this.sharedClientState instanceof os&&(this.sharedClientState.syncEngine={_i:Vo.bind(null,t),mi:Ko.bind(null,t),gi:Go.bind(null,t),pn:zo.bind(null,t),wi:jo.bind(null,t)},await this.sharedClientState.start()),await this.persistence.nn(async e=>{await async function(e,t){const n=b(e);if(Ho(n),Wo(n),!0===t&&!0!==n.qo){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await qo(n,e.toArray());n.qo=!0,await Ws(n.remoteStore,!0);for(const r of t)Ss(n.remoteStore,r)}else if(!1===t&&!1!==n.qo){const e=[];let t=Promise.resolve();n.ko.forEach((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then(()=>(Co(n,i),Fi(n.localStore,i,!0))),ks(n.remoteStore,i)}),await t,await qo(n,e),function(e){const t=b(e);t.Fo.forEach((e,n)=>{ks(t.remoteStore,n)}),t.Mo.us(),t.Fo=new Map,t.Oo=new Vt(re.comparator)}(n),n.qo=!1,await Ws(n.remoteStore,!1)}}(this.Jo.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):e||this.gcScheduler.stop())})}Wo(e){const t=fs();if(!os.bt(t))throw new _(I.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=Si(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new os(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class Yo{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Eo(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Mo.bind(null,this.syncEngine),await Ws(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new no}createDatastore(e){const t=ms(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new ds(r));var r;return function(e,t,n){return new bs(e,t,n)}(e.credentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>Eo(this.syncEngine,e,0),s=us.bt()?new us:new cs,new _s(t,n,r,i,s);var t,n,r,i,s}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new wo(e,t,n,r,i,s);return o&&(a.qo=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=b(e);f("RemoteStore","RemoteStore shutting down."),t.Kr.add(5),await Es(t),t.Qr.shutdown(),t.Wr.set("Unknown")}(this.remoteStore)}}function Xo(e,t=10240){let n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}class Zo{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Yo(this.observer.next,e)}error(e){this.observer.error?this.Yo(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Xo(){this.muted=!0}Yo(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class ea{constructor(e,t){this.Zo=e,this.N=t,this.metadata=new T,this.buffer=new Uint8Array,this.ta=new TextDecoder("utf-8"),this.ea().then(e=>{e&&e.ho()?this.metadata.resolve(e.payload.metadata):this.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==e?void 0:e.payload)))},e=>this.metadata.reject(e))}close(){return this.Zo.cancel()}async getMetadata(){return this.metadata.promise}async Qo(){return await this.getMetadata(),this.ea()}async ea(){const e=await this.na();if(null===e)return null;const t=this.ta.decode(e),n=Number(t);isNaN(n)&&this.sa(`length string (${t}) is not valid number`);const r=await this.ia(n);return new uo(JSON.parse(r),e.length+n)}ra(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async na(){for(;this.ra()<0&&!await this.oa(););if(0===this.buffer.length)return null;const e=this.ra();e<0&&this.sa("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async ia(e){for(;this.buffer.length<e;)await this.oa()&&this.sa("Reached the end of bundle when more is expected.");const t=this.ta.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}sa(e){throw this.Zo.cancel(),new Error("Invalid bundle format: "+e)}async oa(){const e=await this.Zo.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class ta{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new _(I.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(e,t){const n=b(e),r=En(n.N)+"/documents",i={documents:t.map(e=>bn(n.N,e))},s=await n.Ki("BatchGetDocuments",r,i),o=new Map;s.forEach(e=>{const t=function(e,t){return"found"in t?function(e,t){v(!!t.found),t.found.name,t.found.updateTime;const n=In(e,t.found.name),r=yn(t.found.updateTime),i=new ye({mapValue:{fields:t.found.fields}});return we.newFoundDocument(n,r,i)}(e,t):"missing"in t?function(e,t){v(!!t.missing),v(!!t.readTime);const n=In(e,t.missing),r=yn(t.readTime);return we.newNoDocument(n,r)}(e,t):y()}(n.N,e);o.set(t.key.toString(),t)});const a=[];return t.forEach(e=>{const t=o.get(e.toString());v(!!t),a.push(t)}),a}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new Pt(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{const n=re.fromPath(t);this.mutations.push(new Lt(n,this.precondition(n)))}),await async function(e,t){const n=b(e),r=En(n.N)+"/documents",i={writes:t.map(e=>Nn(n.N,e))};await n.Li("Commit",r,i)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw y();t=F.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new _(I.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?bt.updateTime(t):bt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(F.min()))throw new _(I.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return bt.updateTime(t)}return bt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class na{constructor(e,t,n,r){this.asyncQueue=e,this.datastore=t,this.updateFunction=n,this.deferred=r,this.aa=5,this.rr=new gs(this.asyncQueue,"transaction_retry")}run(){this.aa-=1,this.ca()}ca(){this.rr.Xi(async()=>{const e=new ta(this.datastore),t=this.ua(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.ha(e)}))}).catch(e=>{this.ha(e)})})}ua(e){try{const t=this.updateFunction(e);return!ee(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}ha(e){this.aa>0&&this.la(e)?(this.aa-=1,this.asyncQueue.enqueueAndForget(()=>(this.ca(),Promise.resolve()))):this.deferred.reject(e)}la(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!Ut(t)}return!1}}class ra{constructor(e,t,n){this.credentials=e,this.asyncQueue=t,this.databaseInfo=n,this.user=c.UNAUTHENTICATED,this.clientId=R.I(),this.credentialListener=()=>Promise.resolve(),this.credentials.start(t,async e=>{f("FirestoreClient","Received user=",e.uid),await this.credentialListener(e),this.user=e})}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.credentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new _(I.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new T;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.credentials.shutdown(),e.resolve()}catch(t){const n=Ys(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function ia(e,t){e.asyncQueue.verifyOperationInProgress(),f("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Ri(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e.offlineComponents=t}async function sa(e,t){e.asyncQueue.verifyOperationInProgress();const n=await oa(e);f("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener(e=>async function(e,t){const n=b(e);n.asyncQueue.verifyOperationInProgress(),f("RemoteStore","RemoteStore received new credentials");const r=Ds(n);n.Kr.add(3),await Es(n),r&&n.Wr.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Kr.delete(3),await Ts(n)}(t.remoteStore,e)),e.onlineComponents=t}async function oa(e){return e.offlineComponents||(f("FirestoreClient","Using default OfflineComponentProvider"),await ia(e,new $o)),e.offlineComponents}async function aa(e){return e.onlineComponents||(f("FirestoreClient","Using default OnlineComponentProvider"),await sa(e,new Yo)),e.onlineComponents}function ca(e){return oa(e).then(e=>e.persistence)}function ua(e){return oa(e).then(e=>e.localStore)}function ha(e){return aa(e).then(e=>e.remoteStore)}function la(e){return aa(e).then(e=>e.syncEngine)}async function da(e){const t=await aa(e),n=t.eventManager;return n.onListen=bo.bind(null,t.syncEngine),n.onUnlisten=_o.bind(null,t.syncEngine),n}function fa(e,t,n={}){const r=new T;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new Zo({next:s=>{t.enqueueAndForget(()=>io(e,o));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new _(I.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new _(I.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new co(Be(n.path),s,{includeMetadataChanges:!0,uo:!0});return ro(e,o)}(await da(e),e.asyncQueue,t,n,r)),r.promise}function pa(e,t,n={}){const r=new T;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new Zo({next:n=>{t.enqueueAndForget(()=>io(e,o)),n.fromCache&&"server"===r.source?i.reject(new _(I.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new co(n,s,{includeMetadataChanges:!0,uo:!0});return ro(e,o)}(await da(e),e.asyncQueue,t,n,r)),r.promise}function ma(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?(new TextEncoder).encode(e):e,function(e,t){return new ea(e,t)}(function(e,t){if(e instanceof Uint8Array)return Xo(e,t);if(e instanceof ArrayBuffer)return Xo(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}(n,ms(t));e.asyncQueue.enqueueAndForget(async()=>{!function(e,t,n){const r=b(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=b(e),r=yn(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",e=>n.Je.getBundleMetadata(e,t.id)).then(e=>!!e&&e.createTime.compareTo(r)>=0)}(e.localStore,r))return await t.close(),void n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r));n._updateProgress(fo(r));const i=new lo(r,e.localStore,t.N);let s=await t.Qo();for(;s;){const e=await i.fo(s);e&&n._updateProgress(e),s=await t.Qo()}const o=await i.complete();await xo(e,o.Tn,void 0),await function(e,t){const n=b(e);return n.persistence.runTransaction("Save bundle","readwrite",e=>n.Je.saveBundleMetadata(e,t))}(e.localStore,r),n._completeWith(o.progress)}catch(e){m("SyncEngine","Loading bundle failed with "+e),n._failWith(e)}})(r,t,n).then(()=>{r.sharedClientState.notifyBundleLoaded()})}(await la(e),i,r)})}class ga{constructor(e,t,n,r,i,s,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class ya{constructor(e,t){this.projectId=e,this.database=t||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof ya&&e.projectId===this.projectId&&e.database===this.database}}const va=new Map;function wa(e,t,n){if(!n)throw new _(I.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function ba(e,t,n,r){if(!0===t&&!0===r)throw new _(I.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Ia(e){if(!re.isDocumentKey(e))throw new _(I.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function _a(e){if(re.isDocumentKey(e))throw new _(I.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Ta(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){if(e.constructor){const t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":y()}function Ea(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new _(I.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ta(e);throw new _(I.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Sa(e,t){if(t<=0)throw new _(I.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class ka{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new _(I.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new _(I.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,ba("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Aa{constructor(e,t){this._credentials=t,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ka({}),this._settingsFrozen=!1,e instanceof ya?this._databaseId=e:(this._app=e,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new _(I.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ya(e.options.projectId)}(e))}get app(){if(!this._app)throw new _(I.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new _(I.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ka(e),void 0!==e.credentials&&(this._credentials=function(e){if(!e)return new S;switch(e.type){case"gapi":e.client;return v(!("object"!=typeof r._removeServiceInstance||null===r._removeServiceInstance||!r._removeServiceInstance.auth||!r._removeServiceInstance.auth.getAuthHeaderValueForFirstParty)),new O(r._removeServiceInstance,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new _(I.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=va.get(e);t&&(f("ComponentProvider","Removing Datastore"),va.delete(e),t.terminate())}(this),Promise.resolve()}}function Na(e,t,n,r={}){var i;const s=(e=Ea(e,Aa))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==t&&m("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},s),{host:`${t}:${n}`,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=c.MOCK_USER;else{t=Object(o.f)(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new _(I.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new c(s)}e._credentials=new k(new E(t,n))}}class Oa{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Da(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Oa(this.firestore,e,this._key)}}class Ca{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ca(this.firestore,e,this._query)}}class Da extends Ca{constructor(e,t,n){super(e,t,Be(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Oa(this.firestore,null,new re(e))}withConverter(e){return new Da(this.firestore,e,this._path)}}function Ra(e,t,...n){if(e=Object(o.k)(e),wa("collection","path",t),e instanceof Aa){const r=B.fromString(t,...n);return _a(r),new Da(e,null,r)}{if(!(e instanceof Oa||e instanceof Da))throw new _(I.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(B.fromString(t,...n));return _a(r),new Da(e.firestore,null,r)}}function Pa(e,t){if(e=Ea(e,Aa),wa("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new _(I.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ca(e,null,function(e){return new Ve(B.emptyPath(),e)}(t))}function La(e,t,...n){if(e=Object(o.k)(e),1===arguments.length&&(t=R.I()),wa("doc","path",t),e instanceof Aa){const r=B.fromString(t,...n);return Ia(r),new Oa(e,null,new re(r))}{if(!(e instanceof Oa||e instanceof Da))throw new _(I.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(B.fromString(t,...n));return Ia(r),new Oa(e.firestore,e instanceof Da?e.converter:null,new re(r))}}function xa(e,t){return e=Object(o.k)(e),t=Object(o.k)(t),(e instanceof Oa||e instanceof Da)&&(t instanceof Oa||t instanceof Da)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function Ma(e,t){return e=Object(o.k)(e),t=Object(o.k)(t),e instanceof Ca&&t instanceof Ca&&e.firestore===t.firestore&&Ye(e._query,t._query)&&e.converter===t.converter}class Fa{constructor(){this.fa=Promise.resolve(),this.da=[],this.wa=!1,this._a=[],this.ma=null,this.ga=!1,this.ya=!1,this.pa=[],this.rr=new gs(this,"async_queue_retry"),this.Ea=()=>{const e=ps();e&&f("AsyncQueue","Visibility state changed to "+e.visibilityState),this.rr.tr()};const e=ps();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ea)}get isShuttingDown(){return this.wa}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ta(),this.Ia(e)}enterRestrictedMode(e){if(!this.wa){this.wa=!0,this.ya=e||!1;const t=ps();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ea)}}enqueue(e){if(this.Ta(),this.wa)return new Promise(()=>{});const t=new T;return this.Ia(()=>this.wa&&this.ya?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.da.push(e),this.Aa()))}async Aa(){if(0!==this.da.length){try{await this.da[0](),this.da.shift(),this.rr.reset()}catch(Ru){if(!yr(Ru))throw Ru;f("AsyncQueue","Operation failed with retryable error: "+Ru)}this.da.length>0&&this.rr.Xi(()=>this.Aa())}}Ia(e){const t=this.fa.then(()=>(this.ga=!0,e().catch(e=>{throw this.ma=e,this.ga=!1,p("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e}).then(e=>(this.ga=!1,e))));return this.fa=t,t}enqueueAfterDelay(e,t,n){this.Ta(),this.pa.indexOf(e)>-1&&(t=0);const r=Js.createAndSchedule(this,e,t,n,e=>this.Ra(e));return this._a.push(r),r}Ta(){this.ma&&y()}verifyOperationInProgress(){}async ba(){let e;do{e=this.fa,await e}while(e!==this.fa)}Pa(e){for(const t of this._a)if(t.timerId===e)return!0;return!1}va(e){return this.ba().then(()=>{this._a.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this._a)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.ba()})}Va(e){this.pa.push(e)}Ra(e){const t=this._a.indexOf(e);this._a.splice(t,1)}}function Ua(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of["next","error","complete"])if(r in n&&"function"==typeof n[r])return!0;return!1}(e)}class ja{constructor(){this._progressObserver={},this._taskCompletionResolver=new T,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const Va=-1;class qa extends Aa{constructor(e,t){super(e,t),this.type="firestore",this._queue=new Fa,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||za(this),this._firestoreClient.terminate()}}function Ba(e){return e._firestoreClient||za(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function za(e){var t;const n=e._freezeSettings(),r=function(e,t,n,r){return new ga(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new ra(e._credentials,e._queue,r)}function Ka(e,t){Za(e=Ea(e,qa));const n=Ba(e),r=e._freezeSettings(),i=new Yo;return Ha(n,i,new Qo(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}function Ga(e){Za(e=Ea(e,qa));const t=Ba(e),n=e._freezeSettings(),r=new Yo;return Ha(t,r,new Jo(r,n.cacheSizeBytes))}function Ha(e,t,n){const r=new T;return e.asyncQueue.enqueue(async()=>{try{await ia(e,n),await sa(e,t),r.resolve()}catch(e){if(!function(e){return"FirebaseError"===e.name?e.code===I.FAILED_PRECONDITION||e.code===I.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||(22===e.code||20===e.code||11===e.code)}(e))throw e;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),r.reject(e)}}).then(()=>r.promise)}function Wa(e){if(e._initialized&&!e._terminated)throw new _(I.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new T;return e._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(e){if(!pr.bt())return Promise.resolve();const t=e+"main";await pr.delete(t)}(Si(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}}),t.promise}function $a(e){return function(e){const t=new T;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t){const n=b(e);Ds(n.remoteStore)||f("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=b(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",e=>t.In.getHighestUnacknowledgedBatchId(e))}(n.localStore);if(-1===e)return void t.resolve();const r=n.Bo.get(e)||[];r.push(t),n.Bo.set(e,r)}catch(e){const n=Ys(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await la(e),t)),t.promise}(Ba(e=Ea(e,qa)))}function Qa(e){return function(e){return e.asyncQueue.enqueue(async()=>{const t=await ca(e),n=await ha(e);return t.setNetworkEnabled(!0),function(e){const t=b(e);return t.Kr.delete(0),Ts(t)}(n)})}(Ba(e=Ea(e,qa)))}function Ja(e){return function(e){return e.asyncQueue.enqueue(async()=>{const t=await ca(e),n=await ha(e);return t.setNetworkEnabled(!1),async function(e){const t=b(e);t.Kr.add(0),await Es(t),t.Wr.set("Offline")}(n)})}(Ba(e=Ea(e,qa)))}function Ya(e,t){const n=Ba(e=Ea(e,qa)),r=new ja;return ma(n,e._databaseId,t,r),r}function Xa(e,t){return function(e,t){return e.asyncQueue.enqueue(async()=>function(e,t){const n=b(e);return n.persistence.runTransaction("Get named query","readonly",e=>n.Je.getNamedQuery(e,t))}(await ua(e),t))}(Ba(e=Ea(e,qa)),t).then(t=>t?new Ca(e,null,t.query):null)}function Za(e){if(e._initialized||e._terminated)throw new _(I.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class ec{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new _(I.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new K(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class tc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new tc(W.fromBase64String(e))}catch(e){throw new _(I.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new tc(W.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class nc{constructor(e){this._methodName=e}}class rc{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new _(I.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new _(I.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return P(this._lat,e._lat)||P(this._long,e._long)}}const ic=/^__.*__$/;class sc{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Ot(e,this.data,this.fieldMask,t,this.fieldTransforms):new Nt(e,this.data,t,this.fieldTransforms)}}class oc{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ot(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function ac(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw y()}}class cc{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.N=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Sa(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Da(){return this.settings.Da}Ca(e){return new cc(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.N,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Na(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Ca({path:n,xa:!1});return r.ka(e),r}$a(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Ca({path:n,xa:!1});return r.Sa(),r}Oa(e){return this.Ca({path:void 0,xa:!0})}Fa(e){return Nc(e,this.settings.methodName,this.settings.Ma||!1,this.path,this.settings.La)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Sa(){if(this.path)for(let e=0;e<this.path.length;e++)this.ka(this.path.get(e))}ka(e){if(0===e.length)throw this.Fa("Document fields must not be empty");if(ac(this.Da)&&ic.test(e))throw this.Fa('Document fields cannot begin and end with "__"')}}class uc{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.N=n||ms(e)}Ba(e,t,n,r=!1){return new cc({Da:e,methodName:t,La:n,path:K.emptyPath(),xa:!1,Ma:r},this.databaseId,this.N,this.ignoreUndefinedProperties)}}function hc(e){const t=e._freezeSettings(),n=ms(e._databaseId);return new uc(e._databaseId,!!t.ignoreUndefinedProperties,n)}function lc(e,t,n,r,i,s={}){const o=e.Ba(s.merge||s.mergeFields?2:0,t,n,i);Ec("Data must be an object, but it was:",o,r);const a=_c(r,o);let c,u;if(s.merge)c=new G(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=Sc(t,r,n);if(!o.contains(i))throw new _(I.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Oc(e,i)||e.push(i)}c=new G(e),u=o.fieldTransforms.filter(e=>c.covers(e.field))}else c=null,u=o.fieldTransforms;return new sc(new ye(a),c,u)}class dc extends nc{_toFieldTransform(e){if(2!==e.Da)throw 1===e.Da?e.Fa(this._methodName+"() can only appear at the top level of your update data"):e.Fa(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof dc}}function fc(e,t,n){return new cc({Da:3,La:t.settings.La,methodName:e._methodName,xa:n},t.databaseId,t.N,t.ignoreUndefinedProperties)}class pc extends nc{_toFieldTransform(e){return new vt(e.path,new ht)}isEqual(e){return e instanceof pc}}class mc extends nc{constructor(e,t){super(e),this.Ua=t}_toFieldTransform(e){const t=fc(this,e,!0),n=this.Ua.map(e=>Ic(e,t)),r=new lt(n);return new vt(e.path,r)}isEqual(e){return this===e}}class gc extends nc{constructor(e,t){super(e),this.Ua=t}_toFieldTransform(e){const t=fc(this,e,!0),n=this.Ua.map(e=>Ic(e,t)),r=new ft(n);return new vt(e.path,r)}isEqual(e){return this===e}}class yc extends nc{constructor(e,t){super(e),this.qa=t}_toFieldTransform(e){const t=new mt(e.N,st(e.N,this.qa));return new vt(e.path,t)}isEqual(e){return this===e}}function vc(e,t,n,r){const i=e.Ba(1,t,n);Ec("Data must be an object, but it was:",i,r);const s=[],a=ye.empty();j(r,(e,r)=>{const c=Ac(t,e,n);r=Object(o.k)(r);const u=i.$a(c);if(r instanceof dc)s.push(c);else{const e=Ic(r,u);null!=e&&(s.push(c),a.set(c,e))}});const c=new G(s);return new oc(a,c,i.fieldTransforms)}function wc(e,t,n,r,i,s){const a=e.Ba(1,t,n),c=[Sc(t,r,n)],u=[i];if(s.length%2!=0)throw new _(I.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let o=0;o<s.length;o+=2)c.push(Sc(t,s[o])),u.push(s[o+1]);const h=[],l=ye.empty();for(let f=c.length-1;f>=0;--f)if(!Oc(h,c[f])){const e=c[f];let t=u[f];t=Object(o.k)(t);const n=a.$a(e);if(t instanceof dc)h.push(e);else{const r=Ic(t,n);null!=r&&(h.push(e),l.set(e,r))}}const d=new G(h);return new oc(l,d,a.fieldTransforms)}function bc(e,t,n,r=!1){return Ic(n,e.Ba(r?4:3,t))}function Ic(e,t){if(Tc(e=Object(o.k)(e)))return Ec("Unsupported field value:",t,e),_c(e,t);if(e instanceof nc)return function(e,t){if(!ac(t.Da))throw t.Fa(e._methodName+"() can only be used with update() and set()");if(!t.path)throw t.Fa(e._methodName+"() is not currently supported inside arrays");const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xa&&4!==t.Da)throw t.Fa("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=Ic(i,t.Oa(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Object(o.k)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return st(t.N,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=M.fromDate(e);return{timestampValue:pn(t.N,n)}}if(e instanceof M){const n=new M(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:pn(t.N,n)}}if(e instanceof rc)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof tc)return{bytesValue:mn(t.N,e._byteString)};if(e instanceof Oa){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Fa(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:vn(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Fa("Unsupported field value: "+Ta(e))}(e,t)}function _c(e,t){const n={};return V(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):j(e,(e,r)=>{const i=Ic(r,t.Na(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function Tc(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof M||e instanceof rc||e instanceof tc||e instanceof Oa||e instanceof nc)}function Ec(e,t,n){if(!Tc(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Ta(n);throw"an object"===r?t.Fa(e+" a custom object"):t.Fa(e+" "+r)}}function Sc(e,t,n){if((t=Object(o.k)(t))instanceof ec)return t._internalPath;if("string"==typeof t)return Ac(e,t);throw Nc("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}const kc=new RegExp("[~\\*/\\[\\]]");function Ac(e,t,n){if(t.search(kc)>=0)throw Nc(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new ec(...t.split("."))._internalPath}catch(r){throw Nc(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Nc(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=" in field "+r),o&&(c+=" in document "+i),c+=")"),new _(I.INVALID_ARGUMENT,a+e+c)}function Oc(e,t){return e.some(e=>e.isEqual(t))}class Cc{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Oa(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Dc(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Rc("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Dc extends Cc{data(){return super.data()}}function Rc(e,t){return"string"==typeof t?Ac(e,t):t instanceof ec?t._internalPath:t._delegate._internalPath}class Pc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Lc extends Cc{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new xc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Rc("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class xc extends Lc{data(e={}){return super.data(e)}}class Mc{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Pc(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new xc(this._firestore,this._userDataWriter,n.key,n,new Pc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new _(I.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>({type:"added",doc:new xc(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Pc(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:t++}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new xc(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Pc(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Fc(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Fc(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return y()}}function Uc(e,t){return e instanceof Lc&&t instanceof Lc?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Mc&&t instanceof Mc&&e._firestore===t._firestore&&Ma(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function jc(e){if(Ke(e)&&0===e.explicitOrderBy.length)throw new _(I.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Vc{}function qc(e,...t){for(const n of t)e=n._apply(e);return e}class Bc extends Vc{constructor(e,t,n){super(),this.Ka=e,this.ja=t,this.Qa=n,this.type="where"}_apply(e){const t=hc(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new _(I.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on FieldPath.documentId().`);if("in"===s||"not-in"===s){ru(o,s);const t=[];for(const n of o)t.push(nu(r,e,n));a={arrayValue:{values:t}}}else a=nu(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||ru(o,s),a=bc(n,"where",o,"in"===s||"not-in"===s);const c=Se.create(i,s,a);return function(e,t){if(t.v()){const n=He(e);if(null!==n&&!n.isEqual(t.field))throw new _(I.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${t.field.toString()}'`);const r=Ge(e);null!==r&&iu(e,t.field,r)}const n=function(e,t){for(const n of e.filters)if(t.indexOf(n.op)>=0)return n.op;return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new _(I.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new _(I.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}(e,c),c}(e._query,0,t,e.firestore._databaseId,this.Ka,this.ja,this.Qa);return new Ca(e.firestore,e.converter,function(e,t){const n=e.filters.concat([t]);return new Ve(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))}}function zc(e,t,n){const r=t,i=Rc("where",e);return new Bc(i,r,n)}class Kc extends Vc{constructor(e,t){super(),this.Ka=e,this.Wa=t,this.type="orderBy"}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new _(I.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new _(I.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new Me(t,n);return function(e,t){if(null===Ge(e)){const n=He(e);null!==n&&iu(e,n,t.field)}}(e,r),r}(e._query,this.Ka,this.Wa);return new Ca(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Ve(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Gc(e,t="asc"){const n=t,r=Rc("orderBy",e);return new Kc(r,n)}class Hc extends Vc{constructor(e,t,n){super(),this.type=e,this.Ga=t,this.za=n}_apply(e){return new Ca(e.firestore,e.converter,Je(e._query,this.Ga,this.za))}}function Wc(e){return Sa("limit",e),new Hc("limit",e,"F")}function $c(e){return Sa("limitToLast",e),new Hc("limitToLast",e,"L")}class Qc extends Vc{constructor(e,t,n){super(),this.type=e,this.Ha=t,this.Ja=n}_apply(e){const t=tu(e,this.type,this.Ha,this.Ja);return new Ca(e.firestore,e.converter,function(e,t){return new Ve(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}function Jc(...e){return new Qc("startAt",e,!0)}function Yc(...e){return new Qc("startAfter",e,!1)}class Xc extends Vc{constructor(e,t,n){super(),this.type=e,this.Ha=t,this.Ja=n}_apply(e){const t=tu(e,this.type,this.Ha,this.Ja);return new Ca(e.firestore,e.converter,function(e,t){return new Ve(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function Zc(...e){return new Xc("endBefore",e,!0)}function eu(...e){return new Xc("endAt",e,!1)}function tu(e,t,n,r){if(n[0]=Object(o.k)(n[0]),n[0]instanceof Cc)return function(e,t,n,r,i){if(!r)throw new _(I.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const o of $e(e))if(o.field.isKeyField())s.push(he(t,r.key));else{const e=r.data.field(o.field);if(X(e))throw new _(I.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=o.field.canonicalString();throw new _(I.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new Le(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=hc(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new _(I.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let c=0;c<i.length;c++){const s=i[c];if(o[c].field.isKeyField()){if("string"!=typeof s)throw new _(I.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof s}`);if(!We(e)&&-1!==s.indexOf("/"))throw new _(I.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${r}() must be a plain document ID, but '${s}' contains a slash.`);const n=e.path.child(B.fromString(s));if(!re.isDocumentKey(n))throw new _(I.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new re(n);a.push(he(t,i))}else{const e=bc(n,r,s);a.push(e)}}return new Le(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function nu(e,t,n){if("string"==typeof(n=Object(o.k)(n))){if(""===n)throw new _(I.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!We(t)&&-1!==n.indexOf("/"))throw new _(I.INVALID_ARGUMENT,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(B.fromString(n));if(!re.isDocumentKey(r))throw new _(I.INVALID_ARGUMENT,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return he(e,new re(r))}if(n instanceof Oa)return he(e,n._key);throw new _(I.INVALID_ARGUMENT,`Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ta(n)}.`)}function ru(e,t){if(!Array.isArray(e)||0===e.length)throw new _(I.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(e.length>10)throw new _(I.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function iu(e,t,n){if(!n.isEqual(t))throw new _(I.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class su{convertValue(e,t="none"){switch(ie(e)){case 0:return null;case 1:return e.booleanValue;case 2:return J(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Y(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw y()}}convertObject(e,t){const n={};return j(e.fields,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertGeoPoint(e){return new rc(J(e.latitude),J(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":(function e(t){const n=t.mapValue.fields.__previous_value__;return X(n)?e(n):n})(e);return null==r._registerComponent?null:this.convertValue(r._registerComponent,t);case"estimate":return this.convertTimestamp(Z(e));default:return null}}convertTimestamp(e){const t=Q(e);return new M(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=B.fromString(e);v(Bn(n));const r=new ya(n.get(1),n.get(3)),i=new re(n.popFirst(5));return r.isEqual(t)||p(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function ou(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class au extends su{constructor(e){super(),this.firestore=e}convertBytes(e){return new tc(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Oa(this.firestore,null,t)}}class cu{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=hc(e)}set(e,t,n){this._verifyNotCommitted();const r=uu(e,this._firestore),i=ou(r.converter,t,n),s=lc(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,bt.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=uu(e,this._firestore);let s;return s="string"==typeof(t=Object(o.k)(t))||t instanceof ec?wc(this._dataReader,"WriteBatch.update",i._key,t,n,r):vc(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(s.toMutation(i._key,bt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=uu(e,this._firestore);return this._mutations=this._mutations.concat(new Pt(t._key,bt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new _(I.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function uu(e,t){if((e=Object(o.k)(e)).firestore!==t)throw new _(I.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function hu(e){e=Ea(e,Oa);const t=Ea(e.firestore,qa);return fa(Ba(t),e._key).then(n=>Eu(t,e,n))}class lu extends su{constructor(e){super(),this.firestore=e}convertBytes(e){return new tc(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Oa(this.firestore,null,t)}}function du(e){e=Ea(e,Oa);const t=Ea(e.firestore,qa),n=Ba(t),r=new lu(t);return function(e,t){const n=new T;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){try{const r=await function(e,t){const n=b(e);return n.persistence.runTransaction("read document","readonly",e=>n.Qn.An(e,t))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new _(I.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=Ys(e,`Failed to get document '${t} from cache`);n.reject(r)}}(await ua(e),t,n)),n.promise}(n,e._key).then(n=>new Lc(t,r,e._key,n,new Pc(null!==n&&n.hasLocalMutations,!0),e.converter))}function fu(e){e=Ea(e,Oa);const t=Ea(e.firestore,qa);return fa(Ba(t),e._key,{source:"server"}).then(n=>Eu(t,e,n))}function pu(e){e=Ea(e,Ca);const t=Ea(e.firestore,qa),n=Ba(t),r=new lu(t);return jc(e._query),pa(n,e._query).then(n=>new Mc(t,r,e,n))}function mu(e){e=Ea(e,Ca);const t=Ea(e.firestore,qa),n=Ba(t),r=new lu(t);return function(e,t){const n=new T;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){try{const r=await Ui(e,t,!0),i=new go(t,r.Gn),s=i.Io(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(e){const r=Ys(e,`Failed to execute query '${t} against cache`);n.reject(r)}}(await ua(e),t,n)),n.promise}(n,e._query).then(n=>new Mc(t,r,e,n))}function gu(e){e=Ea(e,Ca);const t=Ea(e.firestore,qa),n=Ba(t),r=new lu(t);return pa(n,e._query,{source:"server"}).then(n=>new Mc(t,r,e,n))}function yu(e,t,n){e=Ea(e,Oa);const r=Ea(e.firestore,qa),i=ou(e.converter,t,n);return Tu(r,[lc(hc(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,bt.none())])}function vu(e,t,n,...r){e=Ea(e,Oa);const i=Ea(e.firestore,qa),s=hc(i);let a;return a="string"==typeof(t=Object(o.k)(t))||t instanceof ec?wc(s,"updateDoc",e._key,t,n,r):vc(s,"updateDoc",e._key,t),Tu(i,[a.toMutation(e._key,bt.exists(!0))])}function wu(e){return Tu(Ea(e.firestore,qa),[new Pt(e._key,bt.none())])}function bu(e,t){const n=Ea(e.firestore,qa),r=La(e),i=ou(e.converter,t);return Tu(n,[lc(hc(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,bt.exists(!1))]).then(()=>r)}function Iu(e,...t){var n,r,i;e=Object(o.k)(e);let s={includeMetadataChanges:!1},a=0;"object"!=typeof t[a]||Ua(t[a])||(s=t[a],a++);const c={includeMetadataChanges:s.includeMetadataChanges};if(Ua(t[a])){const e=t[a];t[a]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[a+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[a+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let u,h,l;if(e instanceof Oa)h=Ea(e.firestore,qa),l=Be(e._key.path),u={next:n=>{t[a]&&t[a](Eu(h,e,n))},error:t[a+1],complete:t[a+2]};else{const n=Ea(e,Ca);h=Ea(n.firestore,qa),l=n._query;const r=new lu(h);u={next:e=>{t[a]&&t[a](new Mc(h,r,n,e))},error:t[a+1],complete:t[a+2]},jc(e._query)}return function(e,t,n,r){const i=new Zo(r),s=new co(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>ro(await da(e),s)),()=>{i.Xo(),e.asyncQueue.enqueueAndForget(async()=>io(await da(e),s))}}(Ba(h),l,c,u)}function _u(e,t){return function(e,t){const n=new Zo(t);return e.asyncQueue.enqueueAndForget(async()=>function(e,t){b(e).Zr.add(t),t.next()}(await da(e),n)),()=>{n.Xo(),e.asyncQueue.enqueueAndForget(async()=>function(e,t){b(e).Zr.delete(t)}(await da(e),n))}}(Ba(e=Ea(e,qa)),Ua(t)?t:{next:t})}function Tu(e,t){return function(e,t){const n=new T;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=Wo(e);try{const e=await function(e,t){const n=b(e),r=M.now(),i=t.reduce((e,t)=>e.add(t.key),Xt());let s;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>n.Qn.Pn(e,i).next(i=>{s=i;const o=[];for(const e of t){const t=St(e,s.get(e.key));null!=t&&o.push(new Ot(e.key,t,ve(t.value.mapValue),bt.exists(!0)))}return n.In.addMutationBatch(e,r,o,t)})).then(e=>(e.applyToLocalDocumentSet(s),{batchId:e.batchId,changes:s}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Lo[e.currentUser.toKey()];r||(r=new Vt(P)),r=r.insert(t,n),e.Lo[e.currentUser.toKey()]=r}(r,e.batchId,n),await xo(r,e.changes),await Us(r.remoteStore)}catch(e){const t=Ys(e,"Failed to persist write");n.reject(t)}}(await la(e),t,n)),n.promise}(Ba(e),t)}function Eu(e,t,n){const r=n.docs.get(t._key),i=new lu(e);return new Lc(e,i,t._key,r,new Pc(n.hasPendingWrites,n.fromCache),t.converter)}class Su extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=hc(e)}get(e){const t=uu(e,this._firestore),n=new au(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return y();const r=e[0];if(r.isFoundDocument())return new Cc(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new Cc(this._firestore,n,t._key,null,t.converter);throw y()})}set(e,t,n){const r=uu(e,this._firestore),i=ou(r.converter,t,n),s=lc(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n,...r){const i=uu(e,this._firestore);let s;return s="string"==typeof(t=Object(o.k)(t))||t instanceof ec?wc(this._dataReader,"Transaction.update",i._key,t,n,r):vc(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,s),this}delete(e){const t=uu(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=uu(e,this._firestore),n=new lu(this._firestore);return super.get(e).then(e=>new Lc(this._firestore,n,t._key,e._document,new Pc(!1,!1),t.converter))}}function ku(e,t){return function(e,t){const n=new T;return e.asyncQueue.enqueueAndForget(async()=>{const r=await function(e){return aa(e).then(e=>e.datastore)}(e);new na(e.asyncQueue,r,t,n).run()}),n.promise}(Ba(e),n=>t(new Su(e,n)))}function Au(){return new dc("deleteField")}function Nu(){return new pc("serverTimestamp")}function Ou(...e){return new mc("arrayUnion",e)}function Cu(...e){return new gc("arrayRemove",e)}function Du(e){return new yc("increment",e)}var Ru;Ru=r.SDK_VERSION,u=Ru,Object(r._registerComponent)(new i.a("firestore",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=new qa(n,new A(e.getProvider("auth-internal")));return t=Object.assign({useFetchStreams:!0},t),r._setSettings(t),r},"PUBLIC")),Object(r.registerVersion)("@firebase/firestore","3.0.2",void 0)}).call(this,n(26))},43:function(e,t,n){"use strict";n(44)},44:function(e,t,n){"use strict";(function(e){var t=n(14),r=n(2),i=n(9),s=n(1);function o(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function a(e=Object(s.l)()){return!("file:"!==o()&&"ionic:"!==o()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function c(e=Object(s.l)()){return Object(s.q)()&&11===(null===document||void 0===document?void 0:document.documentMode)||function(e=Object(s.l)()){return/Edge\/\d+/.test(e)}(e)}function u(){try{const e=self.localStorage,t=r.r();if(e)return e.setItem(t,"1"),e.removeItem(t),!c()||Object(s.r)()}catch(e){return h()&&Object(s.r)()}return!1}function h(){return"undefined"!==typeof e&&"WorkerGlobalScope"in e&&"importScripts"in e}function l(){return("http:"===o()||"https:"===o()||Object(s.n)()||a())&&!(Object(s.u)()||Object(s.t)())&&u()&&!h()}function d(){return a()&&"undefined"!==typeof document}const f={LOCAL:"local",NONE:"none",SESSION:"session"},p=r.o;async function m(e){await e._initializationPromise;const t=g(),n=r.u("persistence",e.config.apiKey,e.name);(null===t||void 0===t?void 0:t.sessionStorage)&&t.sessionStorage.setItem(n,e._getPersistence())}function g(){return"undefined"!==typeof window?window:null}const y=r.o;class v{constructor(){this.browserResolver=r.s(r.y),this.cordovaResolver=r.s(r.D),this.underlyingResolver=null,this._redirectPersistence=r.z,this._completeRedirectFn=r.t}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,r)}async _openRedirect(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,r)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return d()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return y(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await async function(){return!!d()&&new Promise(e=>{const t=setTimeout(()=>{e(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(t),e(!0)})})}();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function w(e){return e.unwrap()}function b(e){const{_tokenResponse:t}=e instanceof s.c?e.customData:e;if(!t)return null;if(!(e instanceof s.c)&&"temporaryProof"in t&&"phoneNumber"in t)return r.i.credentialFromResult(e);const n=t.providerId;if(!n||n===r.k.PASSWORD)return null;let i;switch(n){case r.k.GOOGLE:i=r.f;break;case r.k.FACEBOOK:i=r.d;break;case r.k.GITHUB:i=r.e;break;case r.k.TWITTER:i=r.n;break;default:const{oauthIdToken:e,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=t;return s||o||e||a?a?n.startsWith("saml.")?r.m._create(n,a):r.g._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:e,accessToken:s}):new r.h(n).credential({idToken:e,accessToken:s,rawNonce:c}):null}return e instanceof s.c?i.credentialFromError(e):i.credentialFromResult(e)}async function I(e,t){let n;try{n=await t}catch(c){throw c instanceof s.c&&function(e,t){var n;const i=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===t.code){t.resolver=new T(e,r.I(e,t))}else if(i){const e=b(t),n=t;e&&(n.credential=e,n.tenantId=i.tenantId||void 0,n.email=i.email||void 0,n.phoneNumber=i.phoneNumber||void 0)}}(e,c),c}const{operationType:i,user:o}=n;return{operationType:i,credential:(a=n,b(a)),additionalUserInfo:r.H(n),user:E.getOrCreate(o)};var a}async function _(e,t){const n=await t;return{verificationId:n.verificationId,confirm:t=>I(e,n.confirm(t))}}class T{constructor(e,t){this.resolver=t,this.auth=e.wrapped()}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return I(w(this.auth),this.resolver.resolveSignIn(e))}}class E{constructor(e){this._delegate=e,this.multiFactor=r.R(e)}static getOrCreate(e){return E.USER_MAP.has(e)||E.USER_MAP.set(e,new E(e)),E.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return I(this.auth,r.N(this._delegate,e))}async linkWithPhoneNumber(e,t){return _(this.auth,r.O(this._delegate,e,t))}async linkWithPopup(e){return I(this.auth,r.P(this._delegate,e,v))}async linkWithRedirect(e){return await m(r.p(this.auth)),r.Q(this._delegate,e,v)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return I(this.auth,r.S(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return _(this.auth,r.T(this._delegate,e,t))}reauthenticateWithPopup(e){return I(this.auth,r.U(this._delegate,e,v))}async reauthenticateWithRedirect(e){return await m(r.p(this.auth)),r.V(this._delegate,e,v)}sendEmailVerification(e){return r.W(this._delegate,e)}async unlink(e){return await r.hb(this._delegate,e),this}updateEmail(e){return r.ib(this._delegate,e)}updatePassword(e){return r.jb(this._delegate,e)}updatePhoneNumber(e){return r.kb(this._delegate,e)}updateProfile(e){return r.lb(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return r.mb(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}E.USER_MAP=new WeakMap;const S=r.o;class k{constructor(e,t){if(this.app=e,t.isInitialized())return this._delegate=t.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:n}=e.options;S(n,"invalid-api-key",{appName:e.name});let i=[r.K];if("undefined"!==typeof window){i=function(e,t){const n=g();if(!(null===n||void 0===n?void 0:n.sessionStorage))return[];const i=r.u("persistence",e,t);switch(n.sessionStorage.getItem(i)){case f.NONE:return[r.K];case f.LOCAL:return[r.L,r.z];case f.SESSION:return[r.z];default:return[]}}(n,e.name);for(const e of[r.L,r.x,r.z])i.includes(e)||i.push(e)}S(n,"invalid-api-key",{appName:e.name});const s="undefined"!==typeof window?v:void 0;this._delegate=t.initialize({options:{persistence:i,popupRedirectResolver:s}}),this._delegate._updateErrorMap(r.F),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?E.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){r.C(this._delegate,e,t)}applyActionCode(e){return r.w(this._delegate,e)}checkActionCode(e){return r.A(this._delegate,e)}confirmPasswordReset(e,t){return r.B(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return I(this._delegate,r.E(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return r.G(this._delegate,e)}isSignInWithEmailLink(e){return r.M(this._delegate,e)}async getRedirectResult(){S(l(),this._delegate,"operation-not-supported-in-this-environment");const e=await r.J(this._delegate,v);return e?I(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){r.v(this._delegate,e)}onAuthStateChanged(e,t,n){const{next:r,error:i,complete:s}=A(e,t,n);return this._delegate.onAuthStateChanged(r,i,s)}onIdTokenChanged(e,t,n){const{next:r,error:i,complete:s}=A(e,t,n);return this._delegate.onIdTokenChanged(r,i,s)}sendSignInLinkToEmail(e,t){return r.Y(this._delegate,e,t)}sendPasswordResetEmail(e,t){return r.X(this._delegate,e,t||void 0)}async setPersistence(e){let t;switch(function(e,t){p(Object.values(f).includes(t),e,"invalid-persistence-type"),Object(s.u)()?p(t!==f.SESSION,e,"unsupported-persistence-type"):Object(s.t)()?p(t===f.NONE,e,"unsupported-persistence-type"):h()?p(t===f.NONE||t===f.LOCAL&&Object(s.r)(),e,"unsupported-persistence-type"):p(t===f.NONE||u(),e,"unsupported-persistence-type")}(this._delegate,e),e){case f.SESSION:t=r.z;break;case f.LOCAL:t=await r.s(r.L)._isAvailable()?r.L:r.x;break;case f.NONE:t=r.K;break;default:return r.q("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return I(this._delegate,r.Z(this._delegate))}signInWithCredential(e){return I(this._delegate,r.ab(this._delegate,e))}signInWithCustomToken(e){return I(this._delegate,r.bb(this._delegate,e))}signInWithEmailAndPassword(e,t){return I(this._delegate,r.cb(this._delegate,e,t))}signInWithEmailLink(e,t){return I(this._delegate,r.db(this._delegate,e,t))}signInWithPhoneNumber(e,t){return _(this._delegate,r.eb(this._delegate,e,t))}async signInWithPopup(e){return S(l(),this._delegate,"operation-not-supported-in-this-environment"),I(this._delegate,r.fb(this._delegate,e,v))}async signInWithRedirect(e){return S(l(),this._delegate,"operation-not-supported-in-this-environment"),await m(this._delegate),r.gb(this._delegate,e,v)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return r.nb(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}function A(e,t,n){let r=e;"function"!==typeof e&&({next:r,error:t,complete:n}=e);const i=r;return{next:e=>i(e&&E.getOrCreate(e)),error:t,complete:n}}k.Persistence=f;class N{constructor(){this.providerId="phone",this._delegate=new r.i(w(t.a.auth()))}static credential(e,t){return r.i.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}N.PHONE_SIGN_IN_METHOD=r.i.PHONE_SIGN_IN_METHOD,N.PROVIDER_ID=r.i.PROVIDER_ID;const O=r.o;class C{constructor(e,n,i=t.a.app()){var s;O(null===(s=i.options)||void 0===s?void 0:s.apiKey,"invalid-api-key",{appName:i.name}),this._delegate=new r.l(e,n,i.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}var D;(D=t.a).INTERNAL.registerComponent(new i.a("auth-compat",e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new k(t,n)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:r.a.EMAIL_SIGNIN,PASSWORD_RESET:r.a.PASSWORD_RESET,RECOVER_EMAIL:r.a.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:r.a.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:r.a.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:r.a.VERIFY_EMAIL}},EmailAuthProvider:r.c,FacebookAuthProvider:r.d,GithubAuthProvider:r.e,GoogleAuthProvider:r.f,OAuthProvider:r.h,PhoneAuthProvider:N,PhoneMultiFactorGenerator:r.j,RecaptchaVerifier:C,TwitterAuthProvider:r.n,Auth:k,AuthCredential:r.b,Error:s.c}).setInstantiationMode("LAZY").setMultipleInstances(!1)),D.registerVersion("@firebase/auth-compat","0.1.2")}).call(this,n(20))},46:function(e,t,n){"use strict";var r=n(14),i=n(4),s=n(1),o=n(9);function a(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new i.g("invalid-argument",`Invalid options passed to function ${e}(): You cannot specify both "merge" and "mergeFields".`);return t}function c(){if("undefined"===typeof Uint8Array)throw new i.g("unimplemented","Uint8Arrays are not available in this environment.")}function u(){if(!Object(i.r)())throw new i.g("unimplemented","Blobs are unavailable in Firestore in this environment.")}class h{constructor(e){this._delegate=e}static fromBase64String(e){return u(),new h(i.b.fromBase64String(e))}static fromUint8Array(e){return c(),new h(i.b.fromUint8Array(e))}toBase64(){return u(),this._delegate.toBase64()}toUint8Array(){return c(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function l(e){return function(e,t){if("object"!==typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"===typeof n[r])return!0;return!1}(e,["next","error","complete"])}class d{enableIndexedDbPersistence(e,t){return Object(i.F)(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return Object(i.G)(e._delegate)}clearIndexedDbPersistence(e){return Object(i.x)(e._delegate)}}class f{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof i.m||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();e.merge||t.host===e.host||Object(i.s)("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,n={}){Object(i.A)(this._delegate,e,t,n)}enableNetwork(){return Object(i.H)(this._delegate)}disableNetwork(){return Object(i.D)(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,Object(i.t)("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return Object(i.lb)(this._delegate)}onSnapshotsInSync(e){return Object(i.Y)(this._delegate,e)}get app(){if(!this._appCompat)throw new i.g("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new A(this,Object(i.y)(this._delegate,e))}catch(t){throw w(t,"collection()","Firestore.collection()")}}doc(e){try{return new v(this,Object(i.E)(this._delegate,e))}catch(t){throw w(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new E(this,Object(i.z)(this._delegate,e))}catch(t){throw w(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Object(i.db)(this._delegate,t=>e(new m(this,t)))}batch(){return Object(i.K)(this._delegate),new g(new i.l(this._delegate,e=>Object(i.L)(this._delegate,e)))}loadBundle(e){return Object(i.V)(this._delegate,e)}namedQuery(e){return Object(i.W)(this._delegate,e).then(e=>e?new E(this,e):null)}}class p extends i.a{constructor(e){super(),this.firestore=e}convertBytes(e){return new h(new i.b(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return v.forKey(t,this.firestore,null)}}class m{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new p(e)}get(e){const t=N(e);return this._delegate.get(t).then(e=>new _(this._firestore,new i.e(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,t.converter)))}set(e,t,n){const r=N(e);return n?(a("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const i=N(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){const t=N(e);return this._delegate.delete(t),this}}class g{constructor(e){this._delegate=e}set(e,t,n){const r=N(e);return n?(a("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const i=N(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){const t=N(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class y{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new i.i(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new T(this._firestore,n),null!==t&&void 0!==t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=y.INSTANCES;let r=n.get(e);r||(r=new WeakMap,n.set(e,r));let i=r.get(t);return i||(i=new y(e,new p(e),t),r.set(t,i)),i}}y.INSTANCES=new WeakMap;class v{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new p(e)}static forPath(e,t,n){if(e.length%2!==0)throw new i.g("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new v(t,new i.d(t._delegate,n,new i.n(e)))}static forKey(e,t,n){return new v(t,new i.d(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new A(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new A(this.firestore,Object(i.y)(this._delegate,e))}catch(t){throw w(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=Object(s.k)(e))instanceof i.d&&Object(i.cb)(this._delegate,e)}set(e,t){t=a("DocumentReference.set",t);try{return t?Object(i.fb)(this._delegate,e,t):Object(i.fb)(this._delegate,e)}catch(n){throw w(n,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return 1===arguments.length?Object(i.kb)(this._delegate,e):Object(i.kb)(this._delegate,e,t,...n)}catch(r){throw w(r,"updateDoc()","DocumentReference.update()")}}delete(){return Object(i.B)(this._delegate)}onSnapshot(...e){const t=b(e),n=I(e,e=>new _(this.firestore,new i.e(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter)));return Object(i.X)(this._delegate,t,n)}get(e){let t;return t="cache"===(null===e||void 0===e?void 0:e.source)?Object(i.N)(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?Object(i.O)(this._delegate):Object(i.M)(this._delegate),t.then(e=>new _(this.firestore,new i.e(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter)))}withConverter(e){return new v(this.firestore,e?this._delegate.withConverter(y.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function w(e,t,n){return e.message=e.message.replace(t,n),e}function b(e){for(const t of e)if("object"===typeof t&&!l(t))return t;return{}}function I(e,t){var n,r;let i;return i=l(e[0])?e[0]:l(e[1])?e[1]:"function"===typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]},{next:e=>{i.next&&i.next(t(e))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class _{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new v(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Object(i.hb)(this._delegate,e._delegate)}}class T extends _{data(e){const t=this._delegate.data(e);return Object(i.q)(void 0!==t,"Document in a QueryDocumentSnapshot should exist"),t}}class E{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new p(e)}where(e,t,n){try{return new E(this.firestore,Object(i.ab)(this._delegate,Object(i.mb)(e,t,n)))}catch(r){throw w(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new E(this.firestore,Object(i.ab)(this._delegate,Object(i.Z)(e,t)))}catch(n){throw w(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new E(this.firestore,Object(i.ab)(this._delegate,Object(i.T)(e)))}catch(t){throw w(t,"limit()","Query.limit()")}}limitToLast(e){try{return new E(this.firestore,Object(i.ab)(this._delegate,Object(i.U)(e)))}catch(t){throw w(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new E(this.firestore,Object(i.ab)(this._delegate,Object(i.jb)(...e)))}catch(t){throw w(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new E(this.firestore,Object(i.ab)(this._delegate,Object(i.ib)(...e)))}catch(t){throw w(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new E(this.firestore,Object(i.ab)(this._delegate,Object(i.J)(...e)))}catch(t){throw w(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new E(this.firestore,Object(i.ab)(this._delegate,Object(i.I)(...e)))}catch(t){throw w(t,"endAt()","Query.endAt()")}}isEqual(e){return Object(i.bb)(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null===e||void 0===e?void 0:e.source)?Object(i.Q)(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?Object(i.R)(this._delegate):Object(i.P)(this._delegate),t.then(e=>new k(this.firestore,new i.j(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot)))}onSnapshot(...e){const t=b(e),n=I(e,e=>new k(this.firestore,new i.j(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot)));return Object(i.X)(this._delegate,t,n)}withConverter(e){return new E(this.firestore,e?this._delegate.withConverter(y.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class S{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new T(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class k{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new E(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new T(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(e=>new S(this._firestore,e))}forEach(e,t){this._delegate.forEach(n=>{e.call(t,new T(this._firestore,n))})}isEqual(e){return Object(i.hb)(this._delegate,e._delegate)}}class A extends E{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new v(this.firestore,e):null}doc(e){try{return new v(this.firestore,void 0===e?Object(i.E)(this._delegate):Object(i.E)(this._delegate,e))}catch(t){throw w(t,"doc()","CollectionReference.doc()")}}add(e){return Object(i.u)(this._delegate,e).then(e=>new v(this.firestore,e))}isEqual(e){return Object(i.cb)(this._delegate,e._delegate)}withConverter(e){return new A(this.firestore,e?this._delegate.withConverter(y.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function N(e){return Object(i.p)(e,i.d)}class O{constructor(...e){this._delegate=new i.f(...e)}static documentId(){return new O(i.o.keyField().canonicalString())}isEqual(e){return(e=Object(s.k)(e))instanceof i.f&&this._delegate._internalPath.isEqual(e._internalPath)}}class C{constructor(e){this._delegate=e}static serverTimestamp(){const e=Object(i.eb)();return e._methodName="FieldValue.serverTimestamp",new C(e)}static delete(){const e=Object(i.C)();return e._methodName="FieldValue.delete",new C(e)}static arrayUnion(...e){const t=Object(i.w)(...e);return t._methodName="FieldValue.arrayUnion",new C(t)}static arrayRemove(...e){const t=Object(i.v)(...e);return t._methodName="FieldValue.arrayRemove",new C(t)}static increment(e){const t=Object(i.S)(e);return t._methodName="FieldValue.increment",new C(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const D={Firestore:f,GeoPoint:i.h,Timestamp:i.k,Blob:h,Transaction:m,WriteBatch:g,DocumentReference:v,DocumentSnapshot:_,Query:E,QueryDocumentSnapshot:T,QuerySnapshot:k,CollectionReference:A,FieldPath:O,FieldValue:C,setLogLevel:function(e){Object(i.gb)(e)},CACHE_SIZE_UNLIMITED:i.c};var R,P;R=r.a,P=(e,t)=>new f(e,t,new d),R.INTERNAL.registerComponent(new o.a("firestore-compat",e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("firestore").getImmediate();return P(t,n)},"PUBLIC").setServiceProps(Object.assign({},D))),R.registerVersion("@firebase/firestore-compat","0.1.2")},5:function(e,t,n){"use strict";n.r(t),n.d(t,"SDK_VERSION",(function(){return I})),n.d(t,"_DEFAULT_ENTRY_NAME",(function(){return c})),n.d(t,"_addComponent",(function(){return d})),n.d(t,"_addOrOverwriteComponent",(function(){return f})),n.d(t,"_apps",(function(){return h})),n.d(t,"_clearComponents",(function(){return y})),n.d(t,"_components",(function(){return l})),n.d(t,"_getProvider",(function(){return m})),n.d(t,"_registerComponent",(function(){return p})),n.d(t,"_removeServiceInstance",(function(){return g})),n.d(t,"deleteApp",(function(){return S})),n.d(t,"getApp",(function(){return T})),n.d(t,"getApps",(function(){return E})),n.d(t,"initializeApp",(function(){return _})),n.d(t,"onLog",(function(){return A})),n.d(t,"registerVersion",(function(){return k})),n.d(t,"setLogLevel",(function(){return N}));var r=n(9),i=n(8),s=n(1);n.d(t,"FirebaseError",(function(){return s.c}));class o{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const a=new i.b("@firebase/app"),c="[DEFAULT]",u={"@firebase/app":"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},h=new Map,l=new Map;function d(e,t){try{e.container.addComponent(t)}catch(n){a.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function f(e,t){e.container.addOrOverwriteComponent(t)}function p(e){const t=e.name;if(l.has(t))return a.debug(`There were multiple attempts to register component ${t}.`),!1;l.set(t,e);for(const n of h.values())d(n,e);return!0}function m(e,t){return e.container.getProvider(t)}function g(e,t,n=c){m(e,t).clearInstance(n)}function y(){l.clear()}const v={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."},w=new s.b("app","Firebase",v);class b{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.a("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw w.create("app-deleted",{appName:this._name})}}const I="9.0.0";function _(e,t={}){if("object"!==typeof t){t={name:t}}const n=Object.assign({name:c,automaticDataCollectionEnabled:!1},t),i=n.name;if("string"!==typeof i||!i)throw w.create("bad-app-name",{appName:String(i)});const o=h.get(i);if(o){if(Object(s.h)(e,o.options)&&Object(s.h)(n,o.config))return o;throw w.create("duplicate-app",{appName:i})}const a=new r.b(i);for(const r of l.values())a.addComponent(r);const u=new b(e,n,a);return h.set(i,u),u}function T(e=c){const t=h.get(e);if(!t)throw w.create("no-app",{appName:e});return t}function E(){return Array.from(h.values())}async function S(e){const t=e.name;h.has(t)&&(h.delete(t),await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function k(e,t,n){var i;let s=null!==(i=u[e])&&void 0!==i?i:e;n&&(s+="-"+n);const o=s.match(/\s|\//),c=t.match(/\s|\//);if(o||c){const e=[`Unable to register library "${s}" with version "${t}":`];return o&&e.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&c&&e.push("and"),c&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void a.warn(e.join(" "))}p(new r.a(s+"-version",()=>({library:s,version:t}),"VERSION"))}function A(e,t){if(null!==e&&"function"!==typeof e)throw w.create("invalid-log-argument");Object(i.d)(e,t)}function N(e){Object(i.c)(e)}var O;p(new r.a("platform-logger",e=>new o(e),"PRIVATE")),k("@firebase/app","0.7.0",O),k("fire-js","")},8:function(e,t,n){"use strict";function r(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}var i;n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return f}));var s,o=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(s||(s={}));var a={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},c=s.INFO,u=((i={})[s.DEBUG]="log",i[s.VERBOSE]="log",i[s.INFO]="info",i[s.WARN]="warn",i[s.ERROR]="error",i),h=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(t<e.logLevel)){var s=(new Date).toISOString(),o=u[t];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[o].apply(console,r(["["+s+"]  "+e.name+":"],n))}},l=function(){function e(e){this.name=e,this._logLevel=c,this._logHandler=h,this._userLogHandler=null,o.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in s))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"===typeof e?a[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.DEBUG],e)),this._logHandler.apply(this,r([this,s.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.VERBOSE],e)),this._logHandler.apply(this,r([this,s.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.INFO],e)),this._logHandler.apply(this,r([this,s.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.WARN],e)),this._logHandler.apply(this,r([this,s.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.ERROR],e)),this._logHandler.apply(this,r([this,s.ERROR],e))},e}();function d(e){o.forEach((function(t){t.setLogLevel(e)}))}function f(e,t){for(var n=function(n){var r=null;t&&t.level&&(r=a[t.level]),n.userLogHandler=null===e?null:function(t,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var a=i.map((function(e){if(null==e)return null;if("string"===typeof e)return e;if("number"===typeof e||"boolean"===typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}})).filter((function(e){return e})).join(" ");n>=(null!==r&&void 0!==r?r:t.logLevel)&&e({level:s[n].toLowerCase(),message:a,args:i,type:t.name})}},r=0,i=o;r<i.length;r++){n(i[r])}}},9:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}));function r(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))}function i(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(a){s=[6,a],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}Object.create;function s(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function a(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}Object.create;var c=n(1),u=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},e}(),h=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return e.prototype.get=function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new c.a;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t,n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:"[DEFAULT]"})}catch(d){}try{for(var r=s(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var a=o(i.value,2),c=a[0],u=a[1],h=this.normalizeInstanceIdentifier(c);try{var l=this.getOrInitializeService({instanceIdentifier:h});u.resolve(l)}catch(d){}}}catch(f){t={error:f}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}},e.prototype.clearInstance=function(e){void 0===e&&(e="[DEFAULT]"),this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return r(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(a(a([],o(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()})))),o(e.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.isInitialized=function(e){return void 0===e&&(e="[DEFAULT]"),this.instances.has(e)},e.prototype.getOptions=function(e){return void 0===e&&(e="[DEFAULT]"),this.instancesOptions.get(e)||{}},e.prototype.initialize=function(e){var t,n;void 0===e&&(e={});var r=e.options,i=void 0===r?{}:r,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(this.name+"("+a+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var c=this.getOrInitializeService({instanceIdentifier:a,options:i});try{for(var u=s(this.instancesDeferred.entries()),h=u.next();!h.done;h=u.next()){var l=o(h.value,2),d=l[0],f=l[1];a===this.normalizeInstanceIdentifier(d)&&f.resolve(c)}}catch(p){t={error:p}}finally{try{h&&!h.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return c},e.prototype.onInit=function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var s=this.instances.get(r);return s&&e(s,r),function(){i.delete(e)}},e.prototype.invokeOnInitCallbacks=function(e,t){var n,r,i=this.onInitCallbacks.get(t);if(i)try{for(var o=s(i),a=o.next();!a.done;a=o.next()){var c=a.value;try{c(e,t)}catch(u){}}}catch(h){n={error:h}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},e.prototype.getOrInitializeService=function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,s=this.instances.get(n);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,"[DEFAULT]"===t?void 0:t),options:i}),this.instances.set(n,s),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(s,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,s)}catch(o){}return s||null},e.prototype.normalizeInstanceIdentifier=function(e){return void 0===e&&(e="[DEFAULT]"),this.component?this.component.multipleInstances?e:"[DEFAULT]":e},e.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},e}();var l=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new h(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}()}}]);